[
    {
      "modulo": "Protecting Resources-OSRs/Log File Restrictions",
      "clave": "WTMP",
      "descripcion": "Invalid Permissions or Ownership for log file: /var/log/wtmp;   -rw-rw-r--.;  owner:  root;   group:  utmp. For more information see rule description.",
      "comprobacion": "## Se le debe quitar W al grupo.\n\n+-------------------------------------------------------------------------------------+\n## Comprobar que en logrotate.conf, tenga permisosa 0644\n+-------------------------------------------------------------------------------------+\n\ncat /etc/logrotate.conf | grep -w wtmp -A4\n\ncat /etc/logrotate.d/* | grep -w wtmp -A4",
      "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user^^}/logrotate.conf_`date +%d%m%y`\ncp -p /etc/logrotate.d/wtmp /home/${user^^}/logrotate_wtmp_`date +%d%m%y`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user,,}/logrotate.conf_`date +%d%m%y`\ncp -p /etc/logrotate.d/wtmp /home/${user,,}/logrotate_wtmp_`date +%d%m%y`",
      "editar": "+-------------------------------------------------------------------------------------+\n## Quitar permisos al fichero\n+-------------------------------------------------------------------------------------+\n\nchmod g-w /var/log/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 7:\n+-------------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /lib/tmpfiles.d/var.conf\n\n## Debe quedar la linea asi:\n\nf /var/log/wtmp 0644 root utmp -\n\n+-------------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 6\n+-------------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /etc/rc.sysinit\n\n## Dejar la linea asi:\n\nchmod 0644 /var/run/utmp /var/log/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Corregir los permisos en logrotate.conf O en /etc/logrotate.d/wtmp, en create de wtmp\n+-------------------------------------------------------------------------------------+\n\nvi /etc/logrotate.conf\n\nvi /etc/logrotate.d/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Modificar los permisos de 0664, a 0644, al fichero /var/log/wtmp\n+-------------------------------------------------------------------------------------+",
      "refrescar": null,
      "evidencia": "+-------------------------------------------------------------------------------------+\n## RHEL 6\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /var/log/wtmp\ncat cat /etc/rc.sysinit | grep -w 'wtmp'\ncat /etc/logrotate.conf | grep -w wtmp -A4\n\n+-------------------------------------------------------------------------------------+\n## RHEL 7\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /var/log/wtmp\ncat /lib/tmpfiles.d/var.conf | grep -w wtmp\ncat /etc/logrotate.conf | grep -w wtmp -A4\n",
      "SO": "Linux"
    }
]
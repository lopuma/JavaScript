{
    "CTTI": [
        {
            "modulo": "Protecting Resources-OSRs/Log File Restrictions",
            "clave": "WTMP",
            "descripcion": "Invalid Permissions or Ownership for log file: /var/log/wtmp;   -rw-rw-r--.;  owner:  root;   group:  utmp. For more information see rule description.",
            "comprobacion": "## Se le debe quitar W al grupo.\n\n+-------------------------------------------------------------------------------------+\n## Comprobar que en logrotate.conf, tenga permisosa 0644\n+-------------------------------------------------------------------------------------+\n\ncat /etc/logrotate.conf | grep -w wtmp -A4\n\ncat /etc/logrotate.d/* | grep -w wtmp -A4",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user^^}/logrotate.conf_`date +%d%m%y`\ncp -p /etc/logrotate.d/wtmp /home/${user^^}/logrotate_wtmp_`date +%d%m%y`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user,,}/logrotate.conf_`date +%d%m%y`\ncp -p /etc/logrotate.d/wtmp /home/${user,,}/logrotate_wtmp_`date +%d%m%y`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Quitar permisos al fichero\n+-------------------------------------------------------------------------------------+\n\nchmod g-w /var/log/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 7:\n+-------------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /lib/tmpfiles.d/var.conf\n\n## Debe quedar la linea asi:\n\nf /var/log/wtmp 0644 root utmp -\n\n+-------------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 6\n+-------------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /etc/rc.sysinit\n\n## Dejar la linea asi:\n\nchmod 0644 /var/run/utmp /var/log/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Corregir los permisos en logrotate.conf O en /etc/logrotate.d/wtmp, en create de wtmp\n+-------------------------------------------------------------------------------------+\n\nvi /etc/logrotate.conf\n\nvi /etc/logrotate.d/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Modificar los permisos de 0664, a 0644, al fichero /var/log/wtmp\n+-------------------------------------------------------------------------------------+",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## RHEL 6\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /var/log/wtmp\ncat cat /etc/rc.sysinit | grep -w 'wtmp'\ncat /etc/logrotate.conf | grep -w wtmp -A4\n\n+-------------------------------------------------------------------------------------+\n## RHEL 7\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /var/log/wtmp\ncat /lib/tmpfiles.d/var.conf | grep -w wtmp\ncat /etc/logrotate.conf | grep -w wtmp -A4\n",
            "SO": "Linux"
        },
        {
            "modulo": "Protecting Resources-OSRs/CRON Full Path Restriction",
            "clave": "CRON MISSING FULL PATH",
            "descripcion": "Missing path: $MissingPath. path must be used for commands in CRON.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este desvio tenemos que hacer lo siguiente:\n+-------------------------------------------------------------------------------------+\n\n\" 1 - Obtener la ruta completa (`full path`) del fichero a que hace referencia el issue.\n\" 2 - Buscar en los ficheros del CRON, el fichero y añadir su FULL PATH.\n\n// NOTA: Revisar `FULL PATH reales`\n\n+-------------------------------------------------------------------------------------+\n## FULL PATH reales.\n+-------------------------------------------------------------------------------------+\n\n[ /usr/bin/find ]\n\n+-------------------------------------------------------------------------------------+\n## Si no esta el FULL PATH en la lista anterior, guardamos en la variable '$MissingPath', el nombre del fichero al que le falta `FULL PATH`.\n\n// Ejemplo : MissingPath=\"find\"\n+-------------------------------------------------------------------------------------+\n\nMissingPath=\"\"\n\nfind / -name \"$MissingPath\"\n\n+-------------------------------------------------------------------------------------+\n## Buscar en los ficheros del CRON, el fichero $MissingPath, para añadir el FULL PATH correcto.\n+-------------------------------------------------------------------------------------+\n\n+--- 1 \ncd /var/spool/cron/\ngrep -i \"$MissingPath\" *\n\n+--- 2\ncat /etc/crontab | grep -i \"$MissingPath\"\n\n+--- 3\ncrontab -l | grep -i \"$MissingPath\"\n\n+--- 4\ncd /etc/cron.d/\ngrep -ri \"$MissingPath\"",
            "copia": "+-------------------------------------------------------------------------------------+\n## Remplazar 'FICHERO DEL CRON', por el fichero donde se va a editar\n+-------------------------------------------------------------------------------------+\n\ncp -p 'FICHERO DEL CRON' /home/$(logname)/\"$MissingPath\"_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar el fichero cron, y Corregir el `FULL PATH`.\n\n// Ejemplo de ficheros de CRON a editar.\n+-------------------------------------------------------------------------------------+\n\nvi /var/spool/cron/root\n\n+-------------------------------------------------------------------------------------+\n\n// NOTA : Revisar `FULL PATH` reales.",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\ncat /var/spool/cron/root | grep -i \"$MissingPath\"\ncrontab -l | grep \"$MissingPath\"",
            "SO": "Linux"
        },
        {
            "modulo": "Password Requirements//etc/profile IBMsinit sh",
            "clave": "INVOCATION IBMSINIT.SH",
            "descripcion": "/etc/profile must trigger an invocation of '. /etc/profile.d/IBMsinit.sh', and does not set/reset the time out control after that invocation.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## No deben existir 2 controles TMOUT en el servidor.\n\n## Revisar en /etc/profile, si tiene un TMOUT definido, se debe quitar\n\n## Si no existe la llamada a IBMSinit.sh, se debe añadir\n+-------------------------------------------------------------------------------------+\n\ncat /etc/profile | egrep -i \"TMOUT|IBMsinit.sh\"\n\n+-------------------------------------------------------------------------------------+\n## En /etc/profile.d/IBMsinit.sh, al final del SCRIPT de UMASK\n+-------------------------------------------------------------------------------------+\n\ncat /etc/profile.d/IBMsinit.sh",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user^^}/IBMsinit.sh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user,,}/IBMsinit.sh_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n// NOTA : Eliminar la entrada TMOUT en /etc/profile, si existe.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile\n\n+-------------------------------------------------------------------------------------+\n## Añadir : '. /etc/profile.d/IBMsinit.sh', por debajo del script de UMASK\n+-------------------------------------------------------------------------------------+\n\n. /etc/profile.d/IBMsinit.sh\n",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\ncat /etc/profile | egrep -i \"TMOUT|IBMSinit.sh\"",
            "SO": "Linux"
        },
        {
            "modulo": "Network Settings/TCP Configuration Files Restrictions",
            "clave": "SYSCTL",
            "descripcion": "Incorrect /etc/sysctl.conf",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Los valores por defecto en `/sbin/sysctl`, deben estar establecidos.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Existen server, que la configuracion se realiza desde el fichero de configuracion `/etc/sysctl.conf`, es erroneo se debe establecer valores por defecto.\n+-------------------------------------------------------------------------------------+",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/sysctl.conf /home/${user^^}/sysctl.conf_`date +%d%m%y`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/sysctl.conf /home/${user,,}/sysctl.conf_`date +%d%m%y`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Para hacer el cambio:\n+-------------------------------------------------------------------------------------+\n\n/sbin/sysctl -w net.ipv4.conf.all.secure_redirects=0\n/sbin/sysctl -w net.ipv4.conf.default.secure_redirects=0\n/sbin/sysctl -w net.ipv4.conf.all.log_martians=1\n/sbin/sysctl -w net.ipv4.conf.default.log_martians=1\n/sbin/sysctl -w net.ipv4.conf.all.rp_filter=1\n/sbin/sysctl -w net.ipv4.conf.default.rp_filter=1\n/sbin/sysctl -w net.ipv4.ip_forward=0\n/sbin/sysctl -w net.ipv4.conf.all.accept_source_route=0\n/sbin/sysctl -w net.ipv4.conf.default.accept_source_route=0\n/sbin/sysctl -w net.ipv4.conf.all.accept_redirects=0\n/sbin/sysctl -w net.ipv6.conf.all.accept_ra=0\n/sbin/sysctl -w net.ipv6.conf.default.accept_ra=0\n/sbin/sysctl -w net.ipv6.conf.all.accept_redirects=0\n/sbin/sysctl -w net.ipv6.conf.default.accept_redirects=0\n",
            "refrescar": "sysctl -p",
            "evidencia": "clear\ndate\nhostname\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.secure_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.secure_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.log_martians\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.log_martians\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.rp_filter\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.rp_filter\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.accept_source_route\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.accept_source_route\"\n/sbin/sysctl -a |grep -i \"net.ipv4.ip_forward\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.accept_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.all.accept_ra\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.default.accept_ra\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.all.accept_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.default.accept_redirects\"\n",
            "SO": "Linux"
        },
        {
            "modulo": "Protecting Resources -OSRs/006 Alert logs",
            "clave": "006",
            "descripcion": "Instance:$INSTANCE. File \"$filebdd\":-Wrong group: oinstall. Must be owned by oracle/dba and permissions no more than \"rw-r-----\"",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Donde $INSTANCE, es la instancia de la bases de datos a revisar.\n## Donde $filebdd, es el fichero a corregir los permisos.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Se debe cambiar el owner y el grupo a:\n+-------------------------------------------------------------------------------------+\n## Owner : oradb\n## Grupo : asmadmin\n\n# Quitar permisos de lectura a other\n\n+-------------------------------------------------------------------------------------+\n## Buscar y listar ficheros con grupo oinstall, y con permisos de lectura en grupo\n## - Guardar el directorio, de los ficheros a modificar permisos.\n+-------------------------------------------------------------------------------------+\n\n## Ejemplo\n\nfilebdd=\"/u01/app/oracle/product/19.0.0/db_1/rdbms/log/\"\n\n## FORMA RECURSIVA\n+-------------------------------------------------------------------------------------+\n## Comprobar cuantos ficheros existen con grupo oinstall\n## Comprobar cuantos ficheros existen con permisos de lectura en grupo\n+-------------------------------------------------------------------------------------+\n\nfind $filebdd -type f -group oinstall | wc -l\nfind $filebdd -type f -perm -o=r | wc -l\n\n+-------------------------------------------------------------------------------------+\n## Listar los ficheros con grupo oinstall\n## Listar los ficheros con permisos de lectura en grupo\n+-------------------------------------------------------------------------------------+\n\nfind $filebdd -type f -group oinstall | xargs -l ls -la\nfind $filebdd -type f -perm -o=r | xargs -l ls -la\n\n\n## FORMA INDIVIDUAL\n+-------------------------------------------------------------------------------------+\n## Comprobar / Listar cuantos ficheros existen con grupo oinstall\n## Comprobar / Listar cuantos ficheros existen con permisos de lectura en grupo\n+-------------------------------------------------------------------------------------+\nls -la $filebdd",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## De forma INDIVIDUAL\n+-------------------------------------------------------------------------------------+\nchown oradb:asmadmin $filebdd\nchmod o-r $filebdd/*\n\n+-------------------------------------------------------------------------------------+\n## De forma RECURSIVA\n+-------------------------------------------------------------------------------------+\nfind  $filebdd -type f -group oinstall -exec chown oradb:asmadmin {} +\nfind  $filebdd -type f -perm -o=r -exec chmod o-r {} +\n",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## De forma INDIVIDUAL\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la $filebdd\n\n+-------------------------------------------------------------------------------------+\n## De forma RECURSIVA\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $filebdd -type f -group oinstall | wc -l\nfind $filebdd -type f -perm -o=r | wc -l\nls -ld $filebdd",
            "SO": "Oracle"
        },
        {
            "modulo": "Identify and Authenticate Users/Public Key Label",
            "clave": "AUTHORIZED_KEY / LABEL_KEY",
            "descripcion": "SSH authorized_keys file: $file_authorized; Some of the keys have no identifying label",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves publicas(\"authorized_keys\")\n## Deben tener un LABEL que indetifique a quien pertenece la clave publica\n## Antes de seguir, revisar -* AUTHORIZED_KEYS *-\n\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene un LABEL que es el GECOS, se define al final de cada clave `ssh-rsa` y que esta entre !! y !!\n## El fichero debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_authorized\ncat $file_authorized\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys es de root, no debe tener un fichero authorized_keys.\n## Pasamos directamente a renombrar el fichero authorized_keys para owner root.\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n\" --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Corregir el LABEL a las claves publicas, ya sean /C/F/S, /K/I/E/\n+-------------------------------------------------------------------------------------+\n\n\" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Renombrar los ficheros authorized_keys que tenga owner huerfanos\n+-------------------------------------------------------------------------------------+\n",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user^^}/authorized_key_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user,,}/authorized_key_`date +%d%m%y_%T`\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\ncp -p \"$file_authorized\" /home/$user/authorized_key_`date +%d%m%y_%T`\n",
            "editar": "\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros id_rsa, con owner root\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/authorized_keys /home/root/.ssh/authorized_keys.save\n\nmv /root/.ssh/authorized_keys /root/.ssh/authorized_keys.save\n\n\n\" --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## --- Añadir GECOS de forma AUTOMATICA\n// comando solo para linux\n+-------------------------------------------------------------------------------------+\n\nsed -i 's,$,'\" $gecos\"',' \"$file_authorized\"\n\n+-------------------------------------------------------------------------------------+\n## Editar y añadir el GECOS de forma MANUAL\n+-------------------------------------------------------------------------------------+\n\nvi $file_authorized\n\n## Añadir el GECOS de la cuenta al final de la clave 'ssh-rsa' o si existe, debe estar ENTRE !! y !!\n\n\" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si no existe la cuenta se puede RENOMBRAR el fichero\n+-------------------------------------------------------------------------------------+\n\nmv $file_authorized $file_authorized.save\n",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /home/root/.ssh/authorized_keys\nls -la /root/.ssh/authorized_keys\n\n+-------------------------------------------------------------------------------------+\n\" --> OPCION 2 & \" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la $file_authorized\ncat $file_authorized",
            "SO": "Linux"
        },
        {
            "modulo": "Password Requirements/Automatic Logoff IBMsinit sh TMOUT",
            "clave": "TMOUT SH",
            "descripcion": "/etc/profile.d/IBMsinit.sh Default: Set systems to terminate a session after 21600 seconds of inactivity. File must  contain \"TMOUT=21600\" followed by \"export TMOUT\". A shorter time frame may be specified.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## En /etc/profile.d/IBMsinit.sh, al final del SCRIPT de UMASK, debe tener un TMOUT\n\n##(\"TMOUT solo debe estar implementado en 'IBMsinit.sh'\")\n+-------------------------------------------------------------------------------------+\n\ncat /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------------+\n## SET muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\nset | grep OUT",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user^^}/IBMsinit.sh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user,,}/IBMsinit.sh_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------------+\n## Añdir, al final del script de UMASK\n+-------------------------------------------------------------------------------------+\n\nTMOUT=21600\nexport TMOUT",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.sh\nset | grep OUT",
            "SO": "Linux"
        },
        {
            "modulo": "Protecting Resources -OSRs/014 LISTENER.ORA",
            "clave": "LISTENER.014",
            "descripcion": "Instance:$INSTANCE. File \"$fileBD\":-Wrong permission: rw-r--r--. Must be owned by oracle/dba and permissions \"rw-------\"",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Este tipo de desvios, tenemos que cambiarle permisos de 0644 a 600\n\" Por lo normal es el siguiente fichero. \n+-------------------------------------------------------------------------------------+\n\nfileBD=\"/u01/app/oracle/product/19.0.0/db_1/network/admin/samples/listener.ora\"",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar los permisos del fichero que nos muestra la desviacion a 600\n+-------------------------------------------------------------------------------------+\n\nchmod 0600 $fileBD",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\nls -la $fileBD",
            "SO": "Bases de Datos"
        },
        {
            "modulo": "Password Requirements/Password MIN Length - System Default",
            "clave": "MINLENGTH DEFAULT",
            "descripcion": "Invalid Password Min Length setting of 8, should be not less than 14\nInvalid system DEFAUTL Min Length",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## El parametro minlen en los sistemas AIX, debe ser 14, por defecto y por usuario.\n\n## Una vez cambiado a default, se corrigen para las demas cuentas, puede quedar root o alguna cuenta sin cambiar, por lo que se puede cambiar manual \n\n## (MODULO : Password Requirements/Password MIN Length).\n+-------------------------------------------------------------------------------------+\n\nlssec -f /etc/security/user -s default -a minlen",
            "copia": null,
            "editar": "chsec -f /etc/security/user -s default -a minlen=14\nchsec -f /etc/security/user -s root -a minlen=14",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\nlssec -f /etc/security/user -s default -a minlen\nlssec -f /etc/security/user -s root -a minlen",
            "SO": "Aix"
        },
        {
            "modulo": "Password Requirements/Password MIN Length - Aix",
            "clave": "MINLENGTH",
            "descripcion": "Invalid Password Min Length setting of 8, should be not less than 14\nInvalid system ACCOUNTS Min Length",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## El parametro minlen en los sistemas AIX, debe ser 14, por defecto y por usuario.\n\n## Una vez cambiado a default, se corrigen para las demas cuentas, puede quedar root o alguna cuenta sin cambiar, por lo que se puede cambiar manual \n\n## (MODULO : Password Requirements/Password MIN Length).\n+-------------------------------------------------------------------------------------+\n\nlssec -f /etc/security/user -s default -a minlen",
            "copia": null,
            "editar": "chsec -f /etc/security/user -s $ACCOUNT -a minlen=14\nchsec -f /etc/security/user -s root -a minlen=14",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\nlssec -f /etc/security/user -s default -a minlen\nlssec -f /etc/security/user -s root -a minlen",
            "SO": "Aix"
        },
        {
            "modulo": "AV.1.1.7 Password Requirements",
            "clave": "",
            "descripcion": "## (MODULO RELACIONADO : AV.1.1.6 Password Requirements)\n\n## SSH authorized_keys file: \"FICHERO AUTHORIZED KEYS\"; Invalid from section: . \"*º\" or \"*.*.*.*\" or \"0/0\" or \"0.0.0.0/0\" or empty are forbidden values in the \"from=\" parameter",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves publicas (\"authorized_keys\")\n## Deben tener un FROM que especifique el host remoto o direccion IP.\n\n## Antes de seguir, revisar ('AUTHORIZED')\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene un FROM, que especifica el host remoto o IP\n## Debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_authorized\ncat $file_authorized\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys pertenece a la cuenta root, Root no debe tener un fichero authorized_keys.\n## Pasamos directamente a renombrar el fichero authorized_keys para el owner root.\n\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n\" --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys es de TIPO /F/ o /S/ (sistemas / aplicativo)\n## Se debe notificar al owner o grupo del fichero.\n\n## - Si se va a excepcionar nos deben especificar un RISK e IMPACT.\n\n## - Si se va a corregir (nos deben facilitar la IP o HOST).\n+-------------------------------------------------------------------------------------+\n## Si es de TIPO /C/ (customer)\n\n## - Se debe excepcionar.\n\n## Revisar RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n\" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys, es de tipo /E/. /I/./K/\n\n## - Si es una cuenta 'externa' y no existe en el servidor, se puede renombrar el fichero authorized_key.\n\n## - Si la cuenta existe, se debe notificar al owner de la cuenta.\n+-------------------------------------------------------------------------------------+",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user^^}/authorized_key_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user,,}/authorized_key_`date +%d%m%y_%T`\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p \"$file_authorized\" /home/$user/authorized_key_`date +%d%m%y_%T`\n",
            "editar": "\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/authorized_keys /home/root/.ssh/authorized_keys.save\n\n\n\" --> OPCION 2 y \" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/ o sin owner o account externas/internas de tipo /E/ o /I/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Donde se tengan que renombar el fichero.\n+-------------------------------------------------------------------------------------+\n\nmv $file_authorized $file_authorized.save\n\n+-------------------------------------------------------------------------------------+\n## Donde se tenga que añadir un FROM.\n+-------------------------------------------------------------------------------------+\n\nvi $file_authorized\n\n+-------------------------------------------------------------------------------------+\n## Añadir la línea from=\"IP\", al inicio de cada clave shh-rsa:\n+-------------------------------------------------------------------------------------+\n## EJEMPLO\n\nfrom=\"129.39.41.5,129.39.41.6\" ssh-rsa AAAAB3NzaC1yc2EAAAABIw== !!CZ/S/*ABJ83/IBM/Automation ID!!\n",
            "refrescar": null,
            "evidencia": "\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /home/root/.ssh/authorized_keys\n\n\n\" --> OPCION 2 y \" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/, sin owner o account externas/internas tipo /E/, /I/ /K/\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la $file_authorized\ncat $file_authorized",
            "SO": "Linux / Aix"
        },
        {
            "modulo": "AV.1.1.6 Password Requirements",
            "clave": "",
            "descripcion": "## (MODULO RELACIONADO : AV.1.1.7 Password Requirements)\n\n## SSH authorized_keys file: \"FICHERO AUTHORIZED KEYS\"; Invalid from section: . \"*º\" or \"*.*.*.*\" or \"0/0\" or \"0.0.0.0/0\" or empty are forbidden values in the \"from=\" parameter",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves publicas (\"authorized_keys\")\n## Deben tener un FROM que especifique el host remoto o direccion IP.\n\n## Antes de seguir, revisar ('AUTHORIZED')\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene un FROM, que especifica el host remoto o IP\n## Debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_authorized\ncat $file_authorized\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys pertenece a la cuenta root, Root no debe tener un fichero authorized_keys.\n## Pasamos directamente a renombrar el fichero authorized_keys para el owner root.\n\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n\" --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys es de TIPO /F/ o /S/ (sistemas / aplicativo)\n## Se debe notificar al owner o grupo del fichero.\n\n## - Si se va a excepcionar nos deben especificar un RISK e IMPACT.\n\n## - Si se va a corregir (nos deben facilitar la IP o HOST).\n+-------------------------------------------------------------------------------------+\n## Si es de TIPO /C/ (customer)\n\n## - Se debe excepcionar.\n\n## Revisar RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n\" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys, es de tipo /E/. /I/./K/\n\n## - Si es una cuenta 'externa' y no existe en el servidor, se puede renombrar el fichero authorized_key.\n\n## - Si la cuenta existe, se debe notificar al owner de la cuenta.\n+-------------------------------------------------------------------------------------+",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user^^}/authorized_key_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user,,}/authorized_key_`date +%d%m%y_%T`\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p \"$file_authorized\" /home/$user/authorized_key_`date +%d%m%y_%T`\n",
            "editar": "\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/authorized_keys /home/root/.ssh/authorized_keys.save\n\n\n\" --> OPCION 2 y \" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/ o sin owner o account externas/internas de tipo /E/ o /I/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Donde se tengan que renombar el fichero.\n+-------------------------------------------------------------------------------------+\n\nmv $file_authorized $file_authorized.save\n\n+-------------------------------------------------------------------------------------+\n## Donde se tenga que añadir un FROM.\n+-------------------------------------------------------------------------------------+\n\nvi $file_authorized\n\n+-------------------------------------------------------------------------------------+\n## Añadir la línea from=\"IP\", al inicio de cada clave shh-rsa:\n+-------------------------------------------------------------------------------------+\n## EJEMPLO\n\nfrom=\"129.39.41.5,129.39.41.6\" ssh-rsa AAAAB3NzaC1yc2EAAAABIw== !!CZ/S/*ABJ83/IBM/Automation ID!!\n",
            "refrescar": null,
            "evidencia": "\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /home/root/.ssh/authorized_keys\n\n\n\" --> OPCION 2 y \" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/, sin owner o account externas/internas tipo /E/, /I/ /K/\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la $file_authorized\ncat $file_authorized",
            "SO": "Linux / Aix"
        },
        {
            "modulo": "Encryption/Permitted Ciphers - RHEL 7",
            "clave": "CIPHERS",
            "descripcion": "Cipher aes128-ctr is not available\nCipher aes192-ctr is not available\nCipher aes256-ctr is not available",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Ciphers, debe establecerse en:\n+-------------------------------------------------------------------------------------+\n\nciphers aes128-ctr,aes192-ctr,aes256-ctr,chacha20-poly1305@openssh.com,aes128-gcm@openssh.com,aes256-gcm@openssh.com\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep Ciphers\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep Ciphers",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar y añadir Ciphers, si esta comentado (#), descomentar.\n## Debe estar debajo de: Ciphers and keying\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n+-------------------------------------------------------------------------------------+\n\nCiphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,chacha20-poly1305@openssh.com\n",
            "refrescar": "systemctl stop sshd\nsystemctl start sshd",
            "evidencia": "clear\ndate\nhostname\n/usr/sbin/sshd -T|grep Ciphers\ncat /etc/ssh/sshd_config | grep Ciphers",
            "SO": "Linux"
        },
        {
            "modulo": "Encryption/Permitted Ciphers - RHEL 8",
            "clave": "CIPHERS",
            "descripcion": "Cipher aes128-ctr is not available\nCipher aes192-ctr is not available\nCipher aes256-ctr is not available",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Ciphers, debe establecerse en:\n+-------------------------------------------------------------------------------------+\n\nciphers aes128-ctr,aes192-ctr,aes256-ctr,chacha20-poly1305@openssh.com,aes128-gcm@openssh.com,aes256-gcm@openssh.com\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep Ciphers\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep Ciphers\n\n+-------------------------------------------------------------------------------------+\n## Ademas debe estar descomentada la siguiente entrada : CRYPTO_POLICY\n+-------------------------------------------------------------------------------------+\n\ncat /etc/sysconfig/sshd | grep CRYPTO_POLICY",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## --- RHEL 8, con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/sysconfig/sshd /home/${user^^}/sshd._`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## --- RHEL 8, con HOME en minúscula\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/sysconfig/sshd /home/${user,,}/sshd._`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar y añadir Ciphers, si esta comentado (#), descomentar.\n## Debe estar debajo de: Ciphers and keying\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n+-------------------------------------------------------------------------------------+\n\nCiphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,chacha20-poly1305@openssh.com\n\n+-------------------------------------------------------------------------------------+\n## --- RHEL 8 : Editar Y Descomentar CRYPTO_POLICY=\n+-------------------------------------------------------------------------------------+\n\nvi /etc/sysconfig/sshd\n",
            "refrescar": "systemctl stop sshd\nsystemctl start sshd",
            "evidencia": "clear\ndate\nhostname\n/usr/sbin/sshd -T|grep Ciphers\ncat /etc/ssh/sshd_config | grep Ciphers\ncat /etc/sysconfig/sshd | grep CRYPTO_POLICY\nsystemctl status sshd",
            "SO": "Linux"
        },
        {
            "modulo": "Business Use Notice/Business Use Notice Required",
            "clave": "BUN",
            "descripcion": "Missing or Incorrect Business Use Notice. It should be set in /etc/motd",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n##Debe tener el BUN actual.\n+-------------------------------------------------------------------------------------+",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/motd\n\n+-------------------------------------------------------------------------------------+\n##añadir / remplazar :\n+-------------------------------------------------------------------------------------+\n\n* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n*           AVÍS ALS USUARIS: L'ús no autoritzat d'aquest sistema no està permès.               *\n*                             Les activitats seran registrades.                                 *\n* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\ncat /etc/motd",
            "SO": "Linux"
        },
        {
            "modulo": "Encryption/Password Encryption Required",
            "clave": "PAM / SHA512",
            "descripcion": "/etc/pam.d/password-auth.\n/etc/pam.d/system-auth.\nAny file in /etc/pam.d containing \"password sufficient pam_unix.so\" stanza must carry the \"sha512 shadow\" options.\n\nIncorrect or missing pam_unix.so module stanza. For more information see coverage matrix document",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al parametro 'sha512 shadow ' en RHEL 7 y RHEL 8 ('system-auth','password-auth').\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Los ficheros del PAM, deben tener en el modulo 'password    sufficient    pam_unix.so', el parámetro 'sha512 shadow '\n\n## Ademas deben ser LINK de 'system-auth-ac', 'password-auth-ac' o alguna alternativa dependiendo las caracteristicas del server.\n\n// NOTA : En CTTI suelen configurar los link a (`/etc/authselect/`)\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | egrep \"sha512|shadow\"\ncat /etc/pam.d/password-auth | egrep \"sha512|shadow\"\nls -la /etc/pam.d/system-auth\nls -la /etc/pam.d/password-auth\n\n+-------------------------------------------------------------------------------------+\n## Si la configuracion anterior es valida. revisar que no hayan BACKUPS de los ficheros del PAM\n\n## Ficheros .ori, .bck, .backup, -local, o todo aquel que sea una copia de, 'system-auth', 'password-auth', o de 'system-auth-ac', 'password-auth-ac'\n+-------------------------------------------------------------------------------------+\n\ncd /etc/pam.d/\nls -la system-*\nls -la password-*\n\n+-------------------------------------------------------------------------------------+\n## - Si existen BACKUPS, Mover los BACKUPS al HOME\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## La siguiente serie de comandos, es para que los ficheros del PAM, sean LINK de (`system-auth-ac`, `password-auth-ac`).\n\n// NOTA : No es necesario si ya son link a un fichero authorizado.\n+-------------------------------------------------------------------------------------+\n\nrm -r system-auth\nln -s system-auth-ac system-auth\n\nrm -r password-auth\nln -s password-auth-ac password-auth\n\n+-------------------------------------------------------------------------------------+\n## Modulo similiar : \n\n\" Password Requirements/Password History\n+-------------------------------------------------------------------------------------+",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'password    sufficient    pam_unix.so', el parámetro 'sha512 shadow'.\n\n// NOTA: ('se aconseja remplazar toda la linea, del modulo 'password    sufficient    pam_unix.so').\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\n+-------------------------------------------------------------------------------------+\n## Añadir\n+-------------------------------------------------------------------------------------+\n\npassword    sufficient    pam_unix.so remember=9 use_authtok sha512 shadow try_first_pass\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n",
            "refrescar": null,
            "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"sha512|shadow\"\ncat /etc/pam.d/password-auth | egrep \"sha512|shadow\"\n",
            "SO": "Linux"
        },
        {
            "modulo": "Password Requirements/Acceptance of the null password with nullok parameter",
            "clave": "PAM / NULLOK",
            "descripcion": "PAM service: '/etc/pam.d/password-auth', '/etc/pam.d/system-auth'   use pam_unix.so auth module with \"nullok\" parameter. This parameter is forbidden as it allows acceptance of the null password.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n// NOTA : Hace referencia al parametro 'nullok' en RHEL 7 y RHEL 8.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n##--- RHEL 7 & RHEL 8 ('system-auth','password-auth')\n## Los ficheros del PAM, NO deben tener en el parametro 'nullok', en los diferentes modulos\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep \"nullok\"\ncat /etc/pam.d/password-auth | grep \"nullok\"",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n// NOTA : Eliminar el parametro 'nullok', en los diferentes modulos del pam.d.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n",
            "refrescar": null,
            "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | grep \"nullok\"\ncat /etc/pam.d/password-auth | grep \"nullok\"\n",
            "SO": "Linux"
        },
        {
            "modulo": "Password Requirements/Password History",
            "clave": "PAM / REMEMBER",
            "descripcion": "PAM service file: /etc/pam.d/password-auth\nPAM service file: /etc/pam.d/system-auth\nMust have \"password sufficient pam_unix.so\" stanza with \"remember=9\" parameter. \"sufficient\" can be replaced with \"required\".",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al 'remember' en RHEL 7 y RHEL 8.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Los ficheros del PAM, deben tener en el modulo 'password    sufficient    pam_unix.so', el parámetro 'remember=9'\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep remember\ncat /etc/pam.d/password-auth | grep remember\n\n+-------------------------------------------------------------------------------------+\n## Modulo similiar : \n\n\"Encryption/Password Encryption Required\n+-------------------------------------------------------------------------------------+",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'password    sufficient    pam_unix.so', el parámetro 'remember=9'.\n\n## ('se aconseja remplazar toda la linea, del modulo 'password    sufficient    pam_unix.so').\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\n+-------------------------------------------------------------------------------------+\n## Modificar o Añadir:\n+-------------------------------------------------------------------------------------+\n\npassword    sufficient    pam_unix.so remember=9 use_authtok sha512 shadow try_first_pass\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n",
            "refrescar": null,
            "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"remember\" \ncat /etc/pam.d/password-auth | egrep \"remember\"\n",
            "SO": "Linux"
        },
        {
            "modulo": "Protecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
            "clave": "STICKY",
            "descripcion": "Sticky bit is not set on world-writable directory: $directory",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a directorios y sub-directorios\n+-------------------------------------------------------------------------------------+\n\n// El desvio trata de aplicar sticky a directorios y sub-directorios, pero aqui corregiremos permisos de W a OTHER.\n\n+-------------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada directorio BASE.\n\n\" Ya sea de tipo '/C/F/S'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT.\n// Por favor revisar la seccion de RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n// Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los directorios a cambiar permisos de W a OTHER (`RECURSIVO`).\n+-------------------------------------------------------------------------------------+\n\n\" Busca y muestra el total de directorios:\n\necho -e \"directorios con permisos w en other osr \\e[32m$directory\\e[m: \";find $directory -type d -perm -o=wx | wc -l\n\n\" Enlistar los directorios\n\nfind $directory -type d -perm -o=wx | xargs -l ls -ld\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los directorios a cambiar permisos de W a OTHER (`INDIVIDUAL`).\n+-------------------------------------------------------------------------------------+\n\nls -ld $directory\n",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n\"VARIABLES:\n\n## $directory : es la variable del directorio raiz a cambiar permisos.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los directorios ('RECURSIVO'):\n+-------------------------------------------------------------------------------------+\n\nfind $directory -type d -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma ('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $directory",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $directory -type d -perm -o=wx | wc -l\nls -ld $directory\n\n+-------------------------------------------------------------------------------------+\n## De forma ('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld $directory",
            "SO": "Linux"
        },
        {
            "modulo": "Protecting Resources-OSRs/IBMsinit Permission Restriction",
            "clave": "OSR IBMSINIT",
            "descripcion": "Invalid permissions for /etc/profile.d/IBMsinit.csh, /etc/profile.d/IBMsinit.sh\nOwner: root, Group: root, Permissions: -rw-r--r--. should be for  \"other\"  of r-x, for \"group\"  of r-x",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Deben existir /etc/profile.d/IBMsinit.sh, /etc/profile.d/IBMsinit.csh y con permisos 755.\n+-------------------------------------------------------------------------------------+\n\nls -l /etc/profile.d/IBMsinit.sh\nls -l /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------------+\n## Relacionado con :\n+-------------------------------------------------------------------------------------+\n\n\" AD.1.9.1.3 Protecting Resources - User Resources\n\" AD.1.9.1.4 Protecting Resources - User Resources",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.sh\nchmod 0755 /etc/profile.d/IBMsinit.sh\n\ntouch /etc/profile.d/IBMsinit.csh\nchmod 0755 /etc/profile.d/IBMsinit.csh\n\n",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\nls -l /etc/profile.d/IBMsinit.sh\nls -l /etc/profile.d/IBMsinit.csh",
            "SO": "Linux"
        },
        {
            "modulo": "Protecting Resources-OSRs/OSR /etc/crontab Restrictions",
            "clave": "OSR CRONTAB",
            "descripcion": "/etc/crontab  Owner: root  Group: root  Permissions: -rw-r--r--.  should have \"rw- --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\n\n+-------------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## Evidencia\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
            "SO": "Linux"
        },
        {
            "modulo": "Protecting Resources-OSRs/OSR /etc/cron.hourly Restrictions",
            "clave": "OSR CRON HOURLY",
            "descripcion": "/etc/cron.hourly  Owner: root  Group: root  Permissions: drwxr-xr-x.  should have \"rwx --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/cron.hourly\n\n+-------------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## Evidencia\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/cron.hourly\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
            "SO": "Linux"
        },
        {
            "modulo": "Protecting Resources-OSRs/OSR /etc/cron.daily Restrictions",
            "clave": "OSR CRON DAILY",
            "descripcion": "/etc/cron.daily  Owner: root  Group: root  Permissions: drwxr-xr-x.  should have \"rwx --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/cron.daily\n\n+-------------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## Evidencia\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/cron.daily\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
            "SO": "Linux"
        },
        {
            "modulo": "Protecting Resources-OSRs/OSR /etc/cron.weekly Restrictions",
            "clave": "OSR CRON WEEKLY",
            "descripcion": "/etc/cron.weekly  Owner: root  Group: root  Permissions: drwxr-xr-x.  should have \"rwx --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/cron.weekly\n\n+-------------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## Evidencia\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/cron.weekly\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
            "SO": "Linux"
        },
        {
            "modulo": "Protecting Resources-OSRs/OSR /etc/cron.monthly Restrictions",
            "clave": "OSR CRON MONTHLY",
            "descripcion": "/etc/cron.monthly  Owner: root  Group: root  Permissions: drwxr-xr-x.  should have \"rwx --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/cron.monthly\n\n+-------------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## Evidencia\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/cron.monthly\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
            "SO": "Linux"
        },
        {
            "modulo": "Protecting Resources-OSRs/OSR /etc/cron.d Restrictions",
            "clave": "OSR CRON.D",
            "descripcion": "/etc/cron.d  Owner: root  Group: root  Permissions: drwxr-xr-x.  should have \"rwx --- ---\" permissions (or more restrictive). Must be owned by user and group \"root\"",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Se cambian los permisos a : 600\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionadas :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/crontab Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.hourly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.daily Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.weekly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.monthly Restrictions\nProtecting Resources-OSRs/OSR /etc/cron.d Restrictions\n",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/cron.d\n\n+-------------------------------------------------------------------------------------+\n## Editar todas la relaciones\n+-------------------------------------------------------------------------------------+\n\nchmod 600 /etc/crontab\nchmod 600 /etc/cron.hourly \nchmod 600 /etc/cron.daily \nchmod 600 /etc/cron.weekly \nchmod 600 /etc/cron.monthly \nchmod 600 /etc/cron.d",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## Evidencia\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/cron.d\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de todas las relaciones\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld /etc/crontab\nls -ld /etc/cron.hourly \nls -ld /etc/cron.daily \nls -ld /etc/cron.weekly \nls -ld /etc/cron.monthly \nls -ld /etc/cron.d",
            "SO": "Linux"
        },
        {
            "modulo": "Protecting Resources-OSRs/OSR /TMP Files Restrictions",
            "clave": "OSRTMP",
            "descripcion": "Invalid permissions for $dirTMP  Octal permissions: 0777  Text Permissions: -rwxrwxrwx-;  May not have execute permissions on any files and no write for others.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a ficheros del directorio /TMP\n+-------------------------------------------------------------------------------------+\n\n// El desvio trata de quitarle escritura a OTHER, a ficheros que tienen escritura y ejecucion que cuelgan en el directorio /TMP y sub-directorios.\n\n+-------------------------------------------------------------------------------------+\n## Por normal general, se pueden quitar permisos en /TMP, hay casos especiales de ficheros/directorios en /TMP que empienzan por un punto (` .* `), en ese caso habria que consultarlo con el owner\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los ficheros/directorios a cambiar permisos de W en OTHER (`RECURSIVO`):\n+-------------------------------------------------------------------------------------+\n\n\" Buscar y mostrar el total de ficheros:\n\necho -e \"ficheros con permisos de W en OTHER, osr \\e[32m/tmp\\e[m: \";find /tmp/ -type f -perm -o=wx | wc -l\n\n\" Enlistar ficheros:\n\nfind /tmp/ -type f -perm -o=wx | xargs -l ls -l\n\n\" Buscar y mostrar el total de ficheros por variable:\n\necho -e \"\\nficheros con permisos W en OTHER, osr \\e[32m$dirTMP\\e[m : \";find $dirTMP -type f -perm -o=wx | wc -l\n\n\" Enlistar ficheros por variable:\n\nfind $dirTMP -type f -perm -o=wx | xargs -l ls -l\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los ficheros/directorios a cambiar permisos de W en OTHER (`INDIVIDUAL`):\n+-------------------------------------------------------------------------------------+\n\nls -l /tmp/$fichero\n\n+-------------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------------+\n\n\" Protecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n// VARIABLES:\n\n## $dirTMP : es la variable, del directorio para cambiar permiso a ficheros.\n## $fichero : es la variable, del fichero a cambiar permiso.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los ficheros('RECURSIVO'):\n+-------------------------------------------------------------------------------------+\n\nfind /tmp/ -type f -perm -o=wx -exec chmod o-w {} \\;\n\n\" Por variable\n\nfind $dirTMP -type f -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $fichero\n",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind /tmp/ -type f -perm -o=wx | wc -l\nfind $dirTMP -type f -perm -o=wx | wc -l\nls -ld /tmp/\n\n+-------------------------------------------------------------------------------------+\n## De forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -l $fichero\n",
            "SO": "Linux"
        },
        {
            "modulo": "Password Requirements/Password MAX Age /etc/shadow - Aix",
            "clave": "MAXAGE",
            "descripcion": "Account $account has invalid Password Max Age setting = 0, must be Customer Required Setting: 13; Account Type: IBM (Strictest Setting Validated). Direct login: 1      must be set to \"false\". Remote login:  1      must be set to \"false\". Id must exist in file. Value of login shell:  /usr/bin/ksh must be \"/bin/false\"",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Para aplicar un correcto MAXAGE, hay que tener en cuenta el tipo de cuenta que es:\n## Ya sea tipo /C/F/S/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /C/, --> se pasa a excepcionar con RISK e IMPACT.\n\n## (Revisar el fichero de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/ --> se cambia a 45 dias (13 semanas), ejemplo de cuentas aplicable MAXAGE : root, emer, cyberark.\n\n## Dependiendo el cliente, alguna cuentas de TIPO F, se exepcionan con RISK e IMPACT, si fuera el caso se debe hablar con el owner de la cuenta, y que nos indique un RISK e IMPACT, o del contrario si se puede aplicar MAXAGE.\n\n## (Revisar \" * ACCOUNT * \", antes de cualquier cambio)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /S/ aplicativos, por lo normal no llevan una password asignada, si ese fuera el caso, se debe preguntar al owner de la cuenta, si se le puede aplicar expiracion de passwor o bien se pasa a excepcionar\n+-------------------------------------------------------------------------------------+",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar MAXAGE a 13\n+-------------------------------------------------------------------------------------+\n\nchuser maxage=13 $account",
            "refrescar": null,
            "evidencia": "clear\ndate\nuname -a\nlsuser -a maxage $account",
            "SO": "Aix"
        },
        {
            "modulo": "Password Requirements/Password MAX Age /etc/shadow - Linux",
            "clave": "MAXAGE",
            "descripcion": "Account $account has invalid Password Max Age setting of 99999  should be set to Customer Required Setting: 45. More secure value can be set.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Para aplicar un correcto MAXAGE, hay que tener en cuenta el tipo de cuenta que es:\n## Ya sea tipo /C/F/S/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /C/, --> se pasa a excepcionar con RISK e IMPACT.\n\n## (Revisar el fichero de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/ --> se cambia a 45 dias, ejemplo de cuentas aplicable MAXAGE : root, emer, cyberark.\n\n## Dependiendo el cliente, alguna cuentas de TIPO F, se exepcionan con RISK e IMPACT, si fuera el caso se debe hablar con el owner de la cuenta, y que nos indique un RISK e IMPACT, o del contrario si se puede aplicar MAXAGE.\n\n## (Revisar \" * ACCOUNT * \", antes de cualquier cambio)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /S/ aplicativos, por lo normal no llevan una password asignada, si ese fuera el caso, se debe preguntar al owner de la cuenta, si se le puede aplicar expiracion de passwor o bien se pasa a excepcionar\n+-------------------------------------------------------------------------------------+",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar MAXAGE a 45\n+-------------------------------------------------------------------------------------+\n\nchage -M 45 $account",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\nchage -l $account\ncat /etc/passwd | grep -i $account",
            "SO": "Linux"
        },
        {
            "modulo": "AD.1.1.1.2 Password Requirements",
            "clave": "MAXAGE",
            "descripcion": "Account $account has invalid Password Max Age setting of 99999  should be set to Customer Required Setting: 45. More secure value can be set.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Para aplicar un correcto MAXAGE, hay que tener en cuenta el tipo de cuenta que es:\n## Ya sea tipo /C/F/S/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /C/, --> se pasa a excepcionar con RISK e IMPACT.\n\n## (Revisar el fichero de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/ --> se cambia a 45 dias, ejemplo de cuentas aplicable MAXAGE : root, emer, cyberark.\n\n## Dependiendo el cliente, alguna cuentas de TIPO F, se exepcionan con RISK e IMPACT, si fuera el caso se debe hablar con el owner de la cuenta, y que nos indique un RISK e IMPACT, o del contrario si se puede aplicar MAXAGE.\n\n## (Revisar \" * ACCOUNT * \", antes de cualquier cambio)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /S/ aplicativos, por lo normal no llevan una password asignada, si ese fuera el caso, se debe preguntar al owner de la cuenta, si se le puede aplicar expiracion de passwor o bien se pasa a excepcionar\n+-------------------------------------------------------------------------------------+",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar MAXAGE a 45\n+-------------------------------------------------------------------------------------+\n\nchage -M 45 $account",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\nchage -l $account\ncat /etc/passwd | grep -i $account",
            "SO": "Linux"
        },
        {
            "modulo": "Password Requirements/Password MIN Age Shadow",
            "clave": "MINAGE",
            "descripcion": "Account $account has invalid Password Min Age setting of null  should be set to Customer Required Setting: 1. Account Type: Customer",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Todas las cuentas, ya sean /C/F/S, deben tener el MINAGE a 1.\n+-------------------------------------------------------------------------------------+",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar MIANGE a 1\n+-------------------------------------------------------------------------------------+\n\nchage -m 1 $account",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\nchage -l $account\ncat /etc/passwd | grep -i $account",
            "SO": "Linux"
        },
        {
            "modulo": "Password Requirements/Password MAX Age /etc/login.defs",
            "clave": "MAXAGE DEFAULT",
            "descripcion": "Incorrect System Default maximum password age in login.defs: 45, should be set to 45 days. More stringent value can be set.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## El valor de PASS_MAX_DAYS por defecto en /etc/login.defs, debe ser 45\n+-------------------------------------------------------------------------------------+\n\ncat /etc/login.defs | grep -i 'PASS_MAX_DAYS'",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/login.defs /home/${user^^}/login.defs_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/login.defs /home/${user,,}/login.defs_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar / Modificar PASS_MAX_DAYS   45\n+-------------------------------------------------------------------------------------+\n\nvi /etc/login.defs",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\ncat /etc/login.defs | grep -i PASS_MAX_DAYS",
            "SO": "Linux"
        },
        {
            "modulo": "ZY.1.2.1 Logging - Linux",
            "clave": "LOGFILE",
            "descripcion": "Logging/SUDO Logging Enabled",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe existir `logfile` en /etc/sudoers y no está permitido `!logfile`\n+-------------------------------------------------------------------------------------+\n\ncat /etc/sudoers | grep logfile\n\n+-------------------------------------------------------------------------------------+\n## Debe existir : /var/adm/sudo.log\n+-------------------------------------------------------------------------------------+\n\nls -la /var/adm/sudo.log",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/sudoers /home/${user^^}/sudoers_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/sudoers /home/${user,,}/sudoers_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar y Añadir a sudoers: LOGFILE\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## MODIFICAR PERMISOS para editar, y volver a dejar los permisos correctos\n+-------------------------------------------------------------------------------------+\n\nchmod u+w /etc/sudoers\n\n## EDITAR\n\nvi /etc/sudoers\n\n## AÑADIR :\n\nDefaults logfile=/var/adm/sudo.log, log_year, log_host, loglinelen=0\n\n## QUITAR PERMISOS\n\nchmod u-w /etc/sudoers\n\n+-------------------------------------------------------------------------------------+\n## Crear si no existe /var/adm/sudo.log\n+-------------------------------------------------------------------------------------+\n\ntouch /var/adm/sudo.log\n\nchmod 600 /var/adm/sudo.log\n",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\ngrep logfile /etc/sudoers\nls -la /var/adm/sudo.log\nvisudo -c",
            "SO": "Linux"
        },
        {
            "modulo": "ZY.1.2.1 Logging - Aix",
            "clave": "LOGFILE",
            "descripcion": "Logging/SUDO Logging Enabled",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe existir `logfile` en /etc/sudoers y no está permitido `!logfile`\n+-------------------------------------------------------------------------------------+\n\ncat /etc/sudoers | grep logfile\n\n+-------------------------------------------------------------------------------------+\n## Debe existir : /var/log/sudo.log\n+-------------------------------------------------------------------------------------+\n\nls -la /var/log/sudo.log",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/sudoers /home/$user/sudoers_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar y Añadir a sudoers: LOGFILE\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## MODIFICAR PERMISOS para editar, y volver a dejar los permisos correctos\n+-------------------------------------------------------------------------------------+\n\nchmod u+w /etc/sudoers\n\n## EDITAR\n\nvi /etc/sudoers\n\n## AÑADIR :\n\nDefaults logfile=/var/adm/sudo.log, log_year, log_host, loglinelen=0\n\n## QUITAR PERMISOS\n\nchmod u-w /etc/sudoers\n\n+-------------------------------------------------------------------------------------+\n## Crear si no existe /var/log/sudo.log\n+-------------------------------------------------------------------------------------+\n\ntouch /var/log/sudo.log\n\nchmod 600 /var/log/sudo.log\n",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\ngrep logfile /etc/sudoers\nls -la /var/log/sudo.log\nvisudo -c",
            "SO": "Aix"
        },
        {
            "modulo": "ZY.1.2.3 Logging",
            "clave": "SECONDARY LOGGIN",
            "descripcion": "Logging/SUDO Logging Enabled",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al secondary loggin\n\n## LOGFILE hace referencia al modulo : `ZY.1.2.1 Logging`\n+-------------------------------------------------------------------------------------+",
            "copia": null,
            "editar": null,
            "refrescar": null,
            "evidencia": null,
            "SO": "Linux"
        },
        {
            "modulo": "Protecting Resources-OSRs/OSR /ETC Restrictions",
            "clave": "OSRETC",
            "descripcion": "OSR Invalid Owner or Group: directoryETC / directoryETC  Owner: ??  Group: ??  Permissions: -rwxr-xr-x  Settings for other must be r-x or more stringent. Must be owned by privileged Owner and Group",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a ficheros/directorios, sub-directorios, del directorio /ETC\n+-------------------------------------------------------------------------------------+\n\n// El desvio tarta de quitarle W a OTHER, ademas de comprobar que el owner y el grupo sean privilegiados (seccion 5.1) \n\n+-------------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner al que pertenece, cada fichero o directorio BASE.\n\n\" Ya sea de tipo '/C/F/S'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n// Por favor revisar la seccion de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner de la cuenta, si podemos modificar los permisos\n// Revisar ('PERMISSIONS'), antes de cualquier modificacion.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los ficheros/directorios a cambiar permisos de W en OTHER (`RECURSIVO`):\n+-------------------------------------------------------------------------------------+\n\n\" Buscar y mostrar el total de directorios:\n\necho -e \"directorios con permisos de W en OTHER osr \\e[32m$dirETC\\e[m : \";find $dirETC -type d -perm -o=w | wc -l\n\n\" Enlistar los directorios:\n\nfind $dirETC -type d -perm -o=w | xargs -l ls -ld\n\n\" Buscar y mostrar el total de los ficheros:\n\necho -e \"ficheros con permisos de W en OTHER osr \\e[32m$dirETC\\e[m: \";find $dirETC -type f -perm -o=w | wc -l\n\n\" Enlistar los ficheros:\n\nfind $dirETC -type f -perm -o=w | xargs -l ls -l\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los ficheros/directorios a cambiar permisos de W en OTHER (`INDIVIDUAL`):\n+-------------------------------------------------------------------------------------+\n\nls -la $fichero\n\nls -l $dirETC\n\nls -ld $dirETC\n\n+-------------------------------------------------------------------------------------+\n## Si la revision sobre permisos es correcto, el desvio sera por temas de privilegios.\n+-------------------------------------------------------------------------------------+\n\n// If owned by groups considered to be default groups for general users. (users). Active entries must be owned an id/group as identified in section 5.1 'The following system ids and group ids must own OSRs'  or id which has Security & System Administrative Authority.\n\n## Antes de cualquier modificacion, se debe consultar con el owner/group de la cuenta.\n\n+-------------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------------+\n\n\" Protecting Resources-mixed/Ensure sticky bit is set on all world-writable directories\n",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Se puede cambiar permisos W en OTHER de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n\" VARIABLES\n\n## $dirETC : es la variable del directorio BASE, para cambiar permisos en directorios / ficheros (RECURSIVO).\n\n## $fichero : es la variable del fichero a cambiar permiso (INDIVIDUAL).\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Asi cambiamos permisos de W a OTHER, en los directorios/ficheros ('RECURSIVO'):\n+-------------------------------------------------------------------------------------+\n\n\" DIRECTORIOS:\n\nfind $dirETC -type d -perm -o=w -exec chmod o-w {} \\;\n\n\" FICHEROS:\n\nfind $dirETC -type f -perm -o=w -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi cambiamos permisos de W a OTHER, de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $fichero\n\nchmod o-w dirETC\n\n+-------------------------------------------------------------------------------------+\n## Para cambiar cambiar a usuarios y grupo privilegiados, se debe saber a que grupo y usuario se debe cambiar.\n+-------------------------------------------------------------------------------------+\n\nchown $user:$group $dirETC",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## RECURSIVO\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $dirETC -type d -perm -o=w | wc -l\nfind $dirETC -type f -perm -o=w | wc -l\nls -ld $dirETC\n\n+-------------------------------------------------------------------------------------+\n## INDIVIDUAL\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld $dirETC\nls -la $fichero ",
            "SO": "Linux"
        },
        {
            "modulo": "System Settings/SELinux AppArmor install requirement",
            "clave": "SELINUX",
            "descripcion": "SELinux or AppArmor should be installed and enabled",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## 2 - DOC, Revisar RISK e IMPACT\n+-------------------------------------------------------------------------------------+\n\nGENERICO / SELINUX / CTTI\n\n+-------------------------------------------------------------------------------------+\n## Relacionado:\n+-------------------------------------------------------------------------------------+\n\nSystem Settings/SELinux type requirement\nSystem Settings/SELinux mode per domain\nSystem Settings/SELinux current mode requirement",
            "copia": null,
            "editar": null,
            "refrescar": null,
            "evidencia": null,
            "SO": "Linux"
        },
        {
            "modulo": "System Settings/SELinux type requirement",
            "clave": "SELINUX",
            "descripcion": "SELinux should be enabled",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## 2 - DOC, Revisar RISK e IMPACT\n+-------------------------------------------------------------------------------------+\n\nGENERICO / SELINUX / CTTI\n\n+-------------------------------------------------------------------------------------+\n## Relacionado:\n+-------------------------------------------------------------------------------------+\n\nSystem Settings/SELinux AppArmor install requirement\nSystem Settings/SELinux mode per domain\nSystem Settings/SELinux current mode requirement",
            "copia": null,
            "editar": null,
            "refrescar": null,
            "evidencia": null,
            "SO": "Linux"
        },
        {
            "modulo": "System Settings/SELinux mode per domain",
            "clave": "SELINUX",
            "descripcion": "SELinux module: SELinux should be enabled has forbidden state like: ':none:'",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## 2 - DOC, Revisar RISK e IMPACT\n+-------------------------------------------------------------------------------------+\n\nGENERICO / SELINUX / CTTI\n\n+-------------------------------------------------------------------------------------+\n## Relacionado:\n+-------------------------------------------------------------------------------------+\n\nSystem Settings/SELinux AppArmor install requirement\nSystem Settings/SELinux type requirement\nSystem Settings/SELinux current mode requirement",
            "copia": null,
            "editar": null,
            "refrescar": null,
            "evidencia": null,
            "SO": "Linux"
        },
        {
            "modulo": "System Settings/SELinux current mode requirement",
            "clave": "SELINUX",
            "descripcion": "SELinux should be enabled",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## 2 - DOC, Revisar RISK e IMPACT\n+-------------------------------------------------------------------------------------+\n\nGENERICO / SELINUX / CTTI\n\n+-------------------------------------------------------------------------------------+\n## Relacionado:\n+-------------------------------------------------------------------------------------+\n\nSystem Settings/SELinux AppArmor install requirement\nSystem Settings/SELinux type requirement\nSystem Settings/SELinux mode per domain",
            "copia": null,
            "editar": null,
            "refrescar": null,
            "evidencia": null,
            "SO": "Linux"
        },
        {
            "modulo": "Protecting Resources-OSRs/OSR /OPT Files Restrictions",
            "clave": "OSROPT",
            "descripcion": "Invalid permissions for $dirOPT, Octal permissions: 0777, Text Permissions: -rwxrwxrwx;  May not have execute permissions on any files and no write for others.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a ficheros del directorio /OPT\n+-------------------------------------------------------------------------------------+\n\n## El desvio trata de quitarle escritura a OTHER, a ficheros que tienen escritura y ejecucion que cuelgan en el directorio /OPT y sub-directorios.\n\n+-------------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S/'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n// (Por favor revisar la seccion de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero a cambiar permisos.\n+-------------------------------------------------------------------------------------+\n\n## FICHEROS FORMA RECURVISA:\n\necho \"ficheros con permisos w en other : \";find $dirOPT -type f -perm -o=wx | wc -l\nfind $dirOPT -type f -perm -o=wx | xargs -l ls -l\n\n## FICHERO\n\nls -l $fichero\n\n+-------------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n// VARIABLES:\n## $dirOPT : es la variable del directorio base de los ficheros a cambiar permisos.\n## $fichero : es la variable, del fichero a cambiar permiso.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los ficheros('RECURSIVO'):\n+-------------------------------------------------------------------------------------+\n\nfind $dirOPT -type f -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $fichero",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $dirOPT -type f -perm -o=wx | wc -l\nls -ld $dirOPT\n\n+-------------------------------------------------------------------------------------+\n## De forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -l $fichero",
            "SO": "Linux"
        },
        {
            "modulo": "Protecting Resources-OSRs/OSR /VAR Files Restrictions",
            "clave": "OSRVAR",
            "descripcion": "Invalid permissions for $fileVAR  Octal permissions: 0777  Text Permissions: -rwxrwxrwx;  May not have execute permissions on any files and no write for others.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a ficheros del directorio /VAR\n+-------------------------------------------------------------------------------------+\n\n## El desvio trata de quitarle escritura a OTHER, a ficheros que tienen escritura y ejecucion que cuelgan en el directorio /VAR y sub-directorios.\n\n+-------------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S/'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n// (Por favor revisar la seccion de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero a cambiar permisos.\n+-------------------------------------------------------------------------------------+\n\n## FICHEROS FORMA RECURVISA:\n\necho \"ficheros con permisos w en other : \";find $fileVAR -type f -perm -o=wx | wc -l\nfind $fileVAR -type f -perm -o=wx | xargs -l ls -l\n\n## FICHERO\n\nls -l $fichero\n\n+-------------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n// VARIABLES:\n## $fileVAR : es la variable del directorio base de los ficheros a cambiar permisos.\n## $fichero : es la variable, del fichero a cambiar permiso.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los ficheros('RECURSIVO'):\n+-------------------------------------------------------------------------------------+\n\nfind $fileVAR -type f -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $fichero",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $fileVAR -type f -perm -o=wx | wc -l\nls -ld $fileVAR\n\n+-------------------------------------------------------------------------------------+\n## De forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -l $fichero",
            "SO": "Linux"
        },
        {
            "modulo": "IZ.1.8.6.1 Protecting Resources - OSRs",
            "clave": "FAILLOG",
            "descripcion": "File /var/log/faillog must exist, owner/group: root:root, assigned permission is 600 : rw- --- --- (or more restrictive)",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe existir `/var/log/faillog` y tener permisos 600\n+-------------------------------------------------------------------------------------+\n\nls -la /var/log/faillog",
            "copia": null,
            "editar": "touch /var/log/faillog\nchmod 0600 /var/log/faillog",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\nls -la /var/log/faillog",
            "SO": "Linux"
        },
        {
            "modulo": "IZ.1.9.1.3 Protecting Resources - User Resources",
            "clave": "UMASK IBMSINIT.SH",
            "descripcion": "File /etc/profile.d/IBMsinit.sh must exist, be readable by all users, and contain at least:\nif [ $UID -gt 199 ]; then\numask 077\nfi",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe existir y contener script de UMASK\n+-------------------------------------------------------------------------------------+\n\nls -la /etc/profile.d/IBMsinit.sh\ncat /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------------+\n## Igual al MODULO : \n+-------------------------------------------------------------------------------------+\n\n\" AD.1.9.1.3 Protecting Resources - User Resources",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user^^}/IBMsinit.sh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.sh /home/${user,,}/IBMsinit.sh_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.sh\nchmod 0755 /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.sh\n\n+-------------------------------------------------------------------------------------+\n## Añadir el siguiente SCRIPT\n+-------------------------------------------------------------------------------------+\n\n#--------- begin IBMsinit.sh --------#\nif [ $UID -gt 199 ]; then\numask 077\nfi\n#--------- end IBMsinit.sh  ---------#\n\n+-------------------------------------------------------------------------------------+\n## Ademas debemos implementar la invocacion a la llamada del fichero.\n\n// NOTA: La invocacion se implementa despues de un script de UMASK.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile\n\n+-------------------------------------------------------------------------------------+\n## Añadir\n+-------------------------------------------------------------------------------------+\n\n. /etc/profile.d/IBMsinit.sh\n",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.sh\ncat /etc/profile  | grep -i  IBMsinit.sh\nls -l /etc/profile.d/IBMsinit.sh",
            "SO": "Linux"
        },
        {
            "modulo": "IZ.1.9.1.4 Protecting Resources - User Resources",
            "clave": "UMASK IBMSINIT.CSH",
            "descripcion": "File /etc/profile.d/IBMsinit.csh must exist, be readable by all users, and contain at least:\nif [ $UID -gt 199 ]; then\numask 077\nfi",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe existir y contener script de UMASK\n+-------------------------------------------------------------------------------------+\n\nls -la /etc/profile.d/IBMsinit.csh\ncat /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------------+\n## Igual al MODULO : \n+-------------------------------------------------------------------------------------+\n\n\" AD.1.9.1.4 Protecting Resources - User Resources",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.csh /home/${user^^}/IBMsinit.csh_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/profile.d/IBMsinit.csh /home/${user,,}/IBMsinit.csh_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Creamos fichero y asignamos los permisos correctos.\n+-------------------------------------------------------------------------------------+\n\ntouch /etc/profile.d/IBMsinit.csh\nchmod 0755 /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/profile.d/IBMsinit.csh\n\n+-------------------------------------------------------------------------------------+\n## Añadir el siguiente SCRIPT\n+-------------------------------------------------------------------------------------+\n\n#--------- end IBMsinit.csh  ---------#\nif ($uid > 199) then\n    umask 077\nendif\n#--------- end IBMsinit.csh  ---------#\n\n+-------------------------------------------------------------------------------------+\n## Ademas debemos implementar la invocacion a la llamada del fichero.\n## La invocacion se implementa en la ultima linea.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi  /etc/csh.login\n\n+-------------------------------------------------------------------------------------+\n## Añadir\n+-------------------------------------------------------------------------------------+\n\nsource /etc/profile.d/IBMsinit.csh",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\ncat /etc/profile.d/IBMsinit.csh\ncat /etc/csh.login  | grep -i  IBMsinit.csh\nls -l /etc/profile.d/IBMsinit.csh",
            "SO": "Linux"
        },
        {
            "modulo": "Logging/Log Verbosity Shared ID",
            "clave": "LOGLEVEL",
            "descripcion": "SSH Config File: /etc/ssh/sshd_config; Invalid setting (value: !default!) in parameter 'LogLevel': must be set to VERBOSE or higher.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## LogLevel, debe establecerse en:\n+-------------------------------------------------------------------------------------+\n\nLogLevel VERBOSE\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep LogLevel\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep LogLevel",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar y añadir LogLevel VERBOSE, si esta comentado (#), descomentar.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n+-------------------------------------------------------------------------------------+\n\nLogLevel VERBOSE\n",
            "refrescar": "systemctl stop sshd\nsystemctl start sshd",
            "evidencia": "clear\ndate\nhostname\n/usr/sbin/sshd -T|grep LogLevel\ncat /etc/ssh/sshd_config | grep LogLevel",
            "SO": "Linux"
        },
        {
            "modulo": "Business Use Notice/PrintMotd Restriction",
            "clave": "SSHD_CONFIG / PRINTMOTD",
            "descripcion": "SSH Config File: /etc/ssh/sshd_config; Invalid setting (value: 0) in parameter 'PrintMotd': must be set to 'yes'.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## PrintMotd, debe establecerse en:\n+-------------------------------------------------------------------------------------+\n\nPrintMotd yes\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T | grep -i PrintMotd\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep PrintMotd",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar y añadir PrintMotd yes, si esta comentado (#), descomentar.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n+-------------------------------------------------------------------------------------+\n\nPrintMotd yes\n",
            "refrescar": "+-------------------------------------------------------------------------------------+\n ## LINUX\n+-------------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------------+\n## UNIX\n+-------------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd\n",
            "evidencia": "clear\ndate\nhostname\n/usr/sbin/sshd -T | grep -i PrintMotd\ncat /etc/ssh/sshd_config | grep PrintMotd",
            "SO": "Linux / Aix"
        },
        {
            "modulo": "Password Requirements/Password MIN Length and complexity - RHL8",
            "clave": "PAM / MINLEN",
            "descripcion": "Incorrect System Default minimum password length or password complexity rules. Minimum password length should be set to 14 or more secure, in file \n/etc/pam.d/password-auth\n/etc/pam.d/system-auth.\nIt should be set through pam_cracklib.so or pam_pwquality.so. For more information about password length or password complexity rules see matrix coverage document.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al 'minlen'.\n\n## Los ficheros del PAM, deben tener en el modulo 'password    required      pam_pwquality.so', el parámetro 'minlen=14'\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep minlen\ncat /etc/pam.d/password-auth | grep minlen\n",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'password    required      pam_pwquality.so', el parámetro 'minlen=14'.\n\n## ('se aconseja remplazar toda la linea, del modulo 'password    required      pam_pwquality.so'.\n\n## Se debe establecer por encima de un modulo ' password    sufficient pam_unix.so').\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\n+-------------------------------------------------------------------------------------+\n## Modificar o Añadir:\n+-------------------------------------------------------------------------------------+\n\npassword    required      pam_pwquality.so try_first_pass retry=3 minlen=14 dcredit=-1 ucredit=0 lcredit=-1 ocredit=0 reject_username enforce_for_root\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n",
            "refrescar": null,
            "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"minlen\" \ncat /etc/pam.d/password-auth | egrep \"minlen\"",
            "SO": "Linux RHEL 8"
        },
        {
            "modulo": "Password Requirements/Password MIN Length and complexity - RHL7",
            "clave": "PAM / MINLEN",
            "descripcion": "Incorrect System Default minimum password length or password complexity rules. Minimum password length should be set to 14 or more secure, in file \n/etc/pam.d/password-auth\n/etc/pam.d/system-auth.\nIt should be set through pam_cracklib.so or pam_pwquality.so. For more information about password length or password complexity rules see matrix coverage document.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al 'minlen'.\n\n## Los ficheros del PAM, deben tener en el modulo 'password    required      pam_cracklib.so', el parámetro 'minlen=14'\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep minlen\ncat /etc/pam.d/password-auth | grep minlen\n",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'password    required      pam_cracklib.so', el parámetro 'minlen=14'.\n\n## ('se aconseja remplazar toda la linea, del modulo 'password    required      pam_cracklib.so'.\n\n## Se debe establecer por encima de un modulo ' password    sufficient pam_unix.so').\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\n+-------------------------------------------------------------------------------------+\n## Modificar o Añadir:\n+-------------------------------------------------------------------------------------+\n\npassword    required      pam_cracklib.so try_first_pass retry=3 minlen=14 dcredit=-1 ucredit=0 lcredit=-1 ocredit=0 reject_username\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n",
            "refrescar": null,
            "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"minlen\" \ncat /etc/pam.d/password-auth | egrep \"minlen\"",
            "SO": "Linux RHEL 7"
        },
        {
            "modulo": "Protecting Resources-User Resources/Login.defs umask restriction",
            "clave": "UMASK DEFAULT",
            "descripcion": "File /etc/login.defs include invalid umask setting 22. Should be set 077. More stringent value can be set.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## El valor de umask por defecto en /etc/login.defs, debe ser 077\n+-------------------------------------------------------------------------------------+\n\ncat /etc/login.defs | grep -i 'umask'",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/login.defs /home/${user^^}/login.defs_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/login.defs /home/${user,,}/login.defs_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar / Añadir UMASK 077\n+-------------------------------------------------------------------------------------+\n\nvi /etc/login.defs",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\ncat /etc/login.defs | grep -i umask",
            "SO": "Linux"
        },
        {
            "modulo": "Network Settings/X-server access control",
            "clave": "XSERVER",
            "descripcion": "Fileset X11.apps.config must not own file /usr/lpp/X11/bin/xhost.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## El fileset xhost no deberia instalarse.\n+-------------------------------------------------------------------------------------+\n\nlslpp -w /usr/lpp/X11/bin/xhost",
            "copia": null,
            "editar": "installp -g -u  X11.apps.config",
            "refrescar": null,
            "evidencia": "clear\ndate\nuname -a\nlslpp -w /usr/lpp/X11/bin/xhost",
            "SO": "Aix"
        },
        {
            "modulo": "Network Settings/Xserver Access Control",
            "clave": "XSERVER",
            "descripcion": "Fileset X11.apps.config must not own file /usr/lpp/X11/bin/xhost.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## El fileset xhost no deberia instalarse.\n+-------------------------------------------------------------------------------------+\n\nlslpp -w /usr/lpp/X11/bin/xhost",
            "copia": null,
            "editar": "installp -g -u  X11.apps.config",
            "refrescar": null,
            "evidencia": "clear\ndate\nuname -a\nlslpp -w /usr/lpp/X11/bin/xhost",
            "SO": "Aix"
        },
        {
            "modulo": "Identify and Authenticate Users/PermitRootLogin Restriction",
            "clave": "SSHD_CONFIG / PERMITROOTLOGIN",
            "descripcion": "SSH Config File: /etc/ssh/sshd_config; Invalid setting (value:yes) in parameter 'PermitRootLogin': must be set to 'no'. May be set to YES, FORCED-COMMANDS-ONLY,or WITHOUT-PASSWORD only if mechanisms are in place to determine the identity of the individual accessing the system.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Por lo normal general, si la issue es `Initial - Deviation Management`, se recomienda el VALOR a NO, puede estar a YES por temas de instalacion del sistema (se puede confirmar con SOPORTE).\n## Sea el caso de instalaciones, se puede esperar a que terminen y pongan el parametro a NO.\n\n## Ademas se pueden revisar los siguientes puntos:\n+-------------------------------------------------------------------------------------+\n\n## 1 - Que no estén los valores correctos `por defecto`.\n\n## 2 - Que `no este excepcionado` revisar (SERVICE).\n\n## 3 - Que no sea un Cluster de GPFS.\n\n// RECOMENDACION : 'Si hay dudas, hablar con SOPORTE'.\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto, valor por defecto correcto es : No\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T | grep -i PermitRootLogin\n\n+-------------------------------------------------------------------------------------+\n## Comprobar si no es `cluster` que tiene montado un GPFS.\n+-------------------------------------------------------------------------------------+\n\n/usr/es/sbin/cluster/utilities/clRGinfo\n/usr/lpp/mmfs/bin/mmgetstate\nps -aux | grep -i mmfs\n",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config\n\n+-------------------------------------------------------------------------------------+\n## Añadir el valor `no`, al parámetro PermitRootLogin.\n\n## Debe quedar algo asi:\n+-------------------------------------------------------------------------------------+\n\nPermitRootLogin no\n+-------------------------------------------------------------------------------------+\n",
            "refrescar": "+-------------------------------------------------------------------------------------+\n## Linux\n+-------------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd",
            "evidencia": "clear\ndate\nhostname\n/usr/sbin/sshd -T | grep -i PermitRootLogin\ncat /etc/ssh/sshd_config | grep PermitRootLogin",
            "SO": "Linux / Aix"
        }
    ]
}
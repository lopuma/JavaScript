{
    "CESCE": [
        {
            "modulo": "Protecting Resources-OSRs/Log File Restrictions",
            "clave": "WTMP",
            "descripcion": "Invalid Permissions or Ownership for log file: /var/log/wtmp;   -rw-rw-r--.;  owner:  root;   group:  utmp. For more information see rule description.",
            "comprobacion": "## Se le debe quitar W al grupo.\n\n+-------------------------------------------------------------------------------------+\n## Comprobar que en logrotate.conf, tenga permisosa 0644\n+-------------------------------------------------------------------------------------+\n\ncat /etc/logrotate.conf | grep -w wtmp -A4\n\ncat /etc/logrotate.d/* | grep -w wtmp -A4",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user^^}/logrotate.conf_`date +%d%m%y`\ncp -p /etc/logrotate.d/wtmp /home/${user^^}/logrotate_wtmp_`date +%d%m%y`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user,,}/logrotate.conf_`date +%d%m%y`\ncp -p /etc/logrotate.d/wtmp /home/${user,,}/logrotate_wtmp_`date +%d%m%y`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Quitar permisos al fichero\n+-------------------------------------------------------------------------------------+\n\nchmod g-w /var/log/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 7:\n+-------------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /lib/tmpfiles.d/var.conf\n\n## Debe quedar la linea asi:\n\nf /var/log/wtmp 0644 root utmp -\n\n+-------------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 6\n+-------------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /etc/rc.sysinit\n\n## Dejar la linea asi:\n\nchmod 0644 /var/run/utmp /var/log/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Corregir los permisos en logrotate.conf O en /etc/logrotate.d/wtmp, en create de wtmp\n+-------------------------------------------------------------------------------------+\n\nvi /etc/logrotate.conf\n\nvi /etc/logrotate.d/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Modificar los permisos de 0664, a 0644, al fichero /var/log/wtmp\n+-------------------------------------------------------------------------------------+",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## RHEL 6\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /var/log/wtmp\ncat cat /etc/rc.sysinit | grep -w 'wtmp'\ncat /etc/logrotate.conf | grep -w wtmp -A4\n\n+-------------------------------------------------------------------------------------+\n## RHEL 7\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /var/log/wtmp\ncat /lib/tmpfiles.d/var.conf | grep -w wtmp\ncd /etc/logrotate.d/\ngrep -irw  wtmp -A7 --color=always\n",
            "SO": "Linux / Debian"
        },
        {
            "modulo": "ZY.1.2.4 Logging - Linux / Logrotate.conf",
            "clave": "SUDO LOGROTATE",
            "descripcion": "Retain Logging for a period of time - either online or backups, Minimum of 180 days",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Rotación para SUDO - Linux, basada en LOGROTATE.CONF a 180 dias\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Debe estar en 'weekly' 'rotate 26'\n+-------------------------------------------------------------------------------------+\n\nhead -10 /etc/logrotate.conf\n\n+-------------------------------------------------------------------------------------+\n## Si La rotacion de log se define en el fichero de configuracion, deben estar DESCOMENTADAS las variables para SUDO\n+-------------------------------------------------------------------------------------+\n\ncat /etc/logrotate.conf | egrep -i \"sudo.log\" -A5 --color=always\n\n+-------------------------------------------------------------------------------------+\n## Si la configuracion de rotado para sudo, no existe en logrotate.conf, debe estar implementado en logrotate.d\n## Tambien puede existir un fichero llamado sudo, dentro de /etc/logrotate.d/, tambien debe rotar a 180 dias..\n## NOTA : no puede estar duplicada la entrada para /var/adm/sudo.log\n+-------------------------------------------------------------------------------------+\n\ncat /etc/logrotate.d/* | egrep -i \"sudo.log\" -A7 --color=always\n\n+-------------------------------------------------------------------------------------+\n## ## Para sistemas Linux, el fichero sudo.log es : /var/adm/sudo.log y deben tener permisos 600.\n+-------------------------------------------------------------------------------------+\n\nls -la /var/adm/sudo.log\n",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user^^}/logrotate_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user,,}/logrotate_`date +%d%m%y_%T`\n\n\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar /  Añadir el valor de rotate a 26\n+-------------------------------------------------------------------------------------+\n\nvi /etc/logrotate.conf\n\n+-------------------------------------------------------------------------------------+\n## Añadimos el fichero de `/var/adm/sudo.log` en `/etc/logrotate.d/syslog`, O si existe un fichero para sudo, editarlo y corregir el rotado\n+-------------------------------------------------------------------------------------+\n\ncd /etc/logrotate.d/\n\nvi /etc/logrotate.d/syslog\n\n+-------------------------------------------------------------------------------------+\n## Corregir permisos del fichero sudo.log, si fuera necesario\n+-------------------------------------------------------------------------------------+\n\nchmod 0600 /var/adm/sudo.log\n\n",
            "refrescar": "logrotate -f /etc/logrotate.conf",
            "evidencia": "clear\ndate\nhostname\nhead -10 /etc/logrotate.conf\ncat /etc/logrotate.conf | egrep -i \"sudo.log\" -A5 --color=always\ncat /etc/logrotate.d/* | egrep -i \"sudo.log\" -A7 --color=always\nls -la /var/adm/sudo.log",
            "SO": "Linux"
        },
        {
            "modulo": "Password Requirements/Password MIN Length and complexity - RHL8",
            "clave": "PAM / MINLEN",
            "descripcion": "Incorrect System Default minimum password length or password complexity rules. Minimum password length should be set to 8 or more secure, in file \n/etc/pam.d/password-auth\n/etc/pam.d/system-auth.\nIt should be set through pam_cracklib.so or pam_pwquality.so. For more information about password length or password complexity rules see matrix coverage document.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al 'minlen'.\n\n## Los ficheros del PAM, deben tener en el modulo 'password    required      pam_pwquality.so', el parámetro 'minlen=15'\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep minlen\ncat /etc/pam.d/password-auth | grep minlen\n",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'password    required      pam_pwquality.so', el parámetro 'minlen=15'.\n\n## ('se aconseja remplazar toda la linea, del modulo 'password    required      pam_pwquality.so'.\n\n## Se debe establecer por encima de un modulo ' password    sufficient pam_unix.so').\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\n+-------------------------------------------------------------------------------------+\n## Modificar o Añadir:\n+-------------------------------------------------------------------------------------+\n\npassword    required      pam_pwquality.so try_first_pass retry=3 minlen=15 dcredit=-1 ucredit=0 lcredit=-1 ocredit=0 reject_username enforce_for_root\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n",
            "refrescar": null,
            "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"minlen\" \ncat /etc/pam.d/password-auth | egrep \"minlen\"",
            "SO": "Linux RHEL 8"
        },
        {
            "modulo": "Password Requirements/Password MIN Length and complexity - RHL7",
            "clave": "PAM / MINLEN",
            "descripcion": "Incorrect System Default minimum password length or password complexity rules. Minimum password length should be set to 8 or more secure, in file \n/etc/pam.d/password-auth\n/etc/pam.d/system-auth.\nIt should be set through pam_cracklib.so or pam_pwquality.so. For more information about password length or password complexity rules see matrix coverage document.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al 'minlen'.\n\n## Los ficheros del PAM, deben tener en el modulo 'password    required      pam_cracklib.so', el parámetro 'minlen=15'\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep minlen\ncat /etc/pam.d/password-auth | grep minlen\n",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'password    required      pam_cracklib.so', el parámetro 'minlen=15'.\n\n## ('se aconseja remplazar toda la linea, del modulo 'password    required      pam_cracklib.so'.\n\n## Se debe establecer por encima de un modulo ' password    sufficient pam_unix.so').\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\n+-------------------------------------------------------------------------------------+\n## Modificar o Añadir:\n+-------------------------------------------------------------------------------------+\n\npassword    required      pam_cracklib.so try_first_pass retry=3 minlen=15 dcredit=-1 ucredit=0 lcredit=-1 ocredit=0 reject_username\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n",
            "refrescar": null,
            "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"minlen\" \ncat /etc/pam.d/password-auth | egrep \"minlen\"",
            "SO": "Linux RHEL 7"
        },
        {
            "modulo": "AD.1.8.7.2 Protecting Resources - OSRs",
            "clave": "WTMP",
            "descripcion": "Invalid Permissions or Ownership for log file: /var/log/wtmp;   -rw-rw-r--.;  owner:  root;   group:  utmp. For more information see rule description.",
            "comprobacion": "## Se le debe quitar W al grupo.\n\n+-------------------------------------------------------------------------------------+\n## Comprobar que en logrotate.conf, tenga permisosa 0644\n+-------------------------------------------------------------------------------------+\n\ncat /etc/logrotate.conf | grep -w wtmp -A4\n\ncat /etc/logrotate.d/* | grep -w wtmp -A4",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user^^}/logrotate.conf_`date +%d%m%y`\ncp -p /etc/logrotate.d/wtmp /home/${user^^}/logrotate_wtmp_`date +%d%m%y`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user,,}/logrotate.conf_`date +%d%m%y`\ncp -p /etc/logrotate.d/wtmp /home/${user,,}/logrotate_wtmp_`date +%d%m%y`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Quitar permisos al fichero\n+-------------------------------------------------------------------------------------+\n\nchmod g-w /var/log/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 7:\n+-------------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /lib/tmpfiles.d/var.conf\n\n## Debe quedar la linea asi:\n\nf /var/log/wtmp 0644 root utmp -\n\n+-------------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 6\n+-------------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /etc/rc.sysinit\n\n## Dejar la linea asi:\n\nchmod 0644 /var/run/utmp /var/log/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Corregir los permisos en logrotate.conf O en /etc/logrotate.d/wtmp, en create de wtmp\n+-------------------------------------------------------------------------------------+\n\nvi /etc/logrotate.conf\n\nvi /etc/logrotate.d/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Modificar los permisos de 0664, a 0644, al fichero /var/log/wtmp\n+-------------------------------------------------------------------------------------+",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## RHEL 6\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /var/log/wtmp\ncat cat /etc/rc.sysinit | grep -w 'wtmp'\ncat /etc/logrotate.conf | grep -w wtmp -A4\n\n+-------------------------------------------------------------------------------------+\n## RHEL 7\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /var/log/wtmp\ncat /lib/tmpfiles.d/var.conf | grep -w wtmp\ncd /etc/logrotate.d/\ngrep -irw  wtmp -A7 --color=always\n",
            "SO": "Linux / Debian"
        },
        {
            "modulo": "Network Settings/Ensure nfs-utils is not enabled and active",
            "clave": "NFS",
            "descripcion": "Ensure nfs is not active. Command: systemctl is-active nfs\nEnsure nfs is not enabled. Command: systemctl is-enabled nfs",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## No es un servicio requerido, por lo que se puede deshabilitar.\n## Antes de nada comprobar que no tenga: shares/filesystem compartiendo.\n## Debe salir vacio\n+-------------------------------------------------------------------------------------+\n\ncat /etc/exports\n\n+-------------------------------------------------------------------------------------+\n## En el caso de tener shares/filesystem, contactar con el SOPORTE TECNICO.\n+-------------------------------------------------------------------------------------+\n\nsystemctl status nfs\n\n+-------------------------------------------------------------------------------------+\n## Debe salir disable en todo :\n(/usr/lib/systemd/system/nfs-server.service; disabled; vendor preset: disabled)\n+-------------------------------------------------------------------------------------+",
            "copia": null,
            "editar": "systemctl stop nfs.service\nsystemctl disable nfs.service",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\nsystemctl status nfs.service",
            "SO": "Linux"
        },
        {
            "modulo": "Password Requirements/Private Key File Restriction",
            "clave": "AUTHORIZED_KEY",
            "descripcion": "SSH authorized_keys file: \"FICHERO AUTHORIZED KEYS\"; Invalid from section: . \"*º\" or \"*.*.*.*\" or \"0/0\" or \"0.0.0.0/0\" or empty are forbidden values in the \"from=\" parameter",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves publicas (\"authorized_keys\")\n## Deben tener un FROM que especifique el host remoto o direccion IP.\n\n## Antes de seguir, revisar ('AUTHORIZED')\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene un FROM, que especifica el host remoto o IP\n## Debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_authorized\ncat $file_authorized\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys pertenece a la cuenta root, Root no debe tener un fichero authorized_keys.\n## Pasamos directamente a renombrar el fichero authorized_keys para el owner root.\n\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n\" --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys es de TIPO /F/ o /S/ (sistemas / aplicativo)\n## Se debe notificar al owner o grupo del fichero.\n\n## - Si se va a excepcionar nos deben especificar un RISK e IMPACT.\n\n## - Si se va a corregir (nos deben facilitar la IP o HOST).\n+-------------------------------------------------------------------------------------+\n## Si es de TIPO /C/ (customer)\n\n## - Se debe excepcionar.\n\n## Revisar RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n\" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys, es de tipo /E/. /I/./K/\n\n## - Si es una cuenta 'externa' y no existe en el servidor, se puede renombrar el fichero authorized_key.\n\n## - Si la cuenta existe, se debe notificar al owner de la cuenta.\n+-------------------------------------------------------------------------------------+",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user^^}/authorized_key_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user,,}/authorized_key_`date +%d%m%y_%T`\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p \"$file_authorized\" /home/$user/authorized_key_`date +%d%m%y_%T`\n",
            "editar": "\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/authorized_keys /home/root/.ssh/authorized_keys.save\n\n\n\" --> OPCION 2 y \" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/ o sin owner o account externas/internas de tipo /E/ o /I/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Donde se tengan que renombar el fichero.\n+-------------------------------------------------------------------------------------+\n\nmv $file_authorized $file_authorized.save\n\n+-------------------------------------------------------------------------------------+\n## Donde se tenga que añadir un FROM.\n+-------------------------------------------------------------------------------------+\n\nvi $file_authorized\n\n+-------------------------------------------------------------------------------------+\n## Añadir la línea from=\"IP\", al inicio de cada clave shh-rsa:\n+-------------------------------------------------------------------------------------+\n## EJEMPLO\n\nfrom=\"129.39.41.5,129.39.41.6\" ssh-rsa AAAAB3NzaC1yc2EAAAABIw== !!CZ/S/*ABJ83/IBM/Automation ID!!\n",
            "refrescar": null,
            "evidencia": "\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /home/root/.ssh/authorized_keys\n\n\n\" --> OPCION 2 y \" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/, sin owner o account externas/internas tipo /E/, /I/ /K/\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la $file_authorized\ncat $file_authorized",
            "SO": "Linux"
        },
        {
            "modulo": "Password Requirements/Login Retries - RHEL 7",
            "clave": "PAM / TALLY",
            "descripcion": "Non of the Login Retrie options was found in file:\n/etc/pam.d/password-auth\n/etc/pam.d/system-auth",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al 'pam_tally2.so.'\n+-------------------------------------------------------------------------------------+\n\n##-*** Saber que PAM_TALLY USA ****-#\n\nls -ltr /lib64/security/pam_tally*\n\n+-------------------------------------------------------------------------------------+\n## ('system-auth','password-auth')\n\n## Los ficheros del PAM, deben tener los parámetros:\n\n// `auth        required      pam_tally2.so deny=5`\n// `account     required      pam_tally2.so`\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep pam_tally\ncat /etc/pam.d/password-auth | grep pam_tally\n",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Se debe añadir en la primera linea de su modulo.\n\n## ('se aconseja remplazar la linea del modulo')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\n+-------------------------------------------------------------------------------------+\n## Modificar o Añadir:\n+-------------------------------------------------------------------------------------+\n\nauth        required      pam_tally2.so deny=5\n\n+-------------------------------------------------------------------------------------+\n## Modificar o Añadir:\n+-------------------------------------------------------------------------------------+\n\naccount     required      pam_tally2.so\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n\n",
            "refrescar": null,
            "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"pam_tally\" \ncat /etc/pam.d/password-auth | egrep \"pam_tally\"\n",
            "SO": "Linux"
        },
        {
            "modulo": "Password Requirements/Login Retries - RHEL 8",
            "clave": "PAM / FAILLOCK",
            "descripcion": "Non of the Login Retrie options was found in file:\n/etc/pam.d/password-auth\n/etc/pam.d/system-auth",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al 'pam_faillock.so.'\n+-------------------------------------------------------------------------------------+\n\n##-*** Saber que PAM_FAILLOCK USA ****-#\n\nls -la /usr/sbin/faillock*\n\n+-------------------------------------------------------------------------------------+\n## ('system-auth','password-auth')\n\n## Los ficheros del PAM, deben tener los parámetros:\n\n// `auth        required      pam_faillock.so preauth silent deny=5 unlock_time=0`\n// `auth        [default=die] pam_faillock.so authfail deny=5 unlock_time=0`\n\n// `account     required      pam_faillock.so`\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep pam_faillock\ncat /etc/pam.d/password-auth | grep pam_faillock\n",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Se debe añadir en la primera linea de su modulo.\n\n## ('se aconseja remplazar la linea del modulo')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\n+-------------------------------------------------------------------------------------+\n## Modificar o Añadir:\n+-------------------------------------------------------------------------------------+\n\nauth        required        pam_faillock.so preauth silent deny=5 unlock_time=0\n\n+-------------------------------------------------------------------------------------+\n## Ademas se debe añadir la siguiente linea, por encima de 'auth required pam_deny.so'\n+-------------------------------------------------------------------------------------+\n\nauth        [default=die] pam_faillock.so authfail deny=5 unlock_time=0\n\n+-------------------------------------------------------------------------------------+\n## Modificar o Añadir:\n+-------------------------------------------------------------------------------------+\n\naccount     required      pam_faillock.so\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n\n",
            "refrescar": null,
            "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"pam_faillock\" \ncat /etc/pam.d/password-auth | egrep \"pam_faillock\"\n",
            "SO": "Linux"
        },
        {
            "modulo": "Encryption/System wide Cryptographic policies requirement",
            "clave": "CRYPTOGRAPHIC",
            "descripcion": "\"update-crypto-policies --show\" command indicates: LEGACY. It is in the list of prohibited crypto policy types: 'LEGACY'",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Comprobar que el valor sea DEFAULT\n+-------------------------------------------------------------------------------------+\n\nupdate-crypto-policies --show",
            "copia": null,
            "editar": "update-crypto-policies --set DEFAULT",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\nupdate-crypto-policies --show\nupdate-crypto-policies --is-applied",
            "SO": "Linux"
        },
        {
            "modulo": "Network Settings/Configure vsftpd service where anonymous ftp is permitted",
            "clave": "ANONYMOUS",
            "descripcion": "/etc/vsftpd/user_list file must exist and may only contain these lines: \"ftp\", \"anonymous\"\n\n/etc/vsftpd/vsftpd.conf file must exist and contain these lines: \"userlist_deny=NO\" and \"userlist_enable=YES\"",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Si vsftpd esta activo y enabled, deben tener las siguientes configuraciones.\n\n## \"ftp\", \"anonymous\" debe existir en /etc/vsftpd/user_list\n## \"userlist_deny=NO\" and \"userlist_enable=YES\" debe existir /etc/vsftpd/vsftpd.conf\n+-------------------------------------------------------------------------------------+\n\ncat /etc/vsftpd/user_list | egrep -i \"ftp|anonymous\"\ncat /etc/vsftpd/vsftpd.conf | grep -i \"userlist\"",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/vsftpd/user_list /home/${user^^}/user_list_`date +%d%m%y_%T`\n\ncp -p /etc/vsftpd/vsftpd.conf /home/${user^^}/vsftpd.conf_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/vsftpd/user_list /home/${user,,}/user_list_`date +%d%m%y_%T`\n\ncp -p /etc/vsftpd/vsftpd.conf /home/${user,,}/vsftpd.conf_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar y Añadir las siguientes lineas.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/vsftpd/user_list\n\n## Añadir ftp y anonymous, en diferentes lineas\n\nvi /etc/vsftpd/vsftpd.conf\n\n## Añadir userlist_deny=NO y userlist_enable=YES en diferentes lineas\n",
            "refrescar": "systemctl restart vsftpd",
            "evidencia": "clear\ndate\nhostname\ncat /etc/vsftpd/user_list | egrep -i \"ftp|anonymous\"\ncat /etc/vsftpd/vsftpd.conf | grep -i \"userlist\"\nsystemctl status vsftpd",
            "SO": "Linux"
        },
        {
            "modulo": "Password Requirements/Duplicate GIDs Forbidden",
            "clave": "GID DUPLICATE",
            "descripcion": "Duplicate GID for Group: $GRUPO, GID: xxxx. Each GID must only be used once",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hay que revisar si son grupo que tienen cuentas de clientes, y se excepcionan.\n\nGENERICO /  GID duplicate / CUSTOMER\n\n## Si no es de cliente, se debe revisar con el tecnico, por si es un error de creacion de grupo.\n\n## Debemos hacer un \"cat /etc/group\" al grupo y de la lista de usuario que nos da, hacer un \"cat /etc/passwd\" y comprobar que tipo de cuenta es.\n+-------------------------------------------------------------------------------------+",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Lo deberia de cambiar el tecnico o almenos decirnos que GID deberia tener ese grupo\n+-------------------------------------------------------------------------------------+\n\ngroupmod -g NUEVOGID $GRUPO",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\ncat /etc/passwd | grep $GRUPO",
            "SO": "Linux"
        },
        {
            "modulo": "Password Requirements/Duplicate UIDs Forbidden",
            "clave": "UID DUPLICATE",
            "descripcion": "Duplicate UID for Account: $USUARIO, UID: xxxx. Each UID must only be used once",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hay que revisar si son cuentas de clientes, y se excepcionan.\n\nGENERICO /  UID duplicate / CUSTOMER\n\n## Si no es de cliente, se debe revisar con el tecnico, por si es un error de creacion de usuario.\n\n## Debemos hacer un \"cat /etc/passwd\" y comprobar que tipo de cuenta es.\n+-------------------------------------------------------------------------------------+",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\nLo deberia de cambiar el tecnico o almenos decirnos que UID deberia tener esa cuenta\n+-------------------------------------------------------------------------------------+\n\nusermod -u NUEVOUID $USUARIO",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\ncat /etc/passwd | grep $USUARIO",
            "SO": "Linux"
        },
        {
            "modulo": "Identify and Authenticate Users/PermitRootLogin Restriction",
            "clave": "SSHD_CONFIG / PERMITROOTLOGIN",
            "descripcion": "SSH Config File: /etc/ssh/sshd_config; Invalid setting (value:yes) in parameter 'PermitRootLogin': must be set to 'no'. May be set to YES, FORCED-COMMANDS-ONLY,or WITHOUT-PASSWORD only if mechanisms are in place to determine the identity of the individual accessing the system.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Por lo normal general, si la issue es `Initial - Deviation Management`, se recomienda el VALOR a NO, puede estar a YES por temas de instalacion del sistema (se puede confirmar con SOPORTE).\n## Sea el caso de instalaciones, se puede esperar a que terminen y pongan el parametro a NO.\n\n## Ademas se pueden revisar los siguientes puntos:\n+-------------------------------------------------------------------------------------+\n\n## 1 - Que no estén los valores correctos `por defecto`.\n\n## 2 - Que `no este excepcionado` revisar (SERVICE).\n\n## 3 - Que no sea un Cluster de GPFS.\n\n// RECOMENDACION : 'Si hay dudas, hablar con SOPORTE'.\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto, valor por defecto correcto es : No\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T | grep -i PermitRootLogin\n\n+-------------------------------------------------------------------------------------+\n## Comprobar si no es `cluster` que tiene montado un GPFS.\n+-------------------------------------------------------------------------------------+\n\n/usr/es/sbin/cluster/utilities/clRGinfo\n/usr/lpp/mmfs/bin/mmgetstate\nps -aux | grep -i mmfs\n",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config\n\n+-------------------------------------------------------------------------------------+\n## Añadir el valor `no`, al parámetro PermitRootLogin.\n\n## Debe quedar algo asi:\n+-------------------------------------------------------------------------------------+\n\nPermitRootLogin no\n+-------------------------------------------------------------------------------------+\n",
            "refrescar": "+-------------------------------------------------------------------------------------+\n## Linux\n+-------------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd",
            "evidencia": "clear\ndate\nhostname\n/usr/sbin/sshd -T | grep -i PermitRootLogin\ncat /etc/ssh/sshd_config | grep PermitRootLogin",
            "SO": "Linux / Aix"
        },
        {
            "modulo": "Password Requirements/Password MAX Age /etc/shadow",
            "clave": "MAXAGE",
            "descripcion": "Account $account has invalid Password Max Age setting of 99999  should be set to Customer Required Setting: 90. More secure value can be set.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Para aplicar un correcto MAXAGE, hay que tener en cuenta el tipo de cuenta que es:\n## Ya sea tipo /C/F/S/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /C/, --> se pasa a excepcionar con RISK e IMPACT.\n\n## (Revisar el fichero de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/ --> se cambia a 90 dias, ejemplo de cuentas aplicable MAXAGE : root, emer, cyberark.\n\n## Dependiendo el cliente, alguna cuentas de TIPO F, se exepcionan con RISK e IMPACT, si fuera el caso se debe hablar con el owner de la cuenta, y que nos indique un RISK e IMPACT, o del contrario si se puede aplicar MAXAGE.\n\n## (Revisar \" * ACCOUNT * \", antes de cualquier cambio)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /S/ aplicativos, por lo normal no llevan una password asignada, si ese fuera el caso, se debe preguntar al owner de la cuenta, si se le puede aplicar expiracion de passwor o bien se pasa a excepcionar\n+-------------------------------------------------------------------------------------+",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar MAXAGE a 90\n+-------------------------------------------------------------------------------------+\n\nchage -M 90 $account",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\nchage -l $account\ncat /etc/passwd | grep -i $account",
            "SO": "Linux"
        },
        {
            "modulo": "Protecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
            "clave": "STICKY",
            "descripcion": "Sticky bit is not set on world-writable directory: $directory",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a directorios y sub-directorios\n+-------------------------------------------------------------------------------------+\n\n// El desvio trata de aplicar sticky a directorios y sub-directorios, pero aqui corregiremos permisos de W a OTHER.\n\n+-------------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada directorio BASE.\n\n\" Ya sea de tipo '/C/F/S'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT.\n// Por favor revisar la seccion de RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n// Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los directorios a cambiar permisos de W a OTHER (`RECURSIVO`).\n+-------------------------------------------------------------------------------------+\n\n\" Busca y muestra el total de directorios:\n\necho -e \"directorios con permisos w en other osr \\e[32m$directory\\e[m: \";find $directory -type d -perm -o=wx | wc -l\n\n\" Enlistar los directorios\n\nfind $directory -type d -perm -o=wx | xargs -l ls -ld\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los directorios a cambiar permisos de W a OTHER (`INDIVIDUAL`).\n+-------------------------------------------------------------------------------------+\n\nls -ld $directory\n",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n\"VARIABLES:\n\n## $directory : es la variable del directorio raiz a cambiar permisos.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los directorios ('RECURSIVO'):\n+-------------------------------------------------------------------------------------+\n\nfind $directory -type d -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma ('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $directory",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $directory -type d -perm -o=wx | wc -l\nls -ld $directory\n\n+-------------------------------------------------------------------------------------+\n## De forma ('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld $directory",
            "SO": "Linux"
        },
        {
            "modulo": "Protecting Resources-OSRs/OSR /ETC Restrictions",
            "clave": "OSRETC",
            "descripcion": "OSR Invalid Owner or Group: directoryETC / directoryETC  Owner: ??  Group: ??  Permissions: -rwxr-xr-x  Settings for other must be r-x or more stringent. Must be owned by privileged Owner and Group",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a ficheros/directorios, sub-directorios, del directorio /ETC\n+-------------------------------------------------------------------------------------+\n\n// El desvio tarta de quitarle W a OTHER, ademas de comprobar que el owner y el grupo sean privilegiados (seccion 5.1) \n\n+-------------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner al que pertenece, cada fichero o directorio BASE.\n\n\" Ya sea de tipo '/C/F/S'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n// Por favor revisar la seccion de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner de la cuenta, si podemos modificar los permisos\n// Revisar ('PERMISSIONS'), antes de cualquier modificacion.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los ficheros/directorios a cambiar permisos de W en OTHER (`RECURSIVO`):\n+-------------------------------------------------------------------------------------+\n\n\" Buscar y mostrar el total de directorios:\n\necho -e \"directorios con permisos de W en OTHER osr \\e[32m$dirETC\\e[m : \";find $dirETC -type d -perm -o=w | wc -l\n\n\" Enlistar los directorios:\n\nfind $dirETC -type d -perm -o=w | xargs -l ls -ld\n\n\" Buscar y mostrar el total de los ficheros:\n\necho -e \"ficheros con permisos de W en OTHER osr \\e[32m$dirETC\\e[m: \";find $dirETC -type f -perm -o=w | wc -l\n\n\" Enlistar los ficheros:\n\nfind $dirETC -type f -perm -o=w | xargs -l ls -l\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los ficheros/directorios a cambiar permisos de W en OTHER (`INDIVIDUAL`):\n+-------------------------------------------------------------------------------------+\n\nls -la $fichero\n\nls -l $dirETC\n\nls -ld $dirETC\n\n+-------------------------------------------------------------------------------------+\n## Si la revision sobre permisos es correcto, el desvio sera por temas de privilegios.\n+-------------------------------------------------------------------------------------+\n\n// If owned by groups considered to be default groups for general users. (users). Active entries must be owned an id/group as identified in section 5.1 'The following system ids and group ids must own OSRs'  or id which has Security & System Administrative Authority.\n\n## Antes de cualquier modificacion, se debe consultar con el owner/group de la cuenta.\n\n+-------------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------------+\n\n\" Protecting Resources-mixed/Ensure sticky bit is set on all world-writable directories\n",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Se puede cambiar permisos W en OTHER de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n\" VARIABLES\n\n## $dirETC : es la variable del directorio BASE, para cambiar permisos en directorios / ficheros (RECURSIVO).\n\n## $fichero : es la variable del fichero a cambiar permiso (INDIVIDUAL).\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Asi cambiamos permisos de W a OTHER, en los directorios/ficheros ('RECURSIVO'):\n+-------------------------------------------------------------------------------------+\n\n\" DIRECTORIOS:\n\nfind $dirETC -type d -perm -o=w -exec chmod o-w {} \\;\n\n\" FICHEROS:\n\nfind $dirETC -type f -perm -o=w -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi cambiamos permisos de W a OTHER, de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $fichero\n\nchmod o-w dirETC\n\n+-------------------------------------------------------------------------------------+\n## Para cambiar cambiar a usuarios y grupo privilegiados, se debe saber a que grupo y usuario se debe cambiar.\n+-------------------------------------------------------------------------------------+\n\nchown $user:$group $dirETC",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## RECURSIVO\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $dirETC -type d -perm -o=w | wc -l\nfind $dirETC -type f -perm -o=w | wc -l\nls -ld $dirETC\n\n+-------------------------------------------------------------------------------------+\n## INDIVIDUAL\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld $dirETC\nls -la $fichero ",
            "SO": "Linux"
        },
        {
            "modulo": "System Settings/SELinux current mode requirement",
            "clave": "SELINUX",
            "descripcion": "SELinux should be enabled",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Poner en modo SELINUX=permissive\n+-------------------------------------------------------------------------------------+\n\ncat /etc/selinux/config\n\n+-------------------------------------------------------------------------------------+\n## En el excel poner \"2 - DOC\" temporal, Revisar RISK e IMPACT\n+-------------------------------------------------------------------------------------+\n\nGENERICO / SELINUX / CESCE",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/selinux/config /home/${user^^}/config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/selinux/config /home/${user,,}/config_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar SELINUX=disable a SELINUX=permissive\n+-------------------------------------------------------------------------------------+\n\nvi /etc/selinux/config",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\ncat /etc/selinux/config",
            "SO": "Linux"
        },
        {
            "modulo": "Encryption/Deny Ciphers",
            "clave": "CIPHERS DENY",
            "descripcion": "Cipher cast128-cbc should not be used\nCipher 3des-cbc should not be used",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Para corregir estos desvios\n## Se debe quitar los ciphers `cast128`, `3des`\n\n// Por lo normal estas definidos por defecto, y se deben definir en el fichero de configuracion.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep -i ciphers\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep -i ciphers",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`\n\n\n// AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/$user/sshd_config_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar y añadir Ciphers, si esta comentado (#), descomentar.\n## Debe estar debajo de: Ciphers and keying\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n+-------------------------------------------------------------------------------------+\n\nCiphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,chacha20-poly1305@openssh.com\n\n+-------------------------------------------------------------------------------------+\n## Si es RHEL 8, revisar:\n+-------------------------------------------------------------------------------------+\n\n// Encryption/Permitted Ciphers - RHEL 8\n",
            "refrescar": "+-------------------------------------------------------------------------------------+\n## LINUX\n+-------------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd",
            "evidencia": "clear\ndate\nhostname\n/usr/sbin/sshd -T|grep -i ciphers\ncat /etc/ssh/sshd_config | grep -i ciphers\nsystemctl status sshd",
            "SO": "Linux / Aix"
        },
        {
            "modulo": "Encryption/Permitted Ciphers - RHEL 7",
            "clave": "CIPHERS",
            "descripcion": "Cipher aes128-ctr is not available\nCipher aes192-ctr is not available\nCipher aes256-ctr is not available",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Ciphers, debe establecerse en:\n+-------------------------------------------------------------------------------------+\n\nciphers aes128-ctr,aes192-ctr,aes256-ctr,chacha20-poly1305@openssh.com,aes128-gcm@openssh.com,aes256-gcm@openssh.com\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep Ciphers\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep Ciphers",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar y añadir Ciphers, si esta comentado (#), descomentar.\n## Debe estar debajo de: Ciphers and keying\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n+-------------------------------------------------------------------------------------+\n\nCiphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,chacha20-poly1305@openssh.com\n",
            "refrescar": "systemctl stop sshd\nsystemctl start sshd",
            "evidencia": "clear\ndate\nhostname\n/usr/sbin/sshd -T|grep Ciphers\ncat /etc/ssh/sshd_config | grep Ciphers",
            "SO": "Linux"
        },
        {
            "modulo": "Encryption/Permitted Ciphers - RHEL 8",
            "clave": "CIPHERS",
            "descripcion": "Cipher aes128-ctr is not available\nCipher aes192-ctr is not available\nCipher aes256-ctr is not available",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Ciphers, debe establecerse en:\n+-------------------------------------------------------------------------------------+\n\nciphers aes128-ctr,aes192-ctr,aes256-ctr,chacha20-poly1305@openssh.com,aes128-gcm@openssh.com,aes256-gcm@openssh.com\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep Ciphers\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep Ciphers\n\n+-------------------------------------------------------------------------------------+\n## Ademas debe estar descomentada la siguiente entrada : CRYPTO_POLICY\n+-------------------------------------------------------------------------------------+\n\ncat /etc/sysconfig/sshd | grep CRYPTO_POLICY",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## --- RHEL 8, con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/sysconfig/sshd /home/${user^^}/sshd._`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## --- RHEL 8, con HOME en minúscula\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/sysconfig/sshd /home/${user,,}/sshd._`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar y añadir Ciphers, si esta comentado (#), descomentar.\n## Debe estar debajo de: Ciphers and keying\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n+-------------------------------------------------------------------------------------+\n\nCiphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com,chacha20-poly1305@openssh.com\n\n+-------------------------------------------------------------------------------------+\n## --- RHEL 8 : Editar Y Descomentar CRYPTO_POLICY=\n+-------------------------------------------------------------------------------------+\n\nvi /etc/sysconfig/sshd\n",
            "refrescar": "systemctl stop sshd\nsystemctl start sshd",
            "evidencia": "clear\ndate\nhostname\n/usr/sbin/sshd -T|grep Ciphers\ncat /etc/ssh/sshd_config | grep Ciphers\ncat /etc/sysconfig/sshd | grep CRYPTO_POLICY\nsystemctl status sshd",
            "SO": "Linux"
        },
        {
            "modulo": "Identify and Authenticate Users/Public Key Label",
            "clave": "AUTHORIZED_KEY / LABEL_KEY",
            "descripcion": "SSH authorized_keys file: $file_authorized; Some of the keys have no identifying label",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves publicas(\"authorized_keys\")\n## Deben tener un LABEL que indetifique a quien pertenece la clave publica\n## Antes de seguir, revisar -* AUTHORIZED_KEYS *-\n\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene un LABEL que es el GECOS, se define al final de cada clave `ssh-rsa` y que esta entre !! y !!\n## El fichero debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_authorized\ncat $file_authorized\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys es de root, no debe tener un fichero authorized_keys.\n## Pasamos directamente a renombrar el fichero authorized_keys para owner root.\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n\" --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Corregir el LABEL a las claves publicas, ya sean /C/F/S, /K/I/E/\n+-------------------------------------------------------------------------------------+\n\n\" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Renombrar los ficheros authorized_keys que tenga owner huerfanos\n+-------------------------------------------------------------------------------------+\n",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user^^}/authorized_key_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user,,}/authorized_key_`date +%d%m%y_%T`\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\ncp -p \"$file_authorized\" /home/$user/authorized_key_`date +%d%m%y_%T`\n",
            "editar": "\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros id_rsa, con owner root\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/authorized_keys /home/root/.ssh/authorized_keys.save\n\nmv /root/.ssh/authorized_keys /root/.ssh/authorized_keys.save\n\n\n\" --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## --- Añadir GECOS de forma AUTOMATICA\n// comando solo para linux\n+-------------------------------------------------------------------------------------+\n\nsed -i 's,$,'\" $gecos\"',' \"$file_authorized\"\n\n+-------------------------------------------------------------------------------------+\n## Editar y añadir el GECOS de forma MANUAL\n+-------------------------------------------------------------------------------------+\n\nvi $file_authorized\n\n## Añadir el GECOS de la cuenta al final de la clave 'ssh-rsa' o si existe, debe estar ENTRE !! y !!\n\n\" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si no existe la cuenta se puede RENOMBRAR el fichero\n+-------------------------------------------------------------------------------------+\n\nmv $file_authorized $file_authorized.save\n",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /home/root/.ssh/authorized_keys\nls -la /root/.ssh/authorized_keys\n\n+-------------------------------------------------------------------------------------+\n\" --> OPCION 2 & \" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la $file_authorized\ncat $file_authorized",
            "SO": "Linux"
        },
        {
            "modulo": "Logging/Log Verbosity Shared ID",
            "clave": "LOGLEVEL",
            "descripcion": "SSH Config File: /etc/ssh/sshd_config; Invalid setting (value: !default!) in parameter 'LogLevel': must be set to VERBOSE or higher.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## LogLevel, debe establecerse en:\n+-------------------------------------------------------------------------------------+\n\nLogLevel VERBOSE\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep LogLevel\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep LogLevel",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar y añadir LogLevel VERBOSE, si esta comentado (#), descomentar.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n+-------------------------------------------------------------------------------------+\n\nLogLevel VERBOSE\n",
            "refrescar": "systemctl stop sshd\nsystemctl start sshd",
            "evidencia": "clear\ndate\nhostname\n/usr/sbin/sshd -T|grep LogLevel\ncat /etc/ssh/sshd_config | grep LogLevel",
            "SO": "Linux"
        },
        {
            "modulo": "Password Requirements/NULL Passphrase",
            "clave": "ID_RSA NULL",
            "descripcion": "Private key $file_idrsa is not encrypted",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves privadas (\"id_rsa\")\n## Deben tener una frase de paso (passphrase) : \"Proc-Type: 4,ENCRYPTED\"\n\n// NOTA : Antes de seguir, revisar -* Private Key **-\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene una FRASE DE PASO\n## Ademas solo debe ser accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_idrsa\ncat $file_idrsa\n\n// NOTA: PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero id_rsa es de root, el usuario ROOT, no debe tener un fichero id_rsa.\n## Pasamos directamente a renombrar el fichero id_rsa para owner root.\n## ('SI HAY DUDAS, consultarlo con soporte')\n+-------------------------------------------------------------------------------------+\n\n\" --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Si el fichero id_rsa, pertenece a otro owner o grupo que no sea root.\n// Si es de TIPO /F/S (sistemas / aplicativo)\n## se debe contactar con el owner o grupo del fichero.\n## - Nos deben indicar, si se va a excepcionar nos deben especificar un RISK e IMPACT.\n\n## - Si se va a corregir, debemos renombrar el fichero.\n\n## Si es de TIPO /C/ (customer)\n## - Se debe excepcionar.\n// Por favor revisar la sección de RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n\" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si el fichero id_rsa, pertenece a otro owner o grupo que no sea root.\n## Si es de tipo /E/. /I/, /K/\n## - Si es una cuenta 'externa' y la cuenta no existe en el servidor, se puede renombrar.\n## - Si la cuenta existe, se debe notificar al owner de la cuenta.\n\n## Se le debe notificar que se va a renombrado el fichero y que si lo utiliza debe crear una nueva clave privada (\"id_rsa\"), con una frase de paso (passphrase). \n+-------------------------------------------------------------------------------------+",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_idrsa /home/${user^^}/id_rsa_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_idrsa /home/${user,,}/id_rsa_`date +%d%m%y_%T`\n\n// AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\ncp -p \"$file_idrsa\" /home/$user/id_rsa_`date +%d%m%y_%T`",
            "editar": "\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros id_rsa, con owner root\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/id_rsa /home/root/.ssh/id_rsa.save\n\nmv /root/.ssh/id_rsa /root/.ssh/id_rsa.save\n\n\n\" --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Para implementar una FRASE DE PASO, se recomienda que lo haga el owner de la cuenta, se le puede indicar como hacer con el siguiente comando, donde \"$file_idrsa\", es el fichero id_rsa a corregir.\n+-------------------------------------------------------------------------------------+\n\nssh-keygen -p -f $file_idrsa\n\n\" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros id_rsa, sin owner o account externas.\n+-------------------------------------------------------------------------------------+\n\nmv $file_idrsa $file_idrsa.save",
            "refrescar": null,
            "evidencia": "\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros id_rsa, con owner root.\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /home/root/.ssh/id_rsa\nls -la /root/.ssh/id_rsa\n\n\n\" --> OPCION 2, OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros id_rsa.\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\ncat $file_idrsa\n",
            "SO": "Linux / Aix"
        },
        {
            "modulo": "Password Requirements/Private Key Passphrase",
            "clave": "ID_RSA NOT PASSPHRASE",
            "descripcion": "SSH Private Key: $file_idrsa not passphrase protected",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves privadas (\"id_rsa\")\n## Deben tener una frase de paso (passphrase) : \"Proc-Type: 4,ENCRYPTED\"\n\n// NOTA : Antes de seguir, revisar -* Private Key **-\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene una FRASE DE PASO\n## Ademas solo debe ser accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_idrsa\ncat $file_idrsa\n\n// NOTA: PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero id_rsa es de root, el usuario ROOT, no debe tener un fichero id_rsa.\n## Pasamos directamente a renombrar el fichero id_rsa para owner root.\n## ('SI HAY DUDAS, consultarlo con soporte')\n+-------------------------------------------------------------------------------------+\n\n\" --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Si el fichero id_rsa, pertenece a otro owner o grupo que no sea root.\n// Si es de TIPO /F/S (sistemas / aplicativo)\n## se debe contactar con el owner o grupo del fichero.\n## - Nos deben indicar, si se va a excepcionar nos deben especificar un RISK e IMPACT.\n\n## - Si se va a corregir, debemos renombrar el fichero.\n\n## Si es de TIPO /C/ (customer)\n## - Se debe excepcionar.\n// Por favor revisar la sección de RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n\" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si el fichero id_rsa, pertenece a otro owner o grupo que no sea root.\n## Si es de tipo /E/. /I/, /K/\n## - Si es una cuenta 'externa' y la cuenta no existe en el servidor, se puede renombrar.\n## - Si la cuenta existe, se debe notificar al owner de la cuenta.\n\n## Se le debe notificar que se va a renombrado el fichero y que si lo utiliza debe crear una nueva clave privada (\"id_rsa\"), con una frase de paso (passphrase). \n+-------------------------------------------------------------------------------------+",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_idrsa /home/${user^^}/id_rsa_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_idrsa /home/${user,,}/id_rsa_`date +%d%m%y_%T`\n\n// AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\ncp -p \"$file_idrsa\" /home/$user/id_rsa_`date +%d%m%y_%T`",
            "editar": "\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros id_rsa, con owner root\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/id_rsa /home/root/.ssh/id_rsa.save\n\nmv /root/.ssh/id_rsa /root/.ssh/id_rsa.save\n\n\n\" --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Para implementar una FRASE DE PASO, se recomienda que lo haga el owner de la cuenta, se le puede indicar como hacer con el siguiente comando, donde \"$file_idrsa\", es el fichero id_rsa a corregir.\n+-------------------------------------------------------------------------------------+\n\nssh-keygen -p -f $file_idrsa\n\n\" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros id_rsa, sin owner o account externas.\n+-------------------------------------------------------------------------------------+\n\nmv $file_idrsa $file_idrsa.save",
            "refrescar": null,
            "evidencia": "\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros id_rsa, con owner root.\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /home/root/.ssh/id_rsa\nls -la /root/.ssh/id_rsa\n\n\n\" --> OPCION 2, OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para otros ficheros id_rsa.\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\ncat $file_idrsa\n",
            "SO": "Linux / Aix"
        },
        {
            "modulo": "AD.1.5.9.20.4 Network Settings",
            "clave": "",
            "descripcion": "Incorrect /etc/sysctl.conf",
            "comprobacion": "Los valores por defecto en `/sbin/sysctl`, deben estar establecidos.",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Para hacer el cambio:\n+-------------------------------------------------------------------------------------+\n\n/sbin/sysctl -w net.ipv4.conf.all.secure_redirects=0\n/sbin/sysctl -w net.ipv4.conf.default.secure_redirects=0\n/sbin/sysctl -w net.ipv4.conf.all.log_martians=1\n/sbin/sysctl -w net.ipv4.conf.default.log_martians=1\n/sbin/sysctl -w net.ipv4.conf.all.rp_filter=1\n/sbin/sysctl -w net.ipv4.conf.default.rp_filter=1\n/sbin/sysctl -w net.ipv6.conf.all.accept_ra=0\n/sbin/sysctl -w net.ipv6.conf.default.accept_ra=0\n/sbin/sysctl -w net.ipv6.conf.all.accept_redirects=0\n/sbin/sysctl -w net.ipv6.conf.default.accept_redirects=0\n/sbin/sysctl -w net.ipv4.ip_forward=0\n/sbin/sysctl -w net.ipv4.conf.default.accept_source_route=0\n/sbin/sysctl -w net.ipv4.conf.all.accept_source_route=0\n/sbin/sysctl -w net.ipv4.conf.all.accept_redirects=0",
            "refrescar": "sysctl -p",
            "evidencia": "clear\ndate\nhostname\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.accept_source_route\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.secure_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.secure_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.log_martians\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.log_martians\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.rp_filter\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.rp_filter\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.default.accept_source_route\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.all.accept_ra\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.default.accept_ra\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.all.accept_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv6.conf.default.accept_redirects\"\n/sbin/sysctl -a |grep -i \"net.ipv4.ip_forward\"\n/sbin/sysctl -a |grep -i \"net.ipv4.conf.all.accept_redirects\"",
            "SO": "Linux"
        },
        {
            "modulo": "AD.1.1.1.2 Password Requirements",
            "clave": "",
            "descripcion": "Account $account has invalid Password Max Age setting of 99999  should be set to Customer Required Setting: 90. More secure value can be set.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Para aplicar un correcto MAXAGE, hay que tener en cuenta el tipo de cuenta que es:\n## Ya sea tipo /C/F/S/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /C/, --> se pasa a excepcionar con RISK e IMPACT.\n\n## (Revisar el fichero de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/ --> se cambia a 90 dias, ejemplo de cuentas aplicable MAXAGE : root, emer, cyberark.\n\n## Dependiendo el cliente, alguna cuentas de TIPO F, se exepcionan con RISK e IMPACT, si fuera el caso se debe hablar con el owner de la cuenta, y que nos indique un RISK e IMPACT, o del contrario si se puede aplicar MAXAGE.\n\n## (Revisar \" * ACCOUNT * \", antes de cualquier cambio)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /S/ aplicativos, por lo normal no llevan una password asignada, si ese fuera el caso, se debe preguntar al owner de la cuenta, si se le puede aplicar expiracion de passwor o bien se pasa a excepcionar\n+-------------------------------------------------------------------------------------+",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar MAXAGE a 90\n+-------------------------------------------------------------------------------------+\n\nchage -M 90 $account",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\nchage -l $account\ncat /etc/passwd | grep -i $account",
            "SO": "Linux"
        },
        {
            "modulo": "AD.1.1.2.0 Password Requirements",
            "clave": "MINLEN DEBIAN",
            "descripcion": "Incorrect System Default minimum password length or password complexity rules. Minimum password length should be set to 14 or more secure, in file \n/etc/pam.d/common-password\nIt should be set through pam_cracklib.so or pam_pwquality.so. For more information about password length or password complexity rules see matrix coverage document.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al 'minlen' en Linux Debian.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Los ficheros del PAM para DEBIAN, deben tener en el modulo 'password    required      pam_cracklib.so', el parámetro 'minlen=14'\n+-------------------------------------------------------------------------------------+\n\ngrep -i minlen /etc/pam.d/common-password\n\n",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/common-password /home/${user^^}/common-password_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/common-password /home/${user,,}/common-password_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n##--- DEBIAN ('common-password')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'password    required      pam_cracklib.so', el parámetro 'minlen=14'\n## ('se aconseja remplazar toda la linea, del modulo 'password    required      pam_cracklib.so', por encima de un modulo ' password    sufficient pam_unix.so')\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/common-password\n\npassword        required        pam_cracklib.so minlen=14 dcredit=-1 ucredit=0 lcredit=-1 ocredit=0 reject_username\n\n",
            "refrescar": null,
            "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/common-password | egrep \"minlen\"",
            "SO": "Debian"
        },
        {
            "modulo": "AD.1.1.6.1 Password Requirements",
            "clave": "PAM_TALLY DEBIAN",
            "descripcion": "Non of the Login Retrie options was found in file:\n/etc/pam.d/common-auth\n/etc/pam.d/common-account",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al 'PAM_TALLY' en Linux Debian.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Los ficheros del PAM para DEBIAN, deben tener el modulo\n\n## `auth        required        pam_tally.so`, los parámetros `deny=5 onerr=fail per_user no_lock_time`\n\n## `account        required        pam_tally.so`\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/common-auth | grep pam_tally\ncat /etc/pam.d/common-account| grep pam_tally\n\n",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/common-account /home/${user^^}/common-account_`date +%d%m%y_%T`\ncp -p /etc/pam.d/common-auth /home/${user^^}/common-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/common-auth /home/${user,,}/common-auth_`date +%d%m%y_%T`\ncp -p /etc/pam.d/common-account /home/${user,,}/common-account_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n##--- DEBIAN ('common-auth')\n+-------------------------------------------------------------------------------------+\n\n## Añadir en el modulo 'auth        required        pam_tally2.so', los parámetro 'deny=5 onerr=fail per_user no_lock_time'\n## ('se aconseja remplazar toda la linea, del modulo).\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/common-auth\n\nauth        required        pam_tally2.so        deny=5 onerr=fail per_user no_lock_time\n\n+-------------------------------------------------------------------------------------+\n##--- DEBIAN ('common-account')\n+-------------------------------------------------------------------------------------+\n\n## Añadir en el modulo 'account        required        pam_tally2.so'\n## ('se aconseja remplazar toda la linea, del modulo).\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/common-account\n\naccount        required        pam_tally2.so\n\n",
            "refrescar": null,
            "evidencia": "clear\ndate;hostname\ncat /etc/pam.d/common-auth | grep pam_tally\ncat /etc/pam.d/common-account| grep pam_tally",
            "SO": "Debian"
        },
        {
            "modulo": "AD.1.1.3.2 Password Requirements",
            "clave": "",
            "descripcion": "Account $account has invalid Password Min Age setting of null  should be set to Customer Required Setting: 1. Account Type: Customer",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Todas las cuentas, ya sean /C/F/S, deben tener el MINAGE a 1.\n+-------------------------------------------------------------------------------------+",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar MIANGE a 1\n+-------------------------------------------------------------------------------------+\n\nchage -m 1 $account",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\nchage -l $account\ncat /etc/passwd | grep -i $account",
            "SO": "Linux"
        },
        {
            "modulo": "Business Use Notice/Business Use Notice Required",
            "clave": "BUN",
            "descripcion": "Missing or Incorrect Business Use Notice. It should be set in /etc/motd",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n##Debe tener el BUN actual.\n+-------------------------------------------------------------------------------------+",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n##añadir / remplazar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/motd\n\nKyndryl's internal systems must only be used for conducting Kyndryl's business or for purposes authorized by Kyndryl management.. Use is subject to audit at any time by Kyndryl management.",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\ncat /etc/motd",
            "SO": "Linux"
        },
        {
            "modulo": "AD.2.0.1.0 Business Use Notice",
            "clave": "BUN",
            "descripcion": "Missing or Incorrect Business Use Notice. It should be set in /etc/motd",
            "comprobacion": "##Debe tener el BUN actual.",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n##añadir / remplazar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/motd\n\n|                                                                             |\n|Kyndryl's internal systems must only be used for conducting Kyndryl's        |\n|business or for purposes authorized by Kyndryl management.. Use is subject to|\n|audit at any time by Kyndryl management.                                     |  \n+-----------------------------------------------------------------------------+",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\ncat /etc/motd",
            "SO": "Linux"
        },
        {
            "modulo": "AD.1.8.4.2.3 Protecting Resources - OSRs",
            "clave": "/etc/shadow",
            "descripcion": "Ensure permissions on /etc/shadow- are configured 000 permissive",
            "comprobacion": null,
            "copia": null,
            "editar": null,
            "refrescar": null,
            "evidencia": null,
            "SO": "Debian"
        },
        {
            "modulo": "AD.1.2.6 Logging",
            "clave": "ROTACION",
            "descripcion": "Retain Log files = 180 DIAS (26 semanas)",
            "comprobacion": null,
            "copia": null,
            "editar": null,
            "refrescar": null,
            "evidencia": null,
            "SO": "Debian"
        },
        {
            "modulo": "Business Use Notice/PrintMotd Restriction",
            "clave": "SSHD_CONFIG / PRINTMOTD",
            "descripcion": "SSH Config File: /etc/ssh/sshd_config; Invalid setting (value: 0) in parameter 'PrintMotd': must be set to 'yes'.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## PrintMotd, debe establecerse en:\n+-------------------------------------------------------------------------------------+\n\nPrintMotd yes\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T | grep -i PrintMotd\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep PrintMotd",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar y añadir PrintMotd yes, si esta comentado (#), descomentar.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n+-------------------------------------------------------------------------------------+\n\nPrintMotd yes\n",
            "refrescar": "+-------------------------------------------------------------------------------------+\n ## LINUX\n+-------------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------------+\n## UNIX\n+-------------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd\n",
            "evidencia": "clear\ndate\nhostname\n/usr/sbin/sshd -T | grep -i PrintMotd\ncat /etc/ssh/sshd_config | grep PrintMotd",
            "SO": "Linux / Aix"
        },
        {
            "modulo": "Identify and Authenticate Users/PermitRootLogin Restriction",
            "clave": "SSHD_CONFIG / PERMITROOTLOGIN",
            "descripcion": "SSH Config File: /etc/ssh/sshd_config; Invalid setting (value:yes) in parameter 'PermitRootLogin': must be set to 'no'. May be set to YES, FORCED-COMMANDS-ONLY,or WITHOUT-PASSWORD only if mechanisms are in place to determine the identity of the individual accessing the system.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Por lo normal general, si la issue es `Initial - Deviation Management`, se recomienda el VALOR a NO, puede estar a YES por temas de instalacion del sistema (se puede confirmar con SOPORTE).\n## Sea el caso de instalaciones, se puede esperar a que terminen y pongan el parametro a NO.\n\n## Ademas se pueden revisar los siguientes puntos:\n+-------------------------------------------------------------------------------------+\n\n## 1 - Que no estén los valores correctos `por defecto`.\n\n## 2 - Que `no este excepcionado` revisar (SERVICE).\n\n## 3 - Que no sea un Cluster de GPFS.\n\n// RECOMENDACION : 'Si hay dudas, hablar con SOPORTE'.\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto, valor por defecto correcto es : No\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T | grep -i PermitRootLogin\n\n+-------------------------------------------------------------------------------------+\n## Comprobar si no es `cluster` que tiene montado un GPFS.\n+-------------------------------------------------------------------------------------+\n\n/usr/es/sbin/cluster/utilities/clRGinfo\n/usr/lpp/mmfs/bin/mmgetstate\nps -aux | grep -i mmfs\n",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config\n\n+-------------------------------------------------------------------------------------+\n## Añadir el valor `no`, al parámetro PermitRootLogin.\n\n## Debe quedar algo asi:\n+-------------------------------------------------------------------------------------+\n\nPermitRootLogin no\n+-------------------------------------------------------------------------------------+\n",
            "refrescar": "+-------------------------------------------------------------------------------------+\n## Linux\n+-------------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd",
            "evidencia": "clear\ndate\nhostname\n/usr/sbin/sshd -T | grep -i PermitRootLogin\ncat /etc/ssh/sshd_config | grep PermitRootLogin",
            "SO": "Linux / Aix"
        },
        {
            "modulo": "System Settings/MaxAuthTries Restriction",
            "clave": "SSHD_CONFIG / MAXAUTHTRIES",
            "descripcion": "SSH Config File: /etc/ssh/sshd_config; Invalid setting (value: -1) in parameter 'MaxAuthTries': must be set to 5 or less.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## MaxAuthTries, debe establecerse en:\n+-------------------------------------------------------------------------------------+\n\nMaxAuthTries 5\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep MaxAuthTries\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep MaxAuthTries",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar y añadir MaxAuthTries 5, si esta comentado (#), descomentar.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n+-------------------------------------------------------------------------------------+\n\nMaxAuthTries 5\n",
            "refrescar": "systemctl stop sshd\nsystemctl start sshd",
            "evidencia": "clear\ndate\nhostname\n/usr/sbin/sshd -T|grep MaxAuthTries\ncat /etc/ssh/sshd_config | grep MaxAuthTries",
            "SO": "Linux"
        },
        {
            "modulo": "Business Use Notice/Business Use Notice exists in Gnome",
            "clave": "GNOME BUN",
            "descripcion": "/etc/dconf/db/gdm.d/* effective file must exist and have appropriate content. For more information about content of files see matrix coverage document.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Añadir el BUN para la interfaz grafica de GNOME\n+-------------------------------------------------------------------------------------+\n\ncat /etc/dconf/db/gdm.d/01-banner-message",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS - LINUX - \n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/dconf/profile/gdm /home/${user^^}/gdm_`date +%d%m%y_%T`\ncp -p /etc/dconf/db/gdm.d/01-banner-message /home/${user^^}/banner_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas - LINUX -\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/dconf/profile/gdm /home/${user,,}/gdm_`date +%d%m%y_%T`\ncp -p /etc/dconf/db/gdm.d/01-banner-message /home/${user,,}/banner_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Create the gdm profile which contains the following lines:\n+-------------------------------------------------------------------------------------+\n\ntouch /etc/dconf/profile/gdm\nchmod 0644 /etc/dconf/profile/gdm\n\n+-------------------------------------------------------------------------------------+\n## Editar y añadir las siguientes lineas:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/dconf/profile/gdm\n\nuser-db:user\nsystem-db:gdm\nfile-db:/usr/share/gdm/greeter-dconf-defaults\n\n+-------------------------------------------------------------------------------------+\n## Create a gdm keyfile for machine-wide settings in /etc/dconf/db/gdm.d/01-banner-message:\n+-------------------------------------------------------------------------------------+\n\ntouch /etc/dconf/db/gdm.d/01-banner-message\nchmod 0644 /etc/dconf/db/gdm.d/01-banner-message\n\n+-------------------------------------------------------------------------------------+\n## Editar y añadir las siguientes lineas:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/dconf/db/gdm.d/01-banner-message\n\n[org/gnome/login-screen]\nbanner-message-enable=true\nbanner-message-text='Kyndryl internal systems must only be used for conducting Kyndryl business or for purposes authorized by Kyndryl management. Use is subject to audit at any time by Kyndryl management.'",
            "refrescar": "dconf update",
            "evidencia": "clear\ndate\nhostname\ncat /etc/dconf/profile/gdm\ncat /etc/dconf/db/gdm.d/01-banner-message",
            "SO": "Linux"
        },
        {
            "modulo": "Password Requirements/User primary GID requirement",
            "clave": "GID NULL",
            "descripcion": "User: $account has primary GID: $gid which is missing in /etc/group file.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## El grupo que hace referencia la cuenta debe existir.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/group | grep $gid",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Se le debe añadir un grupo a la cuenta, que nos marca el desvio\n+-------------------------------------------------------------------------------------+\n\ngpasswd -a nombreUsuario nombreGrupo\n\n+-------------------------------------------------------------------------------------+\n## Si el grupo que nos indican no existe se debe crear\n## EJEMPLO\n+-------------------------------------------------------------------------------------+\n\ngroupadd -g 600 ibmadmin",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\ncat /etc/group | grep $gid",
            "SO": "Linux"
        },
        {
            "modulo": "Protecting Resources-User Resources/Login.defs umask restriction",
            "clave": "UMASK DEFAULT",
            "descripcion": "File /etc/login.defs include invalid umask setting 22. Should be set 077. More stringent value can be set.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## El valor de umask por defecto en /etc/login.defs, debe ser 077\n+-------------------------------------------------------------------------------------+\n\ncat /etc/login.defs | grep -i 'umask'",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/login.defs /home/${user^^}/login.defs_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/login.defs /home/${user,,}/login.defs_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar / Añadir UMASK 077\n+-------------------------------------------------------------------------------------+\n\nvi /etc/login.defs",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\ncat /etc/login.defs | grep -i umask",
            "SO": "Linux"
        }
    ]
}
{
    "ASISA": [
        {
            "modulo": "Protecting Resources-OSRs/Log File Restrictions",
            "clave": "WTMP",
            "descripcion": "Invalid Permissions or Ownership for log file: /var/log/wtmp;   -rw-rw-r--.;  owner:  root;   group:  utmp. For more information see rule description.",
            "comprobacion": "## Se le debe quitar W al grupo.\n\n+-------------------------------------------------------------------------------------+\n## Comprobar que en logrotate.conf, tenga permisosa 0644\n+-------------------------------------------------------------------------------------+\n\ncat /etc/logrotate.conf | grep -w wtmp -A4\n\ncat /etc/logrotate.d/* | grep -w wtmp -A4",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user^^}/logrotate.conf_`date +%d%m%y`\ncp -p /etc/logrotate.d/wtmp /home/${user^^}/logrotate_wtmp_`date +%d%m%y`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/logrotate.conf /home/${user,,}/logrotate.conf_`date +%d%m%y`\ncp -p /etc/logrotate.d/wtmp /home/${user,,}/logrotate_wtmp_`date +%d%m%y`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Quitar permisos al fichero\n+-------------------------------------------------------------------------------------+\n\nchmod g-w /var/log/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 7:\n+-------------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /lib/tmpfiles.d/var.conf\n\n## Debe quedar la linea asi:\n\nf /var/log/wtmp 0644 root utmp -\n\n+-------------------------------------------------------------------------------------+\n## Dejar esta linea para REHL 6\n+-------------------------------------------------------------------------------------+\n\n## Editar:\n\nvi /etc/rc.sysinit\n\n## Dejar la linea asi:\n\nchmod 0644 /var/run/utmp /var/log/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Corregir los permisos en logrotate.conf O en /etc/logrotate.d/wtmp, en create de wtmp\n+-------------------------------------------------------------------------------------+\n\nvi /etc/logrotate.conf\n\nvi /etc/logrotate.d/wtmp\n\n+-------------------------------------------------------------------------------------+\n## Modificar los permisos de 0664, a 0644, al fichero /var/log/wtmp\n+-------------------------------------------------------------------------------------+",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## RHEL 6\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /var/log/wtmp\ncat cat /etc/rc.sysinit | grep -w 'wtmp'\ncat /etc/logrotate.conf | grep -w wtmp -A4\n\n+-------------------------------------------------------------------------------------+\n## RHEL 7\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /var/log/wtmp\ncat /lib/tmpfiles.d/var.conf | grep -w wtmp\ncat /etc/logrotate.conf | grep -w wtmp -A4\n",
            "SO": "Linux"
        },
        {
            "modulo": "Business Use Notice/Business Use Notice Required",
            "clave": "BUN",
            "descripcion": "Missing or Incorrect Business Use Notice. It should be set in /etc/motd",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n##Debe tener el BUN actual.\n+-------------------------------------------------------------------------------------+",
            "copia": null,
            "editar": "vi /etc/motd\n\n+-------------------------------------------------------------------------------------+\n##añadir / remplazar :\n+-------------------------------------------------------------------------------------+\n\n*************************************************************************\n*                                                                       *\n*                                                                       *\n* Asisa systems must only be used for conducting Asisa business or      * \n* for purposes authorized by Asisa management.                          *\n*                                                                       *\n*                                                                       *\n*************************************************************************",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\ncat /etc/motd",
            "SO": "Linux / Aix"
        },
        {
            "modulo": "Logging/Synchronized system clocks",
            "clave": " XNTPD",
            "descripcion": "xntpd must be running",
            "comprobacion": null,
            "copia": null,
            "editar": null,
            "refrescar": null,
            "evidencia": null,
            "SO": "Aix"
        },
        {
            "modulo": "Password Requirements/Password histexpire - System Default",
            "clave": "HISTEXPIRE",
            "descripcion": "Invalid system default histexpire set to 0, must be not less than 105",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## El parametro histexpire, debe ser 105, por defecto y por usuario.\n## Una vez cambiado a default, se corrigen para las demas cuentas, puede quedar root o alguna cuenta sin cambiar, por lo que se puede cambiar manual.\n+-------------------------------------------------------------------------------------+\n\nlssec -f /etc/security/user -s default -a histexpire",
            "copia": null,
            "editar": "chsec -f /etc/security/user -s default -a histexpire=105\nchsec -f /etc/security/user -s root -a histexpire=105",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\nlssec -f /etc/security/user -s default -a histexpire\nlssec -f /etc/security/user -s root -a histexpire",
            "SO": "Aix"
        },
        {
            "modulo": "Password Requirements/Password MAX Age",
            "clave": "MAXAGE",
            "descripcion": "Account $account has invalid Password Max Age setting = 0, must be Customer Required Setting: 13; Account Type: IBM (Strictest Setting Validated). Direct login: 1      must be set to \"false\". Remote login:  1      must be set to \"false\". Id must exist in file. Value of login shell:  /usr/bin/ksh must be \"/bin/false\"",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe tener un MAXAGE de 13 semanas, dependiendo el tipo de cuenta.\n## Ya sea /C/F/S/.\n\n## Si es /C/ (customer), siempre 2-DOC, sea el cliente que sea.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /F/, se cambia a 13 dias, ejemplo usuario, `root`, `emer`, `cyberark` porque son usuarios que estan cargados en cyberark, aunque aveces cleintes como AFB, LBK, piden excepcionar los usuarios.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /S/, no es comun que salgan como desvio de maxage porque son aplicativos y no usan password, si asi fuera se debe preguntar siempre al owneer, si se le puede aplicar expiracion de password, usuarios como `oracle`, `tivoli`, son usuarios con password, que suelen estar excepcionados o almenos preguntar si se pueden aplicar expiracion de password.\n\n## root, emer y cyberar siempre se le puede aplicar maxage.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Antes de corregir, mirar *- ACCOUNT -*\n+-------------------------------------------------------------------------------------+\n\nlsuser $account",
            "copia": null,
            "editar": "chuser maxage=13 $account",
            "refrescar": null,
            "evidencia": "clear\ndate\nuname -a\nlsuser -a maxage $account",
            "SO": "Aix"
        },
        {
            "modulo": "Password Requirements/Password MIN Length - System Default",
            "clave": "MINLENGTH",
            "descripcion": "Invalid Password Min Length setting of 8, should be not less than 15\nInvalid system ACCOUNTS Min Length",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## El parametro minlen, debe ser 15, por defecto y por usuario.\n## Una vez cambiado a default, se corrigen para las demas cuentas, puede quedar root o alguna cuenta sin cambiar, por lo que se puede cambiar manual.\n+-------------------------------------------------------------------------------------+\n\nlssec -f /etc/security/user -s default -a minlen",
            "copia": null,
            "editar": "chsec -f /etc/security/user -s default -a minlen=15\nchsec -f /etc/security/user -s root -a minlen=15",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\nlssec -f /etc/security/user -s default -a minlen\nlssec -f /etc/security/user -s root -a minlen",
            "SO": "Aix"
        },
        {
            "modulo": "Password Requirements/Password mindiff - System Default",
            "clave": "MINDIFF",
            "descripcion": "Invalid system default mindiff set to 1, must be not less than 4",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## El parametro mindiff, debe ser 4, por defecto y por usuario.\n## Una vez cambiado a default, se corrigen para las demas cuentas, puede quedar root o alguna cuenta sin cambiar, por lo que se puede cambiar manual.\n+-------------------------------------------------------------------------------------+\n\nlssec -f /etc/security/user -s default -a mindiff",
            "copia": null,
            "editar": "chsec -f /etc/security/user -s default -a mindiff=4\nchsec -f /etc/security/user -s root -a mindiff=4",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\nlssec -f /etc/security/user -s default -a mindiff\nlssec -f /etc/security/user -s root -a mindiff",
            "SO": "Aix"
        },
        {
            "modulo": "Password Requirements/Requirement for pwd_algorithm",
            "clave": "PWD_ALGORITHM",
            "descripcion": "Incorrect or missing value of \"pwd_algorithm\" in /etc/security/login.cfg. It Must be set to ssha512",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Cambiar el algoritmo a ssha512 en /etc/security/login.cfg\n+-------------------------------------------------------------------------------------+\n\nlssec -f /etc/security/login.cfg -s usw -a pwd_algorithm",
            "copia": null,
            "editar": "chsec -f /etc/security/login.cfg -s usw -a pwd_algorithm=ssha512",
            "refrescar": null,
            "evidencia": "clear\ndate\nuname -a\nlssec -f /etc/security/login.cfg -s usw -a pwd_algorithm",
            "SO": "Aix"
        },
        {
            "modulo": "Protecting Resources-OSRs/CRON Command Group Permissions",
            "clave": "OSRCRON",
            "descripcion": "Invalid permissions for CRON command: $fileCRON, Permissions: -rwxrwxr-x, Group: $grupo, Permissions for GROUP must be set to r-x or more stringent if owned by group not considered as privileged (see Allowed Groups policy parameter).",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## El desvio trata de quitarle W a GROUP, a los ficheros (COMANDOS), que se ejecutan en CRON\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n## por favor revisar la seccion de RISK e IMPACT\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero y directorios a cambiar permisos. \n+-------------------------------------------------------------------------------------+\n\n## FICHERO (COMANDOS) DEL CRON:\n---\nls -l $fileCRON",
            "copia": null,
            "editar": "chmod g-w $fileCRON",
            "refrescar": null,
            "evidencia": "clear\ndate\nuname -a\nls -l $fileCRON",
            "SO": "Aix"
        },
        {
            "modulo": "Protecting Resources-OSRs/CRON Command WW Permissions",
            "clave": "OSRsCRON",
            "descripcion": "Invalid permissions or ownership for CRON command: $fileCRON, Permissions: -rwxrwxr-x, Group: $grupo, Owner: $usuario, Permissions for OTHER must be set to r-x or more stringent. Must have allowed owner (see policy parameters: Allowed Owners + Allowed Groups members).",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## El desvio trata de quitarle permisos w a OTHER o cambiar el owner / group, a los ficheros, de los comandos que se ejecutan en CRON, si es necesario cambiar owner o grupo.\n## (consulte los parámetros de política: Propietarios permitidos + Miembros de grupos permitidos).\n\n## Relacionado con :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/CRON Command Group Permissions\n\n+-------------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n## por favor revisar la seccion de RISK e IMPACT\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero y directorios a cambiar permisos. \n+-------------------------------------------------------------------------------------+\n\n## FICHERO DEL CRON:\n---\nls -l $fileCRON\n\n## DIRECTORIOS DEL CRON:\n---\nls -ld $directory",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## FILE\n+-------------------------------------------------------------------------------------+\nchmod o-w $fileCRON\n\n+-------------------------------------------------------------------------------------+\n## DIRECTORIOS\n+-------------------------------------------------------------------------------------+\nchmod o-w $directory\n\n+-------------------------------------------------------------------------------------+\n## Cambiar owner y grupo si es necesario:\n+-------------------------------------------------------------------------------------+\nchown $usuario:$grupo $fileCRON\n\nor \n\nchown $usuario:$grupo $directory",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## FILE\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nuname -a\nls -l $fileCRON\n\n+-------------------------------------------------------------------------------------+\n## DIRECTORIOS\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nuname -a\nls -ld $directory",
            "SO": "Aix"
        },
        {
            "modulo": "Protecting Resources-OSRs/OSR /var/adm/cron files restrictions",
            "clave": "/VAR/ADM/CRON",
            "descripcion": "/var/adm/cron/XXXXX, Owner: root, Group: sys, Permissions: -rw-r--r---, must be --- for other. Should be owned by privileged owner and group.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Ficheros que cuelgan en /var/adm/cron/, deben ser propiedad de root o bin y no debe tener permisos en OTHER\n+-------------------------------------------------------------------------------------+\n\nls -l /var/adm/cron/",
            "copia": null,
            "editar": "chmod -R o-r,o-w,o-x /var/adm/cron/",
            "refrescar": null,
            "evidencia": "clear\ndate\nuname -a\nls -l /var/adm/cron/",
            "SO": "Aix"
        },
        {
            "modulo": "Protecting Resources-OSRs/OSR /var/ct/RMstart.log restrictions",
            "clave": "/VAR/CT/RMSTART.LOG",
            "descripcion": "/var/ct/RMstart.log, Owner: root, Group: system, Permissions: 0644, must be 640 or more restrictive. Should be owned by privileged owner and group.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Fichero /var/ct/RMstart.log, no debe tener permisos en OTHER\n+-------------------------------------------------------------------------------------+\n\nls -l /var/ct/RMstart.log",
            "copia": null,
            "editar": "chmod 0640 /var/ct/RMstart.log",
            "refrescar": null,
            "evidencia": "clear\ndate\nuname -a\nls -la /var/ct/RMstart.log",
            "SO": "Aix"
        },
        {
            "modulo": "Protecting Resources-OSRs/OSR /var/spool/cron/crontabs files restrictions",
            "clave": "/VAR/SPOOL/CRON/CRONTABS/",
            "descripcion": "/var/spool/cron/crontabs/XXXXX, Owner: $usuario, Group: $grupo, Permissions: -rw-r--r---, settings for other must be --- (0).",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Ficheros que cuelgan en /var/spool/cron/crontabs/, deben ser propiedad de root, adm, sys etc etc y no debe tener permisos en OTHER\n+-------------------------------------------------------------------------------------+\n\nls -l /var/spool/cron/crontabs/",
            "copia": null,
            "editar": "chmod o-r,o-w,o-x /var/spool/cron/crontabs/*",
            "refrescar": null,
            "evidencia": "clear\ndate\nuname -a\nls -l /var/spool/cron/crontabs/",
            "SO": "Aix"
        },
        {
            "modulo": "Network Settings//etc/inetd.conf - ntalk",
            "clave": "ENTRY NTALK",
            "descripcion": "ntalk entry must be removed or disabled in /etc/inetd.conf",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe no existir la entrada ntalk en /etc/inetd.conf, o estar comentada.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/inetd.conf | grep -i ntalk\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionada con :\n+-------------------------------------------------------------------------------------+\nNetwork Settings//etc/inetd.conf - time\nNetwork Settings//etc/inetd.conf - exec\nNetwork Settings//etc/inetd.conf - kshell",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## Aix\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/inetd.conf /home/${user}/inetd.conf_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar y comentar la linea.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/inetd.conf\n\n+-------------------------------------------------------------------------------------+\n## Editar y comentar las relaciones:\n+-------------------------------------------------------------------------------------+\n\nexec entry must be removed or disabled in /etc/inetd.conf\ntime entry must be removed or disabled in /etc/inetd.conf\nkshell entry must be removed or disabled in /etc/inetd.conf",
            "refrescar": "refresh -s inetd",
            "evidencia": "clear\ndate\nhostname\ncat /etc/inetd.conf | grep -i ntalk\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de las relaciones:\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\ncat /etc/inetd.conf | grep -i exec\ncat /etc/inetd.conf | grep -i ntalk\ncat /etc/inetd.conf | grep -i time\ncat /etc/inetd.conf | grep -i kshell",
            "SO": "Aix"
        },
        {
            "modulo": "Network Settings//etc/inetd.conf - time",
            "clave": "ENTRY TIME",
            "descripcion": "time entry must be removed or disabled in /etc/inetd.conf",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe no existir la entrada time en /etc/inetd.conf, o estar comentada.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/inetd.conf | grep -i time\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionada con :\n+-------------------------------------------------------------------------------------+\nNetwork Settings//etc/inetd.conf - ntalk\nNetwork Settings//etc/inetd.conf - exec\nNetwork Settings//etc/inetd.conf - kshell",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## Aix\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/inetd.conf /home/${user}/inetd.conf_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar y comentar la linea.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/inetd.conf\n\n+-------------------------------------------------------------------------------------+\n## Editar y comentar las relaciones:\n+-------------------------------------------------------------------------------------+\n\nexec entry must be removed or disabled in /etc/inetd.conf\nntalk entry must be removed or disabled in /etc/inetd.conf\nkshell entry must be removed or disabled in /etc/inetd.conf",
            "refrescar": "refresh -s inetd",
            "evidencia": "clear\ndate\nhostname\ncat /etc/inetd.conf | grep -i time\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de las relaciones:\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\ncat /etc/inetd.conf | grep -i exec\ncat /etc/inetd.conf | grep -i time\ncat /etc/inetd.conf | grep -i ntalk\ncat /etc/inetd.conf | grep -i kshell",
            "SO": "Aix"
        },
        {
            "modulo": "Network Settings//etc/inetd.conf - exec",
            "clave": "ENTRY EXEC",
            "descripcion": "exec entry must be removed or disabled in /etc/inetd.conf",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe no existir la entrada exec en /etc/inetd.conf, o estar comentada.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/inetd.conf | grep -i exec\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionada con :\n+-------------------------------------------------------------------------------------+\nNetwork Settings//etc/inetd.conf - ntalk\nNetwork Settings//etc/inetd.conf - time\nNetwork Settings//etc/inetd.conf - kshell",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## Aix\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/inetd.conf /home/${user}/inetd.conf_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar y comentar la linea.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/inetd.conf\n\n+-------------------------------------------------------------------------------------+\n## Editar y comentar las relaciones:\n+-------------------------------------------------------------------------------------+\n\ntime entry must be removed or disabled in /etc/inetd.conf\nntalk entry must be removed or disabled in /etc/inetd.conf\nkshell entry must be removed or disabled in /etc/inetd.conf",
            "refrescar": "refresh -s inetd",
            "evidencia": "clear\ndate\nhostname\ncat /etc/inetd.conf | grep -i exec\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de las relaciones:\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\ncat /etc/inetd.conf | grep -i exec\ncat /etc/inetd.conf | grep -i time\ncat /etc/inetd.conf | grep -i ntalk\ncat /etc/inetd.conf | grep -i kshell",
            "SO": "Aix"
        },
        {
            "modulo": "Network Settings//etc/inetd.conf - kshell",
            "clave": "ENTRY KSHELL",
            "descripcion": "kshell entry must be removed or disabled in /etc/inetd.conf",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe no existir la entrada kshell en /etc/inetd.conf, o estar comentada.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/inetd.conf | grep -i kshell\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionada con :\n+-------------------------------------------------------------------------------------+\nNetwork Settings//etc/inetd.conf - ntalk\nNetwork Settings//etc/inetd.conf - time\nNetwork Settings//etc/inetd.conf - exec",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## Aix\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/inetd.conf /home/${user}/inetd.conf_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar y comentar la linea.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/inetd.conf\n\n+-------------------------------------------------------------------------------------+\n## Editar y comentar las relaciones:\n+-------------------------------------------------------------------------------------+\n\ntime entry must be removed or disabled in /etc/inetd.conf\nntalk entry must be removed or disabled in /etc/inetd.conf\nexec entry must be removed or disabled in /etc/inetd.conf",
            "refrescar": "refresh -s inetd",
            "evidencia": "clear\ndate\nhostname\ncat /etc/inetd.conf | grep -i kshell\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de las relaciones:\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\ncat /etc/inetd.conf | grep -i kshell\ncat /etc/inetd.conf | grep -i time\ncat /etc/inetd.conf | grep -i ntalk\ncat /etc/inetd.conf | grep -i exec",
            "SO": "Aix"
        },
        {
            "modulo": "Network Settings//etc/inittab - piobe",
            "clave": "PIOBE",
            "descripcion": "File /etc/inittab have piobe service.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Son servicios de impresion, debe salir la linea comentada o vacio\n+-------------------------------------------------------------------------------------+\n\nlsitab piobe\n\n+-------------------------------------------------------------------------------------+\n## Relacionado con los modulos:\n+-------------------------------------------------------------------------------------+\n\nNetwork Settings/\\etc\\inittab - qdaemon\nlsitab qdaemon\n\nNetwork Settings/\\etc\\inittab - writesrv\nlsitab writesrv\n\n+-------------------------------------------------------------------------------------+\n## Ademas debemos comprobar si no hay colas de impresion\n+-------------------------------------------------------------------------------------+\nenq\n\n// enq: (FATAL ERROR): 0781-372 There are no queues defined in the /etc/qconfig file. //\n\n+-------------------------------------------------------------------------------------+\n## Si hacemos un cat /etc/qconfig y no tiene nada, o no hay colas de impresión definidas y se podría parar.\n## Si salen colas de IMPRESION PREGUNTAR ANTES DE PARAR.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/qconfig | grep -v \"^*\"\n\n// debe salir vacio, o si el resultado del cat, salen por delante *, son solo comentarios.\"CUALQUIER DUDA PREGUNTAR\" //",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## Aix\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/inetd.conf /home/${user}/inetd.conf_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Eliminar la entrada:\n+-------------------------------------------------------------------------------------+\n\nrmitab piobe\n\n+-------------------------------------------------------------------------------------+\n## Eliminar las entradas relacionadas:\n+-------------------------------------------------------------------------------------+\n\nrmitab qdaemon\nrmitab writesrv",
            "refrescar": null,
            "evidencia": "clear\ndate\nuname -a\nlsitab piobe\n\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de las relaciones:\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nuname -a\nlsitab qdaemon\nlsitab writesrv\nlsitab piobe",
            "SO": "Aix"
        },
        {
            "modulo": "Network Settings//etc/inittab - qdaemon",
            "clave": "QDAEMON",
            "descripcion": "File /etc/inittab have qdaemon service.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Son servicios de impresion, debe salir la linea comentada o vacio\n+-------------------------------------------------------------------------------------+\n\nlsitab qdaemon\n\n+-------------------------------------------------------------------------------------+\n## Relacionado con los modulos:\n+-------------------------------------------------------------------------------------+\n\nNetwork Settings/\\etc\\inittab - piobe\nlsitab piobe\n\nNetwork Settings/\\etc\\inittab - writesrv\nlsitab writesrv\n\n+-------------------------------------------------------------------------------------+\n## Ademas debemos comprobar si no hay colas de impresion\n+-------------------------------------------------------------------------------------+\nenq\n\n// enq: (FATAL ERROR): 0781-372 There are no queues defined in the /etc/qconfig file. //\n\n+-------------------------------------------------------------------------------------+\n## Si hacemos un cat /etc/qconfig y no tiene nada, o no hay colas de impresión definidas y se podría parar.\n## Si salen colas de IMPRESION PREGUNTAR ANTES DE PARAR.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/qconfig | grep -v \"^*\"\n\n// debe salir vacio, o si el resultado del cat, salen por delante *, son solo comentarios.\"CUALQUIER DUDA PREGUNTAR\" //",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## Aix\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/inetd.conf /home/${user}/inetd.conf_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Eliminar la entrada:\n+-------------------------------------------------------------------------------------+\n\nrmitab qdaemon\n\n+-------------------------------------------------------------------------------------+\n## Eliminar las entradas relacionadas:\n+-------------------------------------------------------------------------------------+\n\nrmitab piobe\nrmitab writesrv",
            "refrescar": null,
            "evidencia": "clear\ndate\nuname -a\nlsitab qdaemon\n\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de las relaciones:\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nuname -a\nlsitab piobe\nlsitab writesrv\nlsitab qdaemon",
            "SO": "Aix"
        },
        {
            "modulo": "Network Settings//etc/inittab - writesrv",
            "clave": "WRITESRV",
            "descripcion": "File /etc/inittab have writesrv service.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Son servicios de impresion, debe salir la linea comentada o vacio\n+-------------------------------------------------------------------------------------+\n\nlsitab writesrv\n\n+-------------------------------------------------------------------------------------+\n## Relacionado con los modulos:\n+-------------------------------------------------------------------------------------+\n\nNetwork Settings/\\etc\\inittab - piobe\nlsitab piobe\n\nNetwork Settings/\\etc\\inittab - qdaemon\nlsitab qdaemon\n\n+-------------------------------------------------------------------------------------+\n## Ademas debemos comprobar si no hay colas de impresion\n+-------------------------------------------------------------------------------------+\nenq\n\n// enq: (FATAL ERROR): 0781-372 There are no queues defined in the /etc/qconfig file. //\n\n+-------------------------------------------------------------------------------------+\n## Si hacemos un cat /etc/qconfig y no tiene nada, o no hay colas de impresión definidas y se podría parar.\n## Si salen colas de IMPRESION PREGUNTAR ANTES DE PARAR.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/qconfig | grep -v \"^*\"\n\n// debe salir vacio, o si el resultado del cat, salen por delante *, son solo comentarios.\"CUALQUIER DUDA PREGUNTAR\" //",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## Aix\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/inetd.conf /home/${user}/inetd.conf_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Eliminar la entrada:\n+-------------------------------------------------------------------------------------+\n\nrmitab writesrv\n\n+-------------------------------------------------------------------------------------+\n## Eliminar las entradas relacionadas:\n+-------------------------------------------------------------------------------------+\n\nrmitab piobe\nrmitab qdaemon",
            "refrescar": null,
            "evidencia": "clear\ndate\nuname -a\nlsitab writesrv\n\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de las relaciones:\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nuname -a\nlsitab piobe\nlsitab writesrv\nlsitab qdaemon",
            "SO": "Aix"
        },
        {
            "modulo": "Network Settings/On syslog clients, disable remote message collection",
            "clave": "SYSLOGD",
            "descripcion": "syslogd must be run with the -r flag",
            "comprobacion": "/usr/sbin/syslogd , debe tener un - al final",
            "copia": null,
            "editar": "chssys -s syslogd -a \"-r\"",
            "refrescar": "stopsrc -s syslogd; sleep 1; startsrc -s syslogd",
            "evidencia": "clear\ndate\nuname -a\nps -ef |grep \"syslogd\"\n\n// El distintivo -r debe estar presente al final de la salida.//",
            "SO": "Aix"
        },
        {
            "modulo": "Network Settings/tcpip aixmibd entry",
            "clave": "AIXMIBD",
            "descripcion": "Entry start /usr/sbin/aixmibd \"$src_running\" must be removed from /etc/rc.tcpip file",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n2-DOC / RISK - IMPACT:\n+-------------------------------------------------------------------------------------+\n\nGENERICO / SNMP / TIVOLI",
            "copia": null,
            "editar": null,
            "refrescar": null,
            "evidencia": null,
            "SO": "Aix"
        },
        {
            "modulo": "Network Settings/tcpip hostmibd entry",
            "clave": "HOSTMIBD",
            "descripcion": "Entry start /usr/sbin/hostmibd \"$src_running\" must be removed from /etc/rc.tcpip file",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n2-DOC / RISK - IMPACT:\n+-------------------------------------------------------------------------------------+\n\nGENERICO / SNMP / TIVOLI",
            "copia": null,
            "editar": null,
            "refrescar": null,
            "evidencia": null,
            "SO": "Aix"
        },
        {
            "modulo": "Network Settings/tcpip snmpmibd entry",
            "clave": "SNMPMIBD",
            "descripcion": "Entry start /usr/sbin/snmpmibd \"$src_running\" must be removed from /etc/rc.tcpip file",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n2-DOC / RISK - IMPACT:\n+-------------------------------------------------------------------------------------+\n\nGENERICO / SNMP / TIVOLI",
            "copia": null,
            "editar": null,
            "refrescar": null,
            "evidencia": null,
            "SO": "Aix"
        },
        {
            "modulo": "Network Settings/Prohibited SNMP Community Names",
            "clave": "SNMP",
            "descripcion": "SNMP community name public prohibited in /etc/snmpdv3.conf",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n2-DOC / RISK - IMPACT:\n+-------------------------------------------------------------------------------------+\n\nGENERICO / SNMP / TIVOLI",
            "copia": null,
            "editar": null,
            "refrescar": null,
            "evidencia": null,
            "SO": "Aix"
        },
        {
            "modulo": "Network Settings/tcpip snmpd entry",
            "clave": "SNMPD",
            "descripcion": "Entry start /usr/sbin/snmpd \"$src_running\" must be removed from /etc/rc.tcpip file",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n2-DOC / RISK - IMPACT:\n+-------------------------------------------------------------------------------------+\n\nGENERICO / SNMP / TIVOLI",
            "copia": null,
            "editar": null,
            "refrescar": null,
            "evidencia": null,
            "SO": "Aix"
        },
        {
            "modulo": "Protecting Resources-OSRs/OSR /etc/security files restrictions",
            "clave": "OSR /ETC/SECURITY",
            "descripcion": "$file,$directory en /ETC/SECURITY, Owner: root, Group: tdp, Permissions: drwxr-xr-x-, settings for other must be r-x or more stringent. Should be owned by privileged owner and group.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Deben ser propiedad del owner root y grupo 'security' or 'system', en direcotrio : /etc/security/adsm/ (recursivo), sub-directorios y ficheros.\n+-------------------------------------------------------------------------------------+\n\nfind /etc/security/adsm/ -type f -user root -group tdp | xargs -l ls -l\nfind /etc/security/adsm/ -type d -user root -group tdp | xargs -l ls -ld\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionada con :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR Directory Restrictions",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Buscar y corregir de forma (`RECURSIVO`)\n+-------------------------------------------------------------------------------------+\n\nfind /etc/security/adsm/ -type f -user root -group tdp -exec chown root:system {} \\;\nfind /etc/security/adsm/ -type d -user root -group tdp -exec chown root:system {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Buscar y corregir de forma (`INDIVIDUAL`)\n## Añadir en la variable server, el servidor a corregir, debe ser igual a los ficheros ('MAYUSCULAS' o 'minusculas')\n+-------------------------------------------------------------------------------------+\n\nserver=\"\"\n\nchown root:system /etc/security/adsm\nchown root:system /etc/security/adsm/Nodes\nchown root:system /etc/security/adsm/Nodes/$server\nchown root:system /etc/security/adsm/Nodes/$server/spclicert.crl\nchown root:system /etc/security/adsm/Nodes/$server/spclicert.kdb\nchown root:system /etc/security/adsm/Nodes/$server/spclicert.rdb\nchown root:system /etc/security/adsm/Nodes/$server/spclicert.sth\nchown root:system /etc/security/adsm/TSM.IDX\nchown root:system /etc/security/adsm/TSM.KDB\nchown root:system /etc/security/adsm/TSM.sth",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## Evidencia (`RECURSIVO`)\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nuname -a\nfind /etc/security/adsm/ -type f -user root -group tdp | xargs -l ls -l\nfind /etc/security/adsm/ -type d -user root -group tdp | xargs -l ls -ld\n\n+-------------------------------------------------------------------------------------+\n## Evidencia (`INDIVIDUAL`)\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nuname -a\nls -ld /etc/security/adsm\nls -ld /etc/security/adsm/Nodes\nls -ld /etc/security/adsm/Nodes/$server\nls -l /etc/security/adsm/Nodes/$server/spclicert.crl\nls -l /etc/security/adsm/Nodes/$server/spclicert.kdb\nls -l /etc/security/adsm/Nodes/$server/spclicert.rdb\nls -l /etc/security/adsm/Nodes/$server/spclicert.sth\nls -l /etc/security/adsm/TSM.IDX\nls -l /etc/security/adsm/TSM.KDB\nls -l /etc/security/adsm/TSM.sth",
            "SO": "Aix"
        },
        {
            "modulo": "Protecting Resources-OSRs/OSR Directory Restrictions",
            "clave": "",
            "descripcion": "Invalid OSR ACL for /etc/security/adsm, Owner: root, Group: tdp, Permissions: drwxr-xr-x-, must not be world-writable or have incorrect ownership",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Deben ser propiedad del owner root y grupo 'security' or 'system', en direcotrio : /etc/security/adsm/ (recursivo), sub-directorios y ficheros.\n+-------------------------------------------------------------------------------------+\n\nfind /etc/security/adsm/ -type f -user root -group tdp | xargs -l ls -l\nfind /etc/security/adsm/ -type d -user root -group tdp | xargs -l ls -ld\n\n+-------------------------------------------------------------------------------------+\n## Pregunta relacionada con :\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/OSR /etc/security files restrictions",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Buscar y corregir de forma (`RECURSIVO`)\n+-------------------------------------------------------------------------------------+\n\nfind /etc/security/adsm/ -type f -user root -group tdp -exec chown root:system {} \\;\nfind /etc/security/adsm/ -type d -user root -group tdp -exec chown root:system {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Buscar y corregir de forma (`INDIVIDUAL`)\n## Añadir en la variable server, el servidor a corregir, debe ser igual a los ficheros ('MAYUSCULAS' o 'minusculas')\n+-------------------------------------------------------------------------------------+\n\nserver=\"\"\n\nchown root:system /etc/security/adsm\nchown root:system /etc/security/adsm/Nodes\nchown root:system /etc/security/adsm/Nodes/$server\nchown root:system /etc/security/adsm/Nodes/$server/spclicert.crl\nchown root:system /etc/security/adsm/Nodes/$server/spclicert.kdb\nchown root:system /etc/security/adsm/Nodes/$server/spclicert.rdb\nchown root:system /etc/security/adsm/Nodes/$server/spclicert.sth\nchown root:system /etc/security/adsm/TSM.IDX\nchown root:system /etc/security/adsm/TSM.KDB\nchown root:system /etc/security/adsm/TSM.sth",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## Evidencia (`RECURSIVO`)\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nuname -a\nfind /etc/security/adsm/ -type f -user root -group tdp | xargs -l ls -l\nfind /etc/security/adsm/ -type d -user root -group tdp | xargs -l ls -ld\n\n+-------------------------------------------------------------------------------------+\n## Evidencia (`INDIVIDUAL`)\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nuname -a\nls -ld /etc/security/adsm\nls -ld /etc/security/adsm/Nodes\nls -ld /etc/security/adsm/Nodes/$server\nls -l /etc/security/adsm/Nodes/$server/spclicert.crl\nls -l /etc/security/adsm/Nodes/$server/spclicert.kdb\nls -l /etc/security/adsm/Nodes/$server/spclicert.rdb\nls -l /etc/security/adsm/Nodes/$server/spclicert.sth\nls -l /etc/security/adsm/TSM.IDX\nls -l /etc/security/adsm/TSM.KDB\nls -l /etc/security/adsm/TSM.sth",
            "SO": "Aix"
        },
        {
            "modulo": "Protecting Resources-OSRs/OSR /OPT Files Restrictions",
            "clave": "OSROPT",
            "descripcion": "Invalid permissions for $fileOPT, Octal permissions: 0777, Text Permissions: -rwxrwxrwx;  May not have execute permissions on any files and no write for others.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a ficheros del directorio /OPT\n+-------------------------------------------------------------------------------------+\n\n## El desvio trata de quitarle escritura a OTHER, a ficheros que tienen escritura y ejecucion que cuelgan en el directorio /OPT y sub-directorios.\n\n+-------------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S/'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n// (Por favor revisar la seccion de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero a cambiar permisos.\n+-------------------------------------------------------------------------------------+\n\n## FICHEROS FORMA RECURVISA:\n---\necho \"ficheros con permisos w en other : \";find $fileOPT -type f -perm -o=wx | wc -l\n\n## LISTAR\n---\nfind $fileOPT -type f -perm -o=wx | xargs -l ls -l\n\n## FICHERO INDIVIDUAL\n---\nls -l $fichero\n\n+-------------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n// VARIABLES:\n## $fileOPT : es la variable del directorio base de los ficheros a cambiar permisos.\n## $fichero : es la variable, del fichero a cambiar permiso.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los ficheros('RECURSIVO'):\n+-------------------------------------------------------------------------------------+\n\nfind $fileOPT -type f -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $fichero",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $fileOPT -type f -perm -o=wx | wc -l\nls -ld $fileOPT\n\n+-------------------------------------------------------------------------------------+\n## De forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -l $fichero",
            "SO": "Aix"
        },
        {
            "modulo": "Protecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
            "clave": "STICKY",
            "descripcion": "Sticky bit is not set on world-writable directory: $directory",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a directorios y sub-directorios\n+-------------------------------------------------------------------------------------+\n\n// El desvio trata de aplicar sticky a directorios y sub-directorios, pero aqui corregiremos permisos de W a OTHER.\n\n+-------------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada directorio BASE.\n\n\" Ya sea de tipo '/C/F/S'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT.\n// Por favor revisar la seccion de RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n// Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los directorios a cambiar permisos de W a OTHER (`RECURSIVO`).\n+-------------------------------------------------------------------------------------+\n\n\" Busca y muestra el total de directorios:\n\necho -e \"directorios con permisos w en other osr \\e[32m$directory\\e[m: \";find $directory -type d -perm -o=wx | wc -l\n\n\" Enlistar los directorios\n\nfind $directory -type d -perm -o=wx | xargs -l ls -ld\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los directorios a cambiar permisos de W a OTHER (`INDIVIDUAL`).\n+-------------------------------------------------------------------------------------+\n\nls -ld $directory\n",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n\"VARIABLES:\n\n## $directory : es la variable del directorio raiz a cambiar permisos.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los directorios ('RECURSIVO'):\n+-------------------------------------------------------------------------------------+\n\nfind $directory -type d -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma ('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $directory",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $directory -type d -perm -o=wx | wc -l\nls -ld $directory\n\n+-------------------------------------------------------------------------------------+\n## De forma ('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -ld $directory",
            "SO": "Linux"
        },
        {
            "modulo": "Network Settings/default core dumps restriction",
            "clave": "CORE DUMPS",
            "descripcion": "core dumps should be disabled by default. Current settings: stanza=default, attribute=core, value=2097151\n\ncore dumps should be disabled by default. Current settings: stanza=default, attribute=core_hard, value=",
            "comprobacion": null,
            "copia": null,
            "editar": "chsec -f /etc/security/limits -s default -a core=0 -a core_hard=0\nchdev -l sys0 -a fullcore=false",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\nlssec -f /etc/security/limits -s default -a core -a core_hard\nlsattr -El sys0 -a fullcore\n\n+-------------------------------------------------------------------------------------+\n#El comando lssec, debe salir de la siguiente manera:\n+-------------------------------------------------------------------------------------+\n#//default core=0 core_hard=0\n\n+-------------------------------------------------------------------------------------+\n#El comando lsattrm, debe salir de la siguiente manera:\n+-------------------------------------------------------------------------------------+\n#//fullcore false Enable full CORE dump True",
            "SO": "Aix"
        },
        {
            "modulo": "Network Settings/X-server access control",
            "clave": "X-SERVER",
            "descripcion": "Fileset X11.apps.config must not own file /usr/lpp/X11/bin/xhost.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## El fileset xhost no deberia instalarse.\n+-------------------------------------------------------------------------------------+\n\nlslpp -w /usr/lpp/X11/bin/xhost",
            "copia": null,
            "editar": "installp -g -u  X11.apps.config",
            "refrescar": null,
            "evidencia": "clear\ndate\nuname -a\nlslpp -w /usr/lpp/X11/bin/xhost",
            "SO": "Aix"
        },
        {
            "modulo": "Protecting Resources-OSRs/OSR /TMP Files Restrictions",
            "clave": "OSRTMP",
            "descripcion": "Invalid permissions for $dirTMP  Octal permissions: 0777  Text Permissions: -rwxrwxrwx-;  May not have execute permissions on any files and no write for others.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a ficheros del directorio /TMP\n+-------------------------------------------------------------------------------------+\n\n// El desvio trata de quitarle escritura a OTHER, a ficheros que tienen escritura y ejecucion que cuelgan en el directorio /TMP y sub-directorios.\n\n+-------------------------------------------------------------------------------------+\n## Por normal general, se pueden quitar permisos en /TMP, hay casos especiales de ficheros/directorios en /TMP que empienzan por un punto (` .* `), en ese caso habria que consultarlo con el owner\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los ficheros/directorios a cambiar permisos de W en OTHER (`RECURSIVO`):\n+-------------------------------------------------------------------------------------+\n\n\" Buscar y mostrar el total de ficheros:\n\necho -e \"ficheros con permisos de W en OTHER, osr \\e[32m/tmp\\e[m: \";find /tmp/ -type f -perm -o=wx | wc -l\n\n\" Enlistar ficheros:\n\nfind /tmp/ -type f -perm -o=wx | xargs -l ls -l\n\n\" Buscar y mostrar el total de ficheros por variable:\n\necho -e \"\\nficheros con permisos W en OTHER, osr \\e[32m$dirTMP\\e[m : \";find $dirTMP -type f -perm -o=wx | wc -l\n\n\" Enlistar ficheros por variable:\n\nfind $dirTMP -type f -perm -o=wx | xargs -l ls -l\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los ficheros/directorios a cambiar permisos de W en OTHER (`INDIVIDUAL`):\n+-------------------------------------------------------------------------------------+\n\nls -l /tmp/$fichero\n\n+-------------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------------+\n\n\" Protecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n// VARIABLES:\n\n## $dirTMP : es la variable, del directorio para cambiar permiso a ficheros.\n## $fichero : es la variable, del fichero a cambiar permiso.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los ficheros('RECURSIVO'):\n+-------------------------------------------------------------------------------------+\n\nfind /tmp/ -type f -perm -o=wx -exec chmod o-w {} \\;\n\n\" Por variable\n\nfind $dirTMP -type f -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $fichero\n",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind /tmp/ -type f -perm -o=wx | wc -l\nfind $dirTMP -type f -perm -o=wx | wc -l\nls -ld /tmp/\n\n+-------------------------------------------------------------------------------------+\n## De forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -l $fichero\n",
            "SO": "Linux"
        },
        {
            "modulo": "Protecting Resources-OSRs/OSR /VAR Files Restrictions",
            "clave": "OSRVAR",
            "descripcion": "Invalid permissions for $fileVAR  Octal permissions: 0777  Text Permissions: -rwxrwxrwx;  May not have execute permissions on any files and no write for others.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Aplica a ficheros del directorio /VAR\n+-------------------------------------------------------------------------------------+\n\n## El desvio trata de quitarle escritura a OTHER, a ficheros que tienen escritura y ejecucion que cuelgan en el directorio /VAR y sub-directorios.\n\n+-------------------------------------------------------------------------------------+\n## Hay que tener en cuenta el tipo de owner que pertenece, cada fichero o directorio BASE.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Ya sea de tipo '/C/F/S/'\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es /C/, se pasa a excepcion con RISK e IMPACT\n// (Por favor revisar la seccion de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/S/, se debe preguntar al owner, si podemos modificar los permisos\n## Revisar ('PERMISSIONS'), antes de cualquier cambio.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Buscar y comprobar los fichero a cambiar permisos.\n+-------------------------------------------------------------------------------------+\n\n## FICHEROS FORMA RECURVISA:\n---\necho \"ficheros con permisos w en other : \";find $fileVAR -type f -perm -o=wx | wc -l\nfind $fileVAR -type f -perm -o=wx | xargs -l ls -l\n\n## FICHERO\n---\nls -l $fichero\n\n+-------------------------------------------------------------------------------------+\n## Pregunta RELACIONADAS\n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-mixed/Ensure sticky bit is set on all world-writable directories",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Se puede quitar de forma 'RECURSIVA' o por 'INDIVIDUAL'\n\n// VARIABLES:\n## $fileVAR : es la variable del directorio base de los ficheros a cambiar permisos.\n## $fichero : es la variable, del fichero a cambiar permiso.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos de permisos de W a Other, en los ficheros('RECURSIVO'):\n+-------------------------------------------------------------------------------------+\n\nfind $fileVAR -type f -perm -o=wx -exec chmod o-w {} \\;\n\n+-------------------------------------------------------------------------------------+\n## Asi quitamos permisos, de W a other de forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $fichero",
            "refrescar": null,
            "evidencia": "+-------------------------------------------------------------------------------------+\n## De forma ('RECURSIVA'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nfind $fileVAR -type f -perm -o=wx | wc -l\nls -ld $fileVAR\n\n+-------------------------------------------------------------------------------------+\n## De forma('INDIVIDUAL'):\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -l $fichero",
            "SO": "Linux"
        },
        {
            "modulo": "Protecting Resources-OSRs/OSR /var/tmp/hostmibd.log restrictions",
            "clave": "/VAR/TMP/HOSTMIBD.LOG",
            "descripcion": "/var/tmp/hostmibd.log, Owner: root, Group: system, Permissions: 0644, must be 640 or more restrictive. Should be owned by privileged owner and group.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Fichero /var/tmp/hostmibd.log, no debe tener permisos en OTHER\n+-------------------------------------------------------------------------------------+\n\nls -l /var/tmp/hostmibd.log",
            "copia": null,
            "editar": "chmod 0640 /var/tmp/hostmibd.log",
            "refrescar": null,
            "evidencia": "clear\ndate\nuname -a\nls -l /var/tmp/hostmibd.log",
            "SO": "Aix"
        },
        {
            "modulo": "Protecting Resources-OSRs/smit.log Restrictions",
            "clave": "SMIT.LOG",
            "descripcion": "Invalid Permissions or Ownership for File: /smit.log, Owner: root, Text Permissions: -rw-r--r---, must only be readable or writeable by root. Should be owned by root.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Desvio similar al modulo : \n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/smit.script Restrictions\nProtecting Resources-OSRs/smit.transaction Restrictions\n",
            "copia": null,
            "editar": "chmod g-r,o-r /smit.log\n\n+-------------------------------------------------------------------------------------+\n## Corregir similares:\n+-------------------------------------------------------------------------------------+\n\nchmod g-r,o-r /smit.script\nchmod g-r,o-r /smit.transaction",
            "refrescar": null,
            "evidencia": "clear\ndate\nuname -a\nls -ls /smit.log\nls -ls /smit.script\nls -ls /smit.script",
            "SO": "Aix"
        },
        {
            "modulo": "Protecting Resources-OSRs/smit.script Restrictions",
            "clave": "SMIT.SCRIPT",
            "descripcion": "Invalid Permissions or Ownership for File: /smit.script, Owner: root, Text Permissions: -rw-r--r---, must only be readable or writeable by root. Should be owned by root.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Desvio similar al modulo : \n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/smit.script Restrictions\nProtecting Resources-OSRs/smit.transaction Restrictions\n",
            "copia": null,
            "editar": "chmod g-r,o-r /smit.log\n\n+-------------------------------------------------------------------------------------+\n## Corregir similares:\n+-------------------------------------------------------------------------------------+\n\nchmod g-r,o-r /smit.script\nchmod g-r,o-r /smit.transaction",
            "refrescar": null,
            "evidencia": "clear\ndate\nuname -a\nls -ls /smit.log\nls -ls /smit.script\nls -ls /smit.script",
            "SO": "Aix"
        },
        {
            "modulo": "Protecting Resources-OSRs/smit.transaction Restrictions",
            "clave": "SMIT.TRANSACTION",
            "descripcion": "Invalid Permissions or Ownership for File: /smit.transaction, Owner: root, Text Permissions: -rw-r--r---, must only be readable or writeable by root. Should be owned by root.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Desvio similar al modulo : \n+-------------------------------------------------------------------------------------+\n\nProtecting Resources-OSRs/smit.log Restrictions\nProtecting Resources-OSRs/smit.script Restrictions\n",
            "copia": null,
            "editar": "chmod g-r,o-r /smit.transaction\n\n+-------------------------------------------------------------------------------------+\n## Corregir similares:\n+-------------------------------------------------------------------------------------+\n\nchmod g-r,o-r /smit.script\nchmod g-r,o-r /smit.log",
            "refrescar": null,
            "evidencia": "clear\ndate\nuname -a\nls -ls /smit.log\nls -ls /smit.script\nls -ls /smit.transaction",
            "SO": "Aix"
        },
        {
            "modulo": "Network Settings/Disable NIS client",
            "clave": "NIS",
            "descripcion": "Fileset bos.net.nis.client installed. NIS client enabled, it must be disabled.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Debe no existir nis.client\n+-------------------------------------------------------------------------------------+\n\nlslpp -L |grep \"bos.net.nis.client\"\n\n+-------------------------------------------------------------------------------------+\n## Debe estar inoperative\n+-------------------------------------------------------------------------------------+\n\nstopsrc -g yp",
            "copia": null,
            "editar": "installp -u bos.net.nis.client",
            "refrescar": null,
            "evidencia": "clear\ndate\nuname -a\nlslpp -L |grep \"bos.net.nis.client\"",
            "SO": "Aix"
        },
        {
            "modulo": "protecting Resources-OSRs/SUDO Command WW Permissions",
            "clave": "COMMAND",
            "descripcion": "Invalid WW permissions for command file/directory: $fdSUDO  Permissions: drwxr-xrwx  Permissions for OTHER must be set to r-x or more stringent.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Cambiar permisos al fichero/directorio del comando que se ejecuta en SUDOERS\n## Antes de seguir, buscar el file/directory en - * COMMAND * -\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Localizar la plantilla de SUDO, que tenga implementada el file/directory\n## Debemos mirar en la plantilla, si el file/directory, no se crean con los permisos de W en OTHER\n+-------------------------------------------------------------------------------------+\n\ncd /etc/sudoers.d/\n\ngrep -i \"$fdSUDO\" *\n\n## Hacer un cat de la plantilla de SUDO, y comprobar que no tenga un comando para crear permisos w en other.\n\n+-------------------------------------------------------------------------------------+\n## Comprobar los permisos del file/directory:\n## No deben tener permisos de ESCRITURA en  OTHER\n## Si es de tipo /C/, se debe excepcionar: revisar RISK e IMPACT\n+-------------------------------------------------------------------------------------+\n\nls -ld $fdSUDO",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Quitar permisos de W a other al file/directory de SUDO\n+-------------------------------------------------------------------------------------+\n\nchmod o-w $fdSUDO",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\nls -ld $fdSUDO",
            "SO": "Aix"
        },
        {
            "modulo": "Network Settings/Prohibited Processes",
            "clave": "INETD",
            "descripcion": "INETD Process XXXXX prohibited if not required to support application\nRPC Process XXXXX prohibited if not required to support application",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Comentar los procesos/servicios en /etc/inetd.conf\n+-------------------------------------------------------------------------------------+\n\ncat /etc/inetd.conf | grep -i cmsd\ncat /etc/inetd.conf | grep -i dtspcd\ncat /etc/inetd.conf | grep -i ttdbserver\n\n+-------------------------------------------------------------------------------------+\n## Relacionado con:\n+-------------------------------------------------------------------------------------+\n\nNetwork Settings/\\etc\\inetd.conf - ntalk\nNetwork Settings/\\etc\\inetd.conf - exec\nNetwork Settings/\\etc\\inetd.conf - time\n\n+-------------------------------------------------------------------------------------+\n## Otros procesos/servicios no comunes, REVISAR '- * SERVICE * -':\n+-------------------------------------------------------------------------------------+\n\ncat /etc/inetd.conf | grep -i \"$service\"\n\n+-------------------------------------------------------------------------------------+\n## Servicios no comunes como FTP, Telnet etc etc.\n## Se pueden comprobar de la siguiente manera.\n+-------------------------------------------------------------------------------------+\n---\n## FTP, se puede comprobar que no haya conexiones ftp al servidor y ver que tipo de cuenta es ya sea /C/F/S/.\n+-------------------------------------------------------------------------------------+\n\nlast\n\n+-------------------------------------------------------------------------------------+\n\n## TELNET, se puede comprobar que no exista ninguna shell `/bin/false`, para FTP.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/passwd | grep -i \"/bin/false\"\n\n+-------------------------------------------------------------------------------------+\n## Cualquier duda, consultarlo con los tecnicos.\n+-------------------------------------------------------------------------------------+",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## Aix\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/inetd.conf /home/${user}/inetd.conf_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar y comentar las lineas de los procesos/servicios.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/inetd.conf\n\n+-------------------------------------------------------------------------------------+\n## Editar y comentar las relaciones, si es necesario:\n+-------------------------------------------------------------------------------------+\n\nexec entry must be removed or disabled in /etc/inetd.conf\ntime entry must be removed or disabled in /etc/inetd.conf\nntalk entry must be removed or disabled in /etc/inetd.conf\n",
            "refrescar": "refresh -s inetd",
            "evidencia": "clear\ndate\nhostname\ncat /etc/inetd.conf | grep -i cmsd\ncat /etc/inetd.conf | grep -i ttdbserver\ncat /etc/inetd.conf | grep -i dtspcd\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de otros servicios y procesos :\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\ncat /etc/inetd.conf | grep -i \"$service\"\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de las relaciones:\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\ncat /etc/inetd.conf | grep -i cmsd\ncat /etc/inetd.conf | grep -i ttdbserver\ncat /etc/inetd.conf | grep -i dtspcd\ncat /etc/inetd.conf | grep -i ntalk\ncat /etc/inetd.conf | grep -i exec\ncat /etc/inetd.conf | grep -i time",
            "SO": "Aix"
        },
        {
            "modulo": "Network Settings/CDE installed",
            "clave": "CDE",
            "descripcion": "Fileset X11. CDE must not be installed.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Se puede desinstalar los CDE, ya que estan fuera de soporte, hay desisntalar todos los filesets, que nos muestra el comando\n+-------------------------------------------------------------------------------------+\n\nlslpp -L |grep -i CDE",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## De esta manera se desinstala los filesets de CDE, copiar uno en uno, y el que no este añadirlo\n+-------------------------------------------------------------------------------------+\n\ninstallp -g -u X11.Dt.ToolTalk\ninstallp -g -u X11.Dt.adt\ninstallp -g -u X11.Dt.bitmaps\ninstallp -g -u X11.Dt.compat\ninstallp -g -u X11.Dt.helpinfo\ninstallp -g -u X11.Dt.helpmin\ninstallp -g -u X11.Dt.helprun\ninstallp -g -u X11.Dt.lib\ninstallp -g -u X11.Dt.rte\ninstallp -g -u X11.Dt.xdt2cde",
            "refrescar": null,
            "evidencia": "clear\ndate\nuname -a\nlslpp -L |grep -i CDE",
            "SO": "Aix"
        },
        {
            "modulo": "E.1.5.22.3 Network Settings",
            "clave": "",
            "descripcion": "Entry in /etc/inetd.conf must be removed or disabled. service rsh",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Comentar los procesos/servicios en /etc/inetd.conf\n+-------------------------------------------------------------------------------------+\n\ncat /etc/inetd.conf | grep -i cmsd\ncat /etc/inetd.conf | grep -i dtspcd\ncat /etc/inetd.conf | grep -i ttdbserver\n\n+-------------------------------------------------------------------------------------+\n## Otros procesos/servicios no comunes:\n+-------------------------------------------------------------------------------------+\n\ncat /etc/inetd.conf | grep -i \"$service\"\n\n+-------------------------------------------------------------------------------------+\n## Relacionado con:\n+-------------------------------------------------------------------------------------+\n\nNetwork Settings/\\etc\\inetd.conf - ntalk\nNetwork Settings/\\etc\\inetd.conf - exec\nNetwork Settings/\\etc\\inetd.conf - time",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n## Aix\n+-------------------------------------------------------------------------------------+\n## Backup en HOME\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/inetd.conf /home/${user}/inetd.conf_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Editar y comentar las lineas de los procesos/servicios.\n+-------------------------------------------------------------------------------------+\n\nvi /etc/inetd.conf\n\n+-------------------------------------------------------------------------------------+\n## Editar y comentar las relaciones, si es necesario:\n+-------------------------------------------------------------------------------------+\n\nexec entry must be removed or disabled in /etc/inetd.conf\ntime entry must be removed or disabled in /etc/inetd.conf\nntalk entry must be removed or disabled in /etc/inetd.conf\n",
            "refrescar": "refresh -s inetd",
            "evidencia": "clear\ndate\nhostname\ncat /etc/inetd.conf | grep -i cmsd\ncat /etc/inetd.conf | grep -i ttdbserver\ncat /etc/inetd.conf | grep -i dtspcd\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de otros servicios y procesos :\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\ncat /etc/inetd.conf | grep -i \"$service\"\n\n+-------------------------------------------------------------------------------------+\n## Evidencia de las relaciones:\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\ncat /etc/inetd.conf | grep -i cmsd\ncat /etc/inetd.conf | grep -i ttdbserver\ncat /etc/inetd.conf | grep -i dtspcd\ncat /etc/inetd.conf | grep -i ntalk\ncat /etc/inetd.conf | grep -i exec\ncat /etc/inetd.conf | grep -i time",
            "SO": "Aix"
        },
        {
            "modulo": "E.1.5.22.4 Network Settings",
            "clave": "SENDMAIL",
            "descripcion": "Entry in /etc/rc.tcpip must be removed or disabled. : service sendmail",
            "comprobacion": "grep -i sendmail /etc/rc.tcpip|grep -v ^#",
            "copia": null,
            "editar": "chrctcp -d sendmail",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\ngrep -i sendmail /etc/rc.tcpip|grep -v ^#",
            "SO": "Aix"
        },
        {
            "modulo": "Network Settings/NFS root restrictions",
            "clave": "NFS",
            "descripcion": "File /etc/exports has invalid line: XXXX",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## No es un servicio requerido, por lo que se puede deshabilitar.\n## Antes de nada comprobar que no tenga: shares/filesystem compartiendo.\n+-------------------------------------------------------------------------------------+\n## Debe salir inoperative en nfs :\n+-------------------------------------------------------------------------------------+\n\nlssrc -g nfs\n\n+-------------------------------------------------------------------------------------+\n## Debe salir vacio en /etc/exports\n+-------------------------------------------------------------------------------------+\n\ncat /etc/exports\n\n+-------------------------------------------------------------------------------------+\n## En el caso de tener shares/filesystem, contactar con el SOPORTE TECNICO.\n+-------------------------------------------------------------------------------------+",
            "copia": null,
            "editar": "stopsrc -g nfs",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\nlssrc -g nfs",
            "SO": "Aix"
        },
        {
            "modulo": "Identify and Authenticate Users/PermitRootLogin Restriction",
            "clave": "PERMITROOTLOGIN",
            "descripcion": "SSH Config File: /etc/ssh/sshd_config; Invalid setting (value:yes) in parameter 'PermitRootLogin': must be set to 'no'. May be set to YES, FORCED-COMMANDS-ONLY,or WITHOUT-PASSWORD only if mechanisms are in place to determine the identity of the individual accessing the system.",
            "comprobacion": "## Antes de corregir se debe comprobar que no estén los valores correctos por defecto o no este excepcionado el parametro para dicho servidor\n\n+-------------------------------------------------------------------------------------+\n## Valor por defecto correcto es : No\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Muestra el valor por defecto\n+-------------------------------------------------------------------------------------+\n\n/usr/sbin/sshd -T|grep -i PermitRootLogin\n\n+-------------------------------------------------------------------------------------+\n## Valor definido en el servidor, no debe estar comentado(#), o no debe estar vació\n+-------------------------------------------------------------------------------------+\n\ncat /etc/ssh/sshd_config | grep -i PermitRootLogin",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user^^}/sshd_config_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/ssh/sshd_config /home/${user,,}/sshd_config_`date +%d%m%y_%T`",
            "editar": "+-------------------------------------------------------------------------------------+\n## Añadir el valor No, al parámetro PermitRootLogin\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Debe quedar algo asi:\n\nPermitRootLogin no\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/ssh/sshd_config",
            "refrescar": "+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n\nsystemctl stop sshd\nsystemctl start sshd\n\n+-------------------------------------------------------------------------------------+\n## AIX\n+-------------------------------------------------------------------------------------+\n\nstopsrc -s sshd;sleep 2;startsrc -s sshd",
            "evidencia": "clear\ndate\nhostname\n/usr/sbin/sshd -T|grep -i PermitRootLogin\ncat /etc/ssh/sshd_config | grep -i PermitRootLogin",
            "SO": "Linux / Aix"
        },
        {
            "modulo": "AV.1.1.7 Password Requirements",
            "clave": "",
            "descripcion": "## (MODULO RELACIONADO : AV.1.1.6 Password Requirements)\n\n## SSH authorized_keys file: \"FICHERO AUTHORIZED KEYS\"; Invalid from section: . \"*º\" or \"*.*.*.*\" or \"0/0\" or \"0.0.0.0/0\" or empty are forbidden values in the \"from=\" parameter",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves publicas (\"authorized_keys\")\n## Deben tener un FROM que especifique el host remoto o direccion IP.\n\n## Antes de seguir, revisar ('AUTHORIZED')\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene un FROM, que especifica el host remoto o IP\n## Debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_authorized\ncat $file_authorized\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys pertenece a la cuenta root, Root no debe tener un fichero authorized_keys.\n## Pasamos directamente a renombrar el fichero authorized_keys para el owner root.\n\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n\" --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys es de TIPO /F/ o /S/ (sistemas / aplicativo)\n## Se debe notificar al owner o grupo del fichero.\n\n## - Si se va a excepcionar nos deben especificar un RISK e IMPACT.\n\n## - Si se va a corregir (nos deben facilitar la IP o HOST).\n+-------------------------------------------------------------------------------------+\n## Si es de TIPO /C/ (customer)\n\n## - Se debe excepcionar.\n\n## Revisar RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n\" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys, es de tipo /E/. /I/./K/\n\n## - Si es una cuenta 'externa' y no existe en el servidor, se puede renombrar el fichero authorized_key.\n\n## - Si la cuenta existe, se debe notificar al owner de la cuenta.\n+-------------------------------------------------------------------------------------+",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user^^}/authorized_key_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user,,}/authorized_key_`date +%d%m%y_%T`\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p \"$file_authorized\" /home/$user/authorized_key_`date +%d%m%y_%T`\n",
            "editar": "\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/authorized_keys /home/root/.ssh/authorized_keys.save\n\n\n\" --> OPCION 2 y \" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/ o sin owner o account externas/internas de tipo /E/ o /I/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Donde se tengan que renombar el fichero.\n+-------------------------------------------------------------------------------------+\n\nmv $file_authorized $file_authorized.save\n\n+-------------------------------------------------------------------------------------+\n## Donde se tenga que añadir un FROM.\n+-------------------------------------------------------------------------------------+\n\nvi $file_authorized\n\n+-------------------------------------------------------------------------------------+\n## Añadir la línea from=\"IP\", al inicio de cada clave shh-rsa:\n+-------------------------------------------------------------------------------------+\n## EJEMPLO\n\nfrom=\"129.39.41.5,129.39.41.6\" ssh-rsa AAAAB3NzaC1yc2EAAAABIw== !!CZ/S/*ABJ83/IBM/Automation ID!!\n",
            "refrescar": null,
            "evidencia": "\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /home/root/.ssh/authorized_keys\n\n\n\" --> OPCION 2 y \" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/, sin owner o account externas/internas tipo /E/, /I/ /K/\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la $file_authorized\ncat $file_authorized",
            "SO": "Linux / Aix"
        },
        {
            "modulo": "AV.1.1.6 Password Requirements",
            "clave": "",
            "descripcion": "## (MODULO RELACIONADO : AV.1.1.7 Password Requirements)\n\n## SSH authorized_keys file: \"FICHERO AUTHORIZED KEYS\"; Invalid from section: . \"*º\" or \"*.*.*.*\" or \"0/0\" or \"0.0.0.0/0\" or empty are forbidden values in the \"from=\" parameter",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## En este tipo de desviaciones, las claves publicas (\"authorized_keys\")\n## Deben tener un FROM que especifique el host remoto o direccion IP.\n\n## Antes de seguir, revisar ('AUTHORIZED')\n+-------------------------------------------------------------------------------------+\n## Revisamos si tiene un FROM, que especifica el host remoto o IP\n## Debe ser solo accesible al owner\n+-------------------------------------------------------------------------------------+\n\nls -la $file_authorized\ncat $file_authorized\n\n## PUEDEN EXISTIR 3 OPCIONES DIFERENTES:\n\n\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys pertenece a la cuenta root, Root no debe tener un fichero authorized_keys.\n## Pasamos directamente a renombrar el fichero authorized_keys para el owner root.\n\n## ('SI HAY DUDAS, consultarlo con el tecnico')\n+-------------------------------------------------------------------------------------+\n\n\" --> OPCION 2\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys es de TIPO /F/ o /S/ (sistemas / aplicativo)\n## Se debe notificar al owner o grupo del fichero.\n\n## - Si se va a excepcionar nos deben especificar un RISK e IMPACT.\n\n## - Si se va a corregir (nos deben facilitar la IP o HOST).\n+-------------------------------------------------------------------------------------+\n## Si es de TIPO /C/ (customer)\n\n## - Se debe excepcionar.\n\n## Revisar RISK e IMPACT.\n+-------------------------------------------------------------------------------------+\n\n\" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Si el fichero authorized_keys, es de tipo /E/. /I/./K/\n\n## - Si es una cuenta 'externa' y no existe en el servidor, se puede renombrar el fichero authorized_key.\n\n## - Si la cuenta existe, se debe notificar al owner de la cuenta.\n+-------------------------------------------------------------------------------------+",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user^^}/authorized_key_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p $file_authorized /home/${user,,}/authorized_key_`date +%d%m%y_%T`\n\n## AIX\n+-------------------------------------------------------------------------------------+\n## Backup\n+-------------------------------------------------------------------------------------+\n\ncp -p \"$file_authorized\" /home/$user/authorized_key_`date +%d%m%y_%T`\n",
            "editar": "\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nmv /home/root/.ssh/authorized_keys /home/root/.ssh/authorized_keys.save\n\n\n\" --> OPCION 2 y \" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/ o sin owner o account externas/internas de tipo /E/ o /I/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Donde se tengan que renombar el fichero.\n+-------------------------------------------------------------------------------------+\n\nmv $file_authorized $file_authorized.save\n\n+-------------------------------------------------------------------------------------+\n## Donde se tenga que añadir un FROM.\n+-------------------------------------------------------------------------------------+\n\nvi $file_authorized\n\n+-------------------------------------------------------------------------------------+\n## Añadir la línea from=\"IP\", al inicio de cada clave shh-rsa:\n+-------------------------------------------------------------------------------------+\n## EJEMPLO\n\nfrom=\"129.39.41.5,129.39.41.6\" ssh-rsa AAAAB3NzaC1yc2EAAAABIw== !!CZ/S/*ABJ83/IBM/Automation ID!!\n",
            "refrescar": null,
            "evidencia": "\" --> OPCION 1\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, con owner root.\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la /home/root/.ssh/authorized_keys\n\n\n\" --> OPCION 2 y \" --> OPCION 3\n+-------------------------------------------------------------------------------------+\n## Para ficheros authorized_keys, de tipo /F/S/, sin owner o account externas/internas tipo /E/, /I/ /K/\n+-------------------------------------------------------------------------------------+\n\nclear\ndate\nhostname\nls -la $file_authorized\ncat $file_authorized",
            "SO": "Linux / Aix"
        },
        {
            "modulo": "Password Requirements/Login Retries - RHEL 7",
            "clave": "PAM / TALLY",
            "descripcion": "Non of the Login Retrie options was found in file:\n/etc/pam.d/password-auth\n/etc/pam.d/system-auth",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al 'pam_tally2.so.'\n+-------------------------------------------------------------------------------------+\n\n##-*** Saber que PAM_TALLY USA ****-#\n\nls -ltr /lib64/security/pam_tally*\n\n+-------------------------------------------------------------------------------------+\n## ('system-auth','password-auth')\n\n## Los ficheros del PAM, deben tener los parámetros:\n\n// `auth        required      pam_tally2.so deny=5`\n// `account     required      pam_tally2.so`\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep pam_tally\ncat /etc/pam.d/password-auth | grep pam_tally\n",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Se debe añadir en la primera linea de su modulo.\n\n## ('se aconseja remplazar la linea del modulo')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\n+-------------------------------------------------------------------------------------+\n## Modificar o Añadir:\n+-------------------------------------------------------------------------------------+\n\nauth        required      pam_tally2.so deny=5\n\n+-------------------------------------------------------------------------------------+\n## Modificar o Añadir:\n+-------------------------------------------------------------------------------------+\n\naccount     required      pam_tally2.so\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n\n",
            "refrescar": null,
            "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"pam_tally\" \ncat /etc/pam.d/password-auth | egrep \"pam_tally\"\n",
            "SO": "Linux"
        },
        {
            "modulo": "Password Requirements/Login Retries - RHEL 8",
            "clave": "PAM / FAILLOCK",
            "descripcion": "Non of the Login Retrie options was found in file:\n/etc/pam.d/password-auth\n/etc/pam.d/system-auth",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al 'pam_faillock.so.'\n+-------------------------------------------------------------------------------------+\n\n##-*** Saber que PAM_FAILLOCK USA ****-#\n\nls -la /usr/sbin/faillock*\n\n+-------------------------------------------------------------------------------------+\n## ('system-auth','password-auth')\n\n## Los ficheros del PAM, deben tener los parámetros:\n\n// `auth        required      pam_faillock.so preauth silent deny=5 unlock_time=0`\n// `auth        [default=die] pam_faillock.so authfail deny=5 unlock_time=0`\n\n// `account     required      pam_faillock.so`\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep pam_faillock\ncat /etc/pam.d/password-auth | grep pam_faillock\n",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Se debe añadir en la primera linea de su modulo.\n\n## ('se aconseja remplazar la linea del modulo')\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\n+-------------------------------------------------------------------------------------+\n## Modificar o Añadir:\n+-------------------------------------------------------------------------------------+\n\nauth        required        pam_faillock.so preauth silent deny=5 unlock_time=0\n\n+-------------------------------------------------------------------------------------+\n## Ademas se debe añadir la siguiente linea, por encima de 'auth required pam_deny.so'\n+-------------------------------------------------------------------------------------+\n\nauth        [default=die] pam_faillock.so authfail deny=5 unlock_time=0\n\n+-------------------------------------------------------------------------------------+\n## Modificar o Añadir:\n+-------------------------------------------------------------------------------------+\n\naccount     required      pam_faillock.so\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n\n",
            "refrescar": null,
            "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"pam_faillock\" \ncat /etc/pam.d/password-auth | egrep \"pam_faillock\"\n",
            "SO": "Linux"
        },
        {
            "modulo": "Encryption/Password Encryption Required",
            "clave": "PAM / SHA512",
            "descripcion": "/etc/pam.d/password-auth.\n/etc/pam.d/system-auth.\nAny file in /etc/pam.d containing \"password sufficient pam_unix.so\" stanza must carry the \"sha512 shadow\" options.\n\nIncorrect or missing pam_unix.so module stanza. For more information see coverage matrix document",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al parametro 'sha512 shadow ' en RHEL 7 y RHEL 8 ('system-auth','password-auth').\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Los ficheros del PAM, deben tener en el modulo 'password    sufficient    pam_unix.so', el parámetro 'sha512 shadow '\n\n## Ademas deben ser LINK de 'system-auth-ac', 'password-auth-ac' o alguna alternativa dependiendo las caracteristicas del server.\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | egrep \"sha512|shadow\"\ncat /etc/pam.d/password-auth | egrep \"sha512|shadow\"\nls -la /etc/pam.d/system-auth\nls -la /etc/pam.d/password-auth\n\n+-------------------------------------------------------------------------------------+\n## Si la configuracion anterior es valida. revisar que no hayan BACKUPS de los ficheros del PAM\n\n## Ficheros .ori, .bck, .backup, -local, o todo aquel que sea una copia de, 'system-auth', 'password-auth', o de 'system-auth-ac', 'password-auth-ac'\n+-------------------------------------------------------------------------------------+\n\ncd /etc/pam.d/\nls -la system-*\nls -la password-*\n\n+-------------------------------------------------------------------------------------+\n## - Si existen BACKUPS, Mover los BACKUPS al HOME\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## La siguiente serie de comandos, es para que los ficheros del PAM, sean LINK de (`system-auth-ac`, `password-auth-ac`).\n\n// NOTA : No es necesario si ya son link a un fichero authorizado.\n+-------------------------------------------------------------------------------------+\n\nrm -r system-auth\nln -s system-auth-ac system-auth\n\nrm -r password-auth\nln -s password-auth-ac password-auth\n\n+-------------------------------------------------------------------------------------+\n## Modulo similiar : \n\n\" Password Requirements/Password History\n+-------------------------------------------------------------------------------------+",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'password    sufficient    pam_unix.so', el parámetro 'sha512 shadow'.\n\n// NOTA: ('se aconseja remplazar toda la linea, del modulo 'password    sufficient    pam_unix.so').\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\n+-------------------------------------------------------------------------------------+\n## Añadir\n+-------------------------------------------------------------------------------------+\n\npassword    sufficient    pam_unix.so remember=9 use_authtok sha512 shadow try_first_pass\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n",
            "refrescar": null,
            "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"sha512|shadow\"\ncat /etc/pam.d/password-auth | egrep \"sha512|shadow\"\n",
            "SO": "Linux"
        },
        {
            "modulo": "Password Requirements/Password History",
            "clave": "PAM / REMEMBER",
            "descripcion": "PAM service file: /etc/pam.d/password-auth\nPAM service file: /etc/pam.d/system-auth\nMust have \"password sufficient pam_unix.so\" stanza with \"remember=12\" parameter. \"sufficient\" can be replaced with \"required\".",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Hace referencia al 'remember' en RHEL 7 y RHEL 8.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Los ficheros del PAM, deben tener en el modulo 'password    sufficient    pam_unix.so', el parámetro 'remember=12'\n+-------------------------------------------------------------------------------------+\n\ncat /etc/pam.d/system-auth | grep remember\ncat /etc/pam.d/password-auth | grep remember\n\n+-------------------------------------------------------------------------------------+\n## Modulo similiar : \n\n\"Encryption/Password Encryption Required\n+-------------------------------------------------------------------------------------+",
            "copia": "+-------------------------------------------------------------------------------------+\n## Obtener usuario logueado:\n+-------------------------------------------------------------------------------------+\n\nuser=$(logname)\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en MAYÚSCULAS\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user^^}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user^^}/password-auth_`date +%d%m%y_%T`\n\n+-------------------------------------------------------------------------------------+\n## Backup con HOME en minúsculas\n+-------------------------------------------------------------------------------------+\n\ncp -p /etc/pam.d/system-auth /home/${user,,}/system-auth_`date +%d%m%y_%T`\n\ncp -p /etc/pam.d/password-auth /home/${user,,}/password-auth_`date +%d%m%y_%T`\n",
            "editar": "+-------------------------------------------------------------------------------------+\n## Añadir en el modulo 'password    sufficient    pam_unix.so', el parámetro 'remember=12'.\n\n## ('se aconseja remplazar toda la linea, del modulo 'password    sufficient    pam_unix.so').\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Editar:\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/system-auth\n\n+-------------------------------------------------------------------------------------+\n## Modificar o Añadir:\n+-------------------------------------------------------------------------------------+\n\npassword    sufficient    pam_unix.so remember=12 use_authtok sha512 shadow try_first_pass\n\n+-------------------------------------------------------------------------------------+\n## Lo mismo con 'password-auth'\n+-------------------------------------------------------------------------------------+\n\nvi /etc/pam.d/password-auth\n",
            "refrescar": null,
            "evidencia": "clear\ndate;hostname\ncat /etc/*release | grep -i release\ncat /etc/pam.d/system-auth | egrep \"remember\" \ncat /etc/pam.d/password-auth | egrep \"remember\"\n",
            "SO": "Linux"
        },
        {
            "modulo": "Password Requirements/Password MAX Age /etc/shadow - Linux",
            "clave": "MAXAGE",
            "descripcion": "Account $account has invalid Password Max Age setting of 99999  should be set to Customer Required Setting: 90. More secure value can be set.",
            "comprobacion": "+-------------------------------------------------------------------------------------+\n## Para aplicar un correcto MAXAGE, hay que tener en cuenta el tipo de cuenta que es:\n## Ya sea tipo /C/F/S/.\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /C/, --> se pasa a excepcionar con RISK e IMPACT.\n\n## (Revisar el fichero de RISK e IMPACT)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /F/ --> se cambia a 90 dias, ejemplo de cuentas aplicable MAXAGE : root, emer, cyberark.\n\n## Dependiendo el cliente, alguna cuentas de TIPO F, se exepcionan con RISK e IMPACT, si fuera el caso se debe hablar con el owner de la cuenta, y que nos indique un RISK e IMPACT, o del contrario si se puede aplicar MAXAGE.\n\n## (Revisar \" * ACCOUNT * \", antes de cualquier cambio)\n+-------------------------------------------------------------------------------------+\n\n+-------------------------------------------------------------------------------------+\n## Si es de tipo /S/ aplicativos, por lo normal no llevan una password asignada, si ese fuera el caso, se debe preguntar al owner de la cuenta, si se le puede aplicar expiracion de passwor o bien se pasa a excepcionar\n+-------------------------------------------------------------------------------------+",
            "copia": null,
            "editar": "+-------------------------------------------------------------------------------------+\n## Cambiar MAXAGE a 90\n+-------------------------------------------------------------------------------------+\n\nchage -M 90 $account",
            "refrescar": null,
            "evidencia": "clear\ndate\nhostname\nchage -l $account\ncat /etc/passwd | grep -i $account",
            "SO": "Linux"
        }
    ]
}